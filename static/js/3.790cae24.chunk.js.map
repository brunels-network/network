{"version":3,"sources":["components/AboutOverlay.js","components/TextButton.js","components/AnalysisPanel.js","components/BioOverlay.js","components/SourceOverlay.js","components/Overlay.js","components/OverlayWrapper.js","components/Popover.js","components/d3/force_spiral.js","components/d3/ForceGraph.d3.js","components/ForceGraph.js","components/HowDoIOverlay.js","components/NewTimeline.js","components/TimeLineBox.js","components/Accordion.js","components/ResponsiveList.js","components/CheckBox.js","components/DefaultButton.js","components/FilterBox.js","components/SlidingPanel.js","components/ShipSelector.js","components/ShipTitle.js","components/SearchBar.js","components/SearchOverlay.js","model/Errors.js","model/RoughDate.js","model/DateRange.js","model/Person.js","model/People.js","model/Business.js","model/Businesses.js","model/Connection.js","model/get_id.js","model/Connections.js","model/Position.js","model/Positions.js","model/Affiliation.js","model/Affiliations.js","model/Source.js","model/Sources.js","model/Note.js","model/Notes.js","model/Project.js","model/Projects.js","model/Biographies.js","model/ScoringFunctions.js","model/Social.js","SocialApp.js","images sync /^/.//.*$","components/AboutOverlay.module.css","components/TextButton.module.css","components/AnalysisPanel.module.css","components/Popover.module.css","components/BioOverlay.module.css","images/320px-SS_Great_Britain_diagram.jpg","images/320px-SS_Great_Britain_transverse_section.jpg","images/800px-Gutenberg_Bible.jpg","images/A_Specimen_by_William_Caslon.jpg","images/Brunel_letter_GWR.jpg","images/Great_Western_maiden_voyage.jpg","images/IllustriteZeitung_SS_GreatBritain.png","images/RHowlett_IKB.jpg","images/Sumerian_26th_c_Adab.jpg","images/The_Steamer_Great_Western_small.jpg","images/bg-128-168.jpg","images/ssgb_logo.png","components/SourceOverlay.module.css","components/Overlay.module.css","components/ForceGraph.module.css","components/HowDoIOverlay.module.css","components/TimeLineBox.module.css","components/Accordion.module.css","components/ResponsiveList.module.css","components/CheckBox.module.css","components/DefaultButton.module.css","components/FilterBox.module.css","components/SlidingPanel.module.css","components/transitions/SlideFromLeft.module.css","components/transitions/SlideFromRight.module.css","components/transitions/SlideFromBottom.module.css","components/transitions/SlideFromTop.module.css","components/ShipSelector.module.css","components/ShipTitle.module.css","components/SearchBar.module.css","components/SearchOverlay.module.css","SocialApp.module.css"],"names":["AboutOverlay","className","styles","container","closeButton","onClick","this","props","close","style","background","border","fontSize","textContainer","header","intro","aboutText","introBody","sectionHeader","body","React","Component","TextButton","defaultCSS","fontFamily","color","cursor","padding","textAlign","clickFn","css","textColor","hoverColor","slice","button","children","saveSvgAsPng","require","AnalysisPanel","wrapperRef","createRef","setWrapperRef","bind","handleClickOutside","document","addEventListener","removeEventListener","node","event","contains","target","togglePanel","indirectConnectionsText","indirectConnectionsVisible","unconnectedNodesText","unconnectedNodesVisible","filterEngineersText","engineersFiltered","filterCommercialText","commercialFiltered","data-testid","ref","wholePanel","verticalSpaceTitle","titleText","verticalSpace","filterEngineeringNodes","filterCommercialNodes","toggleindirectConnectionsVisible","toggleUnconnectedNodesVisible","resetFilters","toggleSearchOverlay","filename","moment","format","getElementById","scale","encoderOptions","backgroundColor","BioOverlay","state","isVisible","person","id","getID","name","getName","bio","social","getBiographies","getByID","replace","imageFilenames","sourceButton","toggleSourceOverlay","sourceButtonText","toggleOverlay","nameHeader","positions","sources","sourcesHeader","divider","imageSection","key","src","alt","imageDescription","SourceOverlay","onChange","currentImage","elemCodes","imageElements","sourceIDs","map","push","imageID","setState","showArrows","length","sourceID","source","get","bioButton","toggleBioOverlay","sourceName","getDescription","biography","value","slidesPerPage","arrows","arrowLeft","icon","faAngleDoubleLeft","arrowLeftDisabled","faAngleLeft","arrowRight","faAngleDoubleRight","arrowRightDisabled","faAngleRight","addArrowClickHandler","Overlay","useState","open","setOpen","overlay","useBackground","overlayNoBackground","e","stopPropagation","defaultProps","OverlayWrapper","socialSources","getSources","isOverlayOpen","isSourceOverlayOpen","entity","isBioOverlayOpen","Popover","clearPopups","str","ellipsis","max","array","trim","split","join","selectedShipID","label","readMoreButton","buttonStrings","nodeType","getPeople","TypeError","getBusinesses","console","error","truncate","left","top","innerWidth","window","innerHeight","popoverHeight","popoverWidth","x","y","popOver","height","popoverHeightVH","width","popoverWidthVW","bioSection","edge_count","readMore","sourceHeader","sourceSection","_constant","_return_index","i","j","_null_function","constrain","w","r","Math","min","randomShift","random","handleMouseOver","THIS","svg","_mainGroup","d3","raise","attr","items","selectAll","classed","highlight","each","d","target_id","source_id","signalMouseOver","handleMouseOut","signalMouseOut","_resolve","item","ForceGraphD3","updateLink","updateNodeText","updateNode","draw","drawFromScratch","setPositionColors","getPositionColor","update","updateGraph","drag","dragLink","getWeight","uid","uuidv4","selected","highlighted","lastPhysics","physicsEnabled","signalClicked","hideUnconnectedNodes","standardSimulation","lastSimulationType","colors","groupTable","_size_changed","_graph_changed","_is_running","_is_drawn","_target_decay","_target_alpha","_tooltips","getConnections","find","gotConnections","h","graph","getGraph","l","lodash","cloneDeep","edges","edge","n","nodes","fixed","simulationType","fx","fixedLocation","fy","_graph","size_changed","Object","prototype","hasOwnProperty","call","greatEasternID","getProjects","getByName","positionGroups","positionCode","getPositionCode","shipID","getSelectedShipID","code","namedPositions","getPositions","colorTable","entries","position","trimPosition","toLowerCase","group","members","includes","startsWith","positionGroup","simulation","_simulation","on","restart","index","dx","dy","weight","data","select","enter","append","emitPopProps","text","node_text","link","indirectStyle","linkIndirect","linkInvisible","type","linkWeak","log","simulation_type","gravitySimulation","structuredSimulation","spiralSimulation","centreNodes","stop","filter","v","maxWeight","strengthScale","exponent","range","domain","radiusScale","alpha","alphaTarget","alphaDecay","force","strength","radius","iterations","links","_link","undefined","dr","sqrt","_node","_label","getLabelXOffset","restartSimulation","strengths","indexes","points_x","points_y","vx","vy","initialize","Array","floor","max_index","angle","min_x","max_x","min_y","max_y","asin","cos","sin","center_x","center_y","scale_x","scale_y","_","arguments","force_spiral","sort_index","distanceMin","distance","size","getGroupForce","distanceMax","font","context","getTextWidth","canvas","createElement","getContext","measureText","swapSection","textWidth","maxOffset","velocityDecay","alphaMin","remove","mainGroup","update_simulation","changeSimulationType","ForceGraph","popoversVisible","popups","updateSize","componentDidUpdate","localProps","offsetWidth","offsetHeight","prevState","assign","s","p","togglePopover","fastPhysics","slowPhysics","el","HowDoIOverlay","howDoIText","NewTimeline","setFilter","itemRenderer","defaultTimeStart","defaultTimeEnd","lastShip","textStyle","overflow","paddingLeft","textOverflow","whiteSpace","dateHeaderStyle","shipName","itemContext","getItemProps","resizing","borderStyle","borderWidth","onMouseDown","title","timeline_items","projects","values","project","getNewTimeLine","groups","sidebarWidth","itemTouchSendsClick","stackItems","lineHeight","itemHeightRatio","showCursorLine","canMove","canResize","traditionalZoom","timeSteps","year","unit","intervals","headerContext","getRootProps","getIntervalProps","interval","borderLeft","startTime","TimeLineBox","dimensions","tabs","tabId","keys","forEach","tab","deactivate","activate","tabList","tabFor","tabPanel","shipSelect","centerContainer","BAccordion","accordion","preExpanded","allowMultipleExpanded","allowZeroExpanded","BAccordionItem","accordionItem","uuid","BAccordionTitle","accordionButton","BAccordionPanel","ResponsiveList","list","ResponsiveListItem","CheckBox","checkBox","checked","checkMark","DefaultButton","href","null_function","filterList","emitSelected","emitToggleFilter","output","is_filtered","isFiltered","maxWidth","FilterBox","filter_text","getFilterText","emitClearFilters","filter_info","filterContainer","filterText","affiliations","getAffiliations","people","businesses","SlidingPanel","isOpen","defaultSize","minSize","maxSize","rightContainer","transition","SlideFromRight","horiz_size","vert_size","maxHeight","SlideFromBottom","bottomContainer","topContainer","SlideFromTop","leftContainer","SlideFromLeft","CSSTransition","in","timeout","classNames","unmountOnExit","ShipSelector","ssGW","shipFilter","ShipTitle","shipTitle","SearchResults","results","SearchBar","suggestions","searching","nextProps","searchText","emitResults","concat","createButton","setSuggestions","setResults","setTimeout","startSearch","startSuggestion","isSearching","autocomplete","isEmpty","which","keyCode","searchFor","searchContainer","resultContainer","searchPending","display","fadeIn","closeResultButton","stopSearch","searchResult","searchBox","onKeyPress","onEnter","placeholder","isSearchingComponent","isSuggesting","isSuggestingComponent","hasResults","resultsComponent","SearchOverlay","haveResults","selectedEntity","infoOverlay","smallContainer","emitHighlighted","emitClicked","KeyError","args","Error","ValueError","MissingError","_toDate","val","def","_isAMomentObject","date","isValid","_get_min","d1","d2","toDate","_get_max","RoughDate","start","end","raw","_isARoughDateObject","_isADateRangeObject","toISOString","isNull","delta","add","isFuzzy","getMonth","getDate","getFullYear","getEarliest","getLatest","DateRange","isExact","both","m","toMoment","other","s1","s2","getStart","getEnd","getRaw","getLatestDate","getEarliestDate","getEarliestString","getLatestString","eq","lt","gt","unDry","Dry","registerClass","_clean","toDateRange","hasBounds","isInstant","getStartString","getEndString","toSimpleString","getEarliestStart","merge","getLatestEnd","hasStart","hasEnd","my_start","other_start","my_end","other_end","getDelta","toString","tmp","dates","_filterWindow","ret","intersect","_filterProject","Person","titles","firstnames","surnames","suffixes","alive","gender","notes","orig_name","_getHook","_isAPersonObject","ids","seen","nsources","nprojects","getAlive","hook","parts","part","getTitle","getFirstName","getSurname","getSuffix","projectID","scores","content","projectKey","isAnchor","shape","getedge_count","sort","fixedNodes","c","_generate_person_uid","substring","People","registry","_names","_isAPeopleObject","load","_updateHooks","names","canAdd","existing","clone","indexOf","funcs","timeline","getTimeLine","anchor","getNode","is_anchor","element","Business","_isABusinessObject","business","_generate_business_uid","Businesses","_isABusinessesObject","_mergeSources","Connection","n0","n1","shared","duration","correspondances","_isAConnectionObject","node0","getNode0","node1","getNode1","nProjects","getDuration","weights","getNode0Name","getNode1Name","getColorFromType","get_id","_generate_connection_uid","Connections","_connections","_isAConnectionsObject","connection","connection_id","id0","getNode0ID","id1","getNode1ID","conns","connections","nnodes","_add","item0","item1","areNodesVisible","toEdge","Position","_isAPositionObject","canonical","makeCanonical","_generate_position_uid","Positions","_isAPositionsObject","_isApositionObject","Affiliation","_isAAffiliationObject","_generate_affiliation_uid","Affiliations","_isAAffiliationsObject","affiliation","Source","description","_isASourceObject","ne","_generate_source_uid","Sources","_isASourcesObject","Note","_isANoteObject","getText","_generate_note_uid","Notes","_isANotesObject","note","Project","url","_isAProjectObject","start_time","end_time","project_id","_generate_project_uid","Projects","_isAProjectsObject","Biographies","bios","_isABiographiesObject","score_by_weight","score_by_connections","counts","add_count","node_id","score","score_by_connections_to_anchor","anchor_id","getAnchor","areConnected","_push","enabled","timestep","Social","cache","projectTimeLine","itemTimeLine","node_filters","edge_filters","max_window","scoring_function","_rebuilding","_isASocialObject","getHook","biographies","getWindow","filterWindow","project_filter","filterProject","source_filter","filterSource","node_filter","getConnectionsTo","group_filter","inGroup","new_window","getStartDate","getEndDate","fitted","_fitWindow","setWindow","clearCache","filtered","getNodeFilters","getEdgeFilters","f","_getType","result","search","projectFilter","isArray","toggleFilter","func","getNodes","getEdges","getScoringFunction","added","getNotes","SocialApp","togglePhysicsEnabled","resetAllFilters","setOverlay","closeOverlay","parse","graphData","setAnchor","setMaxWindow","highlighted_item","selected_item","overlayItem","isInfoPanelOpen","isTimeLinePanelOpen","isFilterPanelOpen","isHamburgerMenuOpen","isSearchOverlayOpen","spiralOrder","commericalNodeFilter","engineerNodeFilter","connectedNodes","isAnalysisOpen","selectedShip","simulationTypes","freeze","Gravity","Filtered","Structured","Spiral","spiralOrders","findInvestorsAndEngineers","findConnectedNodes","setScoringFunction","socialGraph","resetFiltersNotShip","slotToggleFilter","toggleProjectFilter","clearProjectFilter","setFilters","clearFilters","showInfo","closePanels","getRegistry","findAndGroupNodes","entities","getIDs","positionID","getPosition","namedPosition","getNameByID","unconnectedNodes","shipIDs","connected","unconnected","hasConnections","b","simType","setSimulationType","order","setSpiralOrder","nodesToFilter","location","reload","searchOverlay","slotSelected","slotHighlighted","slotClicked","analysisButton","toggleAnalysisPanel","spiral_order","spiralOrderButtonContainer","toggleSpiralOrder","whatIsButtonContainer","howDoIButtonContainer","analysisButtonPanel","resetButtonContainer","resetAll","simulationTypeButtonContainer","toggleSimulationType","commercialNodeLabel","engineeringNodeLabel","closePanelButton","slotSetFilter","shipNameContainer","slotSetShip","acknowledgeContainer","mainContainer","graphContainer","toggleFilterPanel","toggleTimeLinePanel","webpackContext","req","webpackContextResolve","__webpack_require__","o","resolve","module","exports"],"mappings":"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","file":"static/js/3.790cae24.chunk.js","sourcesContent":["import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport styles from \"./AboutOverlay.module.css\";\n\nimport aboutText from \"../data/aboutText.json\";\n\nclass AboutOverlay extends React.Component {\n  render() {\n    return (\n      <div className={styles.container}>\n        <div className={styles.closeButton}>\n          <button onClick={this.props.close} style={{ background: \"none\", border: \"none\", fontSize: \"2.4vh\" }}>\n            x\n          </button>\n        </div>\n        <div className={styles.textContainer}>\n          <div className={styles.header}>About</div>\n          <div className={styles.intro}>{aboutText[\"intro\"]}</div>\n          <div className={styles.introBody}>\n            <p>{aboutText[\"introParaOne\"]}</p>\n            <br></br>\n            <p>{aboutText[\"introParaTwo\"]}</p>\n          </div>\n          <div className={styles.sectionHeader}>{aboutText[\"methodHeader\"]}</div>\n          <div className={styles.body}>\n            <p>{aboutText[\"methodParaOne\"]}</p>\n            <br></br>\n            <p>{aboutText[\"methodParaTwo\"]}</p>\n          </div>\n          <div className={styles.sectionHeader}>{aboutText[\"sourcesHeader\"]}</div>\n          <div className={styles.body}>\n            <p>{aboutText[\"sourcesParaOne\"]}</p>\n            <br></br>\n            <p>{aboutText[\"sourcesParaTwo\"]}</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nAboutOverlay.propTypes = {\n  close: PropTypes.func.isRequired,\n};\n\nexport default AboutOverlay;\n","/** @jsx jsx */\nimport PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport { jsx } from \"@emotion/core\";\n\nimport styles from \"./TextButton.module.css\";\n\nclass TextButton extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.defaultCSS = {\n      background: \"none\",\n      border: \"none\",\n      fontFamily: \"Playfair Display SC\",\n      color: \"#f1f1f1\",\n      cursor: \"pointer\",\n      fontSize: \"3vh\",\n      padding: \"1vh 1vw 1vh 1.4vw\",\n      textAlign: \"left\",\n      \"&:hover\": { color: \"black\" },\n    };\n  }\n  render() {\n    const css = this.defaultCSS;\n\n    if (this.props.textColor) {\n      css[\"color\"] = this.props.textColor;\n    }\n\n    if (this.props.hoverColor) {\n      css[\"&:hover\"][\"color\"] = this.props.hoverColor;\n    }\n\n    if (this.props.fontSize) {\n      css[\"fontSize\"] = this.props.fontSize;\n    }\n\n    if (this.props.padding) {\n      css[\"padding\"] = this.props.padding;\n    }\n\n    if (this.props.fontFamily) {\n      let fontSize = this.props.fontFamily;\n\n      if (this.props.fontFamily.slice(-2) !== \"vh\") {\n        fontSize = this.defaultCSS[\"fontSize\"];\n      }\n\n      css[\"fontFamily\"] = fontSize;\n    }\n\n    let clickFn;\n    if (this.props.onClick) {\n      clickFn = this.props.onClick;\n    } else {\n      clickFn = () => null;\n    }\n\n    return (\n      <button className={styles.button} css={css} onClick={clickFn}>\n        {this.props.children}\n      </button>\n    );\n  }\n}\n\nTextButton.propTypes = {\n  children: PropTypes.any,\n  hoverColor: PropTypes.string,\n  textColor: PropTypes.string,\n  onClick: PropTypes.func,\n  style: PropTypes.object,\n};\n\nexport default TextButton;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport TextButton from \"./TextButton\";\nimport styles from \"./AnalysisPanel.module.css\";\n\nimport moment from \"moment\";\nconst saveSvgAsPng = require(\"save-svg-as-png\");\n\nclass AnalysisPanel extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.wrapperRef = React.createRef();\n    this.setWrapperRef = this.setWrapperRef.bind(this);\n    this.handleClickOutside = this.handleClickOutside.bind(this);\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"mousedown\", this.handleClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"mousedown\", this.handleClickOutside);\n  }\n\n  setWrapperRef(node) {\n    this.wrapperRef = node;\n  }\n\n  handleClickOutside(event) {\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target)) {\n      this.props.togglePanel();\n    }\n  }\n\n  render() {\n    const buttonPadding = \"1vh 1vw 1vh 1vw\";\n\n    let indirectConnectionsText = this.props.indirectConnectionsVisible ? \"Hide\" : \"Show\";\n    let unconnectedNodesText = this.props.unconnectedNodesVisible ? \"Hide\" : \"Show\";\n\n    let filterEngineersText = this.props.engineersFiltered ? \"Remove engineer filter\" : \"Filter by engineers\";\n    let filterCommercialText = this.props.commercialFiltered ? \"Remove commercial filter\" : \"Filter by commercial\";\n\n    return (\n      <div data-testid=\"AnalysisPanel\" ref={this.setWrapperRef} className={styles.wholePanel}>\n        <div className={styles.verticalSpaceTitle}></div>\n        <div className={styles.titleText}>Menu</div>\n        <div className={styles.verticalSpace}></div>\n        <TextButton\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.filterEngineeringNodes();\n          }}\n        >\n          {filterEngineersText}\n        </TextButton>\n        <TextButton\n          data-testid=\"timelineButton\"\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.filterCommercialNodes();\n          }}\n        >\n          {filterCommercialText}\n        </TextButton>\n        <TextButton\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.toggleindirectConnectionsVisible();\n          }}\n        >\n          {indirectConnectionsText + \" indirect connections\"}\n        </TextButton>\n        <TextButton\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.toggleUnconnectedNodesVisible();\n          }}\n        >\n          {unconnectedNodesText + \" unconnected nodes\"}\n        </TextButton>\n        <TextButton\n          data-testid=\"OptionsButton\"\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.resetFilters();\n          }}\n        >\n          Reset filters\n        </TextButton>\n\n        <TextButton\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.toggleSearchOverlay();\n            this.props.togglePanel();\n          }}\n        >\n          Search\n        </TextButton>\n        <TextButton\n          fontSize=\"2.4vh\"\n          padding={buttonPadding}\n          onClick={() => {\n            const imageOptions = {\n              scale: 1,\n              encoderOptions: 1,\n              backgroundColor: \"#222222\",\n            };\n\n            const filename = \"BrunelsNetwork-\" + moment().format(\"YYYYMMDD-hhmmss\") + \".png\";\n\n            saveSvgAsPng.saveSvgAsPng(document.getElementById(\"svg-viz\"), filename, imageOptions);\n          }}\n        >\n          Save as image\n        </TextButton>\n        <div className={styles.verticalSpace}></div>\n        <TextButton\n          data-testid=\"closeButton\"\n          fontSize=\"2.4vh\"\n          textColor=\"#222\"\n          hoverColor=\"white\"\n          padding={buttonPadding}\n          onClick={() => {\n            this.props.togglePanel();\n          }}\n        >\n          Close\n        </TextButton>\n      </div>\n    );\n  }\n}\n\nAnalysisPanel.propTypes = {\n  toggleFilterPanel: PropTypes.func,\n  togglePanel: PropTypes.func,\n  toggleSearchOverlay: PropTypes.func,\n  toggleUnconnectedNodesVisible: PropTypes.func.isRequired,\n  closeOverlay: PropTypes.func.isRequired,\n  toggleindirectConnectionsVisible: PropTypes.func.isRequired,\n  indirectConnectionsVisible: PropTypes.bool.isRequired,\n  filterEngineeringNodes: PropTypes.func.isRequired,\n  filterCommercialNodes: PropTypes.func.isRequired,\n  engineersFiltered: PropTypes.bool.isRequired,\n  commercialFiltered: PropTypes.bool.isRequired,\n  unconnectedNodesVisible: PropTypes.bool.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n};\n\nexport default AnalysisPanel;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport imageFilenames from \"../data/entityImageFilenames.json\";\n\nimport TextButton from \"./TextButton\";\nimport Linkify from \"react-linkify\";\n\nimport styles from \"./BioOverlay.module.css\";\n\nclass BioOverlay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = { isVisible: false };\n  }\n\n  render() {\n    const person = this.props.person;\n    const id = person.getID();\n    const name = person.getName();\n    const biographies = this.props.social.getBiographies();\n\n    // Get biography and strip name\n    let bio = biographies.getByID(id);\n\n    if (!bio) {\n      bio = \"No biography found.\";\n    }\n\n    bio = bio.replace(name + \". \", \"\");\n\n    const filename = imageFilenames[id][\"filename\"];\n\n    let sourceButton = (\n      <TextButton\n        textColor=\"black\"\n        hoverColor=\"#808080\"\n        fontSize=\"1.8vh\"\n        padding=\"0px 4px 4px 4px\"\n        onClick={this.props.toggleSourceOverlay}\n      >\n        {this.props.sourceButtonText}\n      </TextButton>\n    );\n\n    return (\n      <div data-testid=\"bioOverlay\" className={styles.container}>\n        <div className={styles.closeButton}>\n          <button onClick={this.props.toggleOverlay} style={{ background: \"none\", border: \"none\", fontSize: \"2vh\" }}>\n            x\n          </button>\n        </div>\n        <div className={styles.nameHeader}>{person.getName()}</div>\n        <div className={styles.positions}>{}</div>\n        <div className={styles.bio}>\n          <Linkify>{bio}</Linkify>\n        </div>\n        <div className={styles.sources}>\n          <div className={styles.sourcesHeader}>\n            Sources\n            <br />\n            <br />\n            <br />\n          </div>\n          <div>{sourceButton}</div>\n        </div>\n        <div className={styles.divider} />\n        <div className={styles.imageSection}>\n          <div>\n            <img data-testid=\"bioImage\" key={id} src={require(`../images/${filename}`)} alt=\"A ship\" />\n          </div>\n          <div className={styles.imageDescription}>Image description</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nBioOverlay.propTypes = {\n  social: PropTypes.object.isRequired,\n  toggleOverlay: PropTypes.func.isRequired,\n  person: PropTypes.object.isRequired,\n  toggleSourceOverlay: PropTypes.func.isRequired,\n  sourceButtonText: PropTypes.string.isRequired,\n};\n\nexport default BioOverlay;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Carousel from \"@brainhubeu/react-carousel\";\n\nimport styles from \"./SourceOverlay.module.css\";\nimport \"@brainhubeu/react-carousel/lib/style.css\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft, faAngleDoubleLeft, faAngleDoubleRight, faAngleRight } from \"@fortawesome/free-solid-svg-icons\";\n\nimport TextButton from \"./TextButton\";\n\nimport imageFilenames from \"../data/sourceImageFilenames.json\";\n\nclass SourceOverlay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onChange = this.onChange.bind(this);\n\n    this.state = { isVisible: false, currentImage: 0, elemCodes: [], imageElements: [] };\n\n    this.state.imageElements = this.props.sourceIDs.map((id) => {\n      const filename = imageFilenames[id][\"filename\"];\n\n      this.state.elemCodes.push(id);\n\n      return <img data-testid=\"sourceImage\" key={id} src={require(`../images/${filename}`)} alt=\"Manuscript\" />;\n    });\n  }\n\n  onChange(imageID) {\n    this.setState({ currentImage: imageID });\n  }\n\n  render() {\n    const sources = this.props.sources;\n    const person = this.props.person;\n\n    let showArrows = this.state.elemCodes.length > 1 ? true : false;\n\n    const sourceID = this.state.elemCodes[this.state.currentImage];\n    const source = sources.get(sourceID);\n\n    const bioButton = (\n      <TextButton\n        onClick={this.props.toggleBioOverlay}\n        textColor=\"black\"\n        hoverColor=\"#808080\"\n        fontSize=\"1.8vh\"\n        padding=\"2px 2px 2px 2px\"\n        fontFamily=\"Playfair Display Medium\"\n      >\n        Open biography\n      </TextButton>\n    );\n\n    return (\n      <div data-testid=\"sourceOverlay\" className={styles.container}>\n        <div className={styles.closeButton}>\n          <button onClick={this.props.toggleOverlay} style={{ background: \"none\", border: \"none\", fontSize: \"2vh\" }}>\n            x\n          </button>\n        </div>\n        <div className={styles.nameHeader}>{person.getName()}</div>\n\n        <div className={styles.body}>\n          <div className={styles.sourceName}>{source.getName()}</div>\n          <div>{source.getDescription()}</div>\n        </div>\n        <div className={styles.biography}>{bioButton}</div>\n        <div className={styles.divider} />\n        <div className={styles.imageSection}>\n          <Carousel\n            value={this.state.currentImage}\n            onChange={this.onChange}\n            slidesPerPage={1}\n            arrows={showArrows}\n            arrowLeft={<FontAwesomeIcon icon={faAngleDoubleLeft} />}\n            arrowLeftDisabled={<FontAwesomeIcon icon={faAngleLeft} />}\n            arrowRight={<FontAwesomeIcon icon={faAngleDoubleRight} />}\n            arrowRightDisabled={<FontAwesomeIcon icon={faAngleRight} />}\n            addArrowClickHandler\n          >\n            {this.state.imageElements}\n          </Carousel>\n        </div>\n      </div>\n    );\n  }\n}\n\nSourceOverlay.propTypes = {\n  sources: PropTypes.object.isRequired,\n  sourceIDs: PropTypes.array.isRequired,\n  toggleOverlay: PropTypes.func.isRequired,\n  toggleBioOverlay: PropTypes.func.isRequired,\n  person: PropTypes.object.isRequired,\n};\n\nexport default SourceOverlay;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./Overlay.module.css\";\n\n// Based on https://stackoverflow.com/a/55003301\nfunction Overlay(props) {\n  const { useState } = React;\n  const [open, setOpen] = useState(true);\n  if (open) {\n    let style = styles.overlay;\n\n    if (!props.useBackground) {\n      style = styles.overlayNoBackground;\n    }\n\n    return (\n      <div\n        data-testid=\"overlay\"\n        className={style}\n        onClick={() => {\n          props.toggleOverlay();\n          setOpen(false);\n        }}\n      >\n        <div\n          onClick={(e) => {\n            e.stopPropagation();\n          }}\n        >\n          {props.children}\n        </div>\n      </div>\n    );\n  }\n  return null;\n}\n\nOverlay.defaultProps = {\n  useBackground: true,\n};\n\nexport default Overlay;\n\nOverlay.propTypes = {\n  toggleOverlay: PropTypes.func.isRequired,\n  children: PropTypes.element.isRequired,\n  useBackground: PropTypes.bool,\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport BioOverlay from \"./BioOverlay\";\nimport SourceOverlay from \"./SourceOverlay\";\nimport Overlay from \"./Overlay\";\n\nclass OverlayWrapper extends React.Component {\n  render() {\n    const sourceButtonText = this.props.sourceButtonText;\n    const socialSources = this.props.social.getSources();\n\n    if (!this.props.sourceIDs) {\n      return null;\n    }\n\n    let overlay = null;\n    if (this.props.isOverlayOpen && this.props.isSourceOverlayOpen) {\n      overlay = (\n        <Overlay toggleOverlay={this.props.toggleOverlay}>\n          <SourceOverlay\n            sources={socialSources}\n            person={this.props.entity}\n            sourceIDs={this.props.sourceIDs}\n            toggleOverlay={this.props.toggleOverlay}\n            toggleBioOverlay={this.props.toggleBioOverlay}\n          />\n        </Overlay>\n      );\n    } else if (this.props.isOverlayOpen && this.props.isBioOverlayOpen) {\n      overlay = (\n        <Overlay toggleOverlay={this.props.toggleOverlay}>\n          <BioOverlay\n            sources={socialSources}\n            person={this.props.entity}\n            social={this.props.social}\n            toggleOverlay={this.props.toggleOverlay}\n            toggleSourceOverlay={this.props.toggleSourceOverlay}\n            sourceButtonText={sourceButtonText}\n          />\n        </Overlay>\n      );\n    }\n\n    return overlay;\n  }\n}\n\nOverlayWrapper.propTypes = {\n  entity: PropTypes.object.isRequired,\n  isBioOverlayOpen: PropTypes.bool.isRequired,\n  isOverlayOpen: PropTypes.bool.isRequired,\n  isSourceOverlayOpen: PropTypes.bool.isRequired,\n  social: PropTypes.object.isRequired,\n  sourceButtonText: PropTypes.string.isRequired,\n  sourceIDs: PropTypes.array.isRequired,\n  toggleBioOverlay: PropTypes.func.isRequired,\n  toggleOverlay: PropTypes.func.isRequired,\n  toggleSourceOverlay: PropTypes.func.isRequired,\n};\n\nexport default OverlayWrapper;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport TextButton from \"./TextButton\";\n\nimport styles from \"./Popover.module.css\";\n\nimport OverlayWrapper from \"./OverlayWrapper\";\n\n// The detection of outside clicks in this class taken from\n// https://stackoverflow.com/a/42234988\n\nclass Popover extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.setWrapperRef = this.setWrapperRef.bind(this);\n    this.handleClickOutside = this.handleClickOutside.bind(this);\n\n    this.toggleSourceOverlay = this.toggleSourceOverlay.bind(this);\n    this.toggleBioOverlay = this.toggleBioOverlay.bind(this);\n\n    this.toggleOverlay = this.toggleOverlay.bind(this);\n\n    this.state = { isOverlayOpen: false, isSourceOverlayOpen: false, isBioOverlayOpen: false };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"mousedown\", this.handleClickOutside);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"mousedown\", this.handleClickOutside);\n  }\n\n  setWrapperRef(node) {\n    this.wrapperRef = node;\n  }\n\n  handleClickOutside(event) {\n    if (this.wrapperRef && !this.wrapperRef.contains(event.target)) {\n      this.props.clearPopups();\n    }\n  }\n\n  toggleOverlay() {\n    this.setState({ isOverlayOpen: !this.state.isOverlayOpen });\n    this.props.clearPopups();\n  }\n\n  toggleSourceOverlay() {\n    this.setState({ isOverlayOpen: true, isSourceOverlayOpen: true, isBioOverlayOpen: false });\n  }\n\n  toggleBioOverlay() {\n    this.setState({ isOverlayOpen: true, isSourceOverlayOpen: false, isBioOverlayOpen: true });\n  }\n\n  truncate(str, max = 10) {\n    const array = str.trim().split(\" \");\n\n    let ellipsis;\n    if (array.length > max) {\n      ellipsis = \"...\";\n      //   this.setState({ readMoreEnabled: true });\n    } else {\n      ellipsis = \"\";\n    }\n\n    return array.slice(0, max).join(\" \") + ellipsis;\n  }\n\n  render() {\n    const node = this.props.node;\n    const selectedShipID = this.props.selectedShipID;\n\n    const name = node.label;\n    const social = this.props.social;\n    const socialSources = social.getSources();\n\n    let readMoreButton = (\n      <TextButton\n        textColor=\"#9B1C31\"\n        hoverColor=\"#808080\"\n        fontSize=\"1.5vh\"\n        padding=\"0px 2px 2px 2px\"\n        fontFamily=\"Playfair Display Medium\"\n        onClick={this.toggleBioOverlay}\n      >\n        Read more\n      </TextButton>\n    );\n\n    const buttonStrings = [];\n\n    let nodeType = node[\"type\"];\n\n    let entity;\n    if (nodeType === \"person\") {\n      entity = this.props.social.getPeople(false).get(node.id);\n    } else if (nodeType === \"business\") {\n      entity = this.props.social.getBusinesses(false).get(node.id);\n    } else {\n      throw new TypeError(\"Incorrect type or no type on node\");\n    }\n\n    const sourceIDs = entity.getSources()[selectedShipID];\n\n    let sourceButtonText = \"\";\n    if (!sourceIDs) {\n      console.error(\"Cannot find sources for this project : \", selectedShipID, \"\\n Sources : \", socialSources);\n    } else {\n      for (const id of sourceIDs) {\n        buttonStrings.push(socialSources.get(id).getName());\n      }\n    }\n\n    sourceButtonText = buttonStrings.join(\", \");\n\n    // Get biography for node\n    let bio = social.getBiographies().getByID(node.id);\n\n    if (!bio) {\n      bio = \"No biography found.\";\n    } else {\n      bio = bio.replace(name + \".  \", \"\");\n      bio = this.truncate(bio, 40);\n    }\n\n    // Get the location of the click within the viewport so we can open the popover\n    // in the correct location\n    const innerWidth = window.innerWidth; // px\n    const innerHeight = window.innerHeight; // px\n\n    const popoverHeightVH = 30; // vh\n    const popoverWidthVW = 15; // vw\n\n    const popoverHeight = innerHeight * (popoverHeightVH / 100); // px\n    const popoverWidth = innerWidth * (popoverWidthVW / 100); // px\n\n    let left;\n    if (node.x > innerWidth - popoverWidth) {\n      left = node.x - 20 - popoverWidth + \"px\";\n    } else {\n      left = node.x + 10 + \"px\";\n    }\n\n    let top;\n    if (node.y > innerHeight - popoverHeight) {\n      top = node.y - 10 - popoverHeight + \"px\";\n    } else {\n      top = node.y + \"px\";\n    }\n\n    return (\n      <div ref={this.setWrapperRef}>\n        <div\n          className={styles.popOver}\n          style={{ top: top, left: left, height: popoverHeightVH + \"vh\", width: popoverWidthVW + \"vw\" }}\n        >\n          <div className={styles.closeButton}>\n            <button onClick={this.props.clearPopups} style={{ background: \"none\", border: \"none\", fontSize: \"2vh\" }}>\n              x\n            </button>\n          </div>\n          <div className={styles.header}>{name}</div>\n          <div className={styles.bioSection}>{bio}</div>\n          <div className={styles.edge_count}>Number of connections: {node[\"edge_count\"][selectedShipID]}</div>\n          <div className={styles.readMore}>{readMoreButton}</div>\n          <div className={styles.sourceHeader}>Sources</div>\n          <div data-testid=\"sourceButton\" className={styles.sourceSection}>\n            <TextButton\n              data-testid=\"sourceButton\"\n              textColor=\"black\"\n              hoverColor=\"#808080\"\n              fontSize=\"1.5vh\"\n              padding=\"0px 4px 4px 4px\"\n              onClick={this.toggleSourceOverlay}\n            >\n              {sourceButtonText}\n            </TextButton>\n          </div>\n        </div>\n        <OverlayWrapper\n          isBioOverlayOpen={this.state.isBioOverlayOpen}\n          isOverlayOpen={this.state.isOverlayOpen}\n          isSourceOverlayOpen={this.state.isSourceOverlayOpen}\n          toggleOverlay={this.toggleOverlay}\n          toggleBioOverlay={this.toggleBioOverlay}\n          toggleSourceOverlay={this.toggleSourceOverlay}\n          node={node}\n          social={social}\n          entity={entity}\n          sourceButtonText={sourceButtonText}\n          sourceIDs={sourceIDs}\n        />\n      </div>\n    );\n  }\n}\n\nPopover.propTypes = {\n  social: PropTypes.object.isRequired,\n  node: PropTypes.object.isRequired,\n  togglePopover: PropTypes.func.isRequired,\n  selectedShipID: PropTypes.string,\n  clearPopups: PropTypes.func.isRequired,\n};\n\nexport default Popover;\n","/** Internal function used to return a function that\n *  returns a constant value\n **/\nfunction _constant(x) {\n  return function () {\n    return x;\n  };\n}\n\n/** Internal function used to return a function that counts up from\n *  0 every time it is called\n */\nfunction _return_index() {\n  let i = 0;\n  return function () {\n    let j = i;\n    i += 1;\n    return j;\n  }\n}\n\n/** Force function that pulls nodes towards a spiral design that\n *  is centered in a canvas of specified width and height. You can\n *  specify the strength of this force, and also the index that\n *  maps a node to a point in the spiral. The center point of the\n *  spiral is index 0, with subsequent points counting up uniformly\n *  from there. The spiral is resized automatically to ensure that\n *  all points are contained on the canvas.\n */\nexport default function force_spiral(width, height) {\n  let nodes = null;\n  let index = _return_index();\n  let strength = _constant(0.1);\n  let strengths = null;\n  let indexes = null;\n  let points_x = null;\n  let points_y = null;\n\n  if (height == null) height = 600;\n  if (width == null) width = 600;\n\n  /** Calculate the force on the nodes and update the velocities.\n   *  This uses the spiral points pre-calculated in 'initialise'.\n   *  Each node looks up its spiral point based on the index\n   *  assigned to each node\n   */\n  function force(alpha) {\n    if (!nodes) return;\n\n    for (let i = 0, n = nodes.length; i < n; ++i) {\n      let node = nodes[i];\n      let index = indexes[i];\n      node.vx += (points_x[index] - node.x) * strengths[i] * alpha;\n      node.vy += (points_y[index] - node.y) * strengths[i] * alpha;\n    }\n  }\n\n  /** Initialise the spiral. This pre-fectches all of the strengths\n   *  for the nodes and places them into an array.\n   *\n   *  This then pre-fetches all of the node indexes, and, using the\n   *  maximum index, works out and pre-calculates the points of a\n   *  spiral with enough points to satisfy all indexes, and that\n   *  ensures that they all fit onto the screen.\n   *\n   *  These points are placed into the points_x and points_y arrays.\n   */\n  function initialize() {\n    if (!nodes) return;\n\n    let n = nodes.length;\n\n    // collect the strengths and indexes\n    strengths = new Array(n);\n    indexes = new Array(n);\n\n    for (let i = 0; i < n; ++i) {\n      strengths[i] = +strength(nodes[i], i, nodes);\n      indexes[i] = Math.floor(index(nodes[i], i, nodes));\n\n      if (indexes[i] < 0) {\n        indexes[i] = 0;\n      } else if (indexes[i] >= 1024 * 1024) {\n        // limit to 1 MB\n        indexes[i] = 1024 * 1024;\n      }\n    }\n\n    // what is the maximum index - will need to know this to generate\n    // all of the points\n    let max_index = Math.max(...indexes);\n\n    // now calculate all of the points\n    points_x = new Array(max_index + 1);\n    points_y = new Array(max_index + 1);\n\n    let angle = 0.0;\n    let radius = 0.0;\n\n    let min_x = 0.0;\n    let max_x = 0.0;\n    let min_y = 0.0;\n    let max_y = 0.0;\n\n    for (let i = 1; i <= max_index; ++i) {\n      radius = Math.sqrt(i);\n      angle += Math.asin(1 / radius);\n      points_x[i] = Math.cos(angle) * radius;\n      points_y[i] = Math.sin(angle) * radius;\n\n      min_x = Math.min(min_x, points_x[i]);\n      max_x = Math.max(max_x, points_x[i]);\n\n      min_y = Math.min(min_y, points_y[i]);\n      max_y = Math.max(max_y, points_y[i]);\n    }\n\n    // we now need to scale such that 'radius' can fit comfortably\n    // on a width * height page\n    let center_x = width / 2;\n    let center_y = height / 2;\n\n    let scale_x = 0.80 * width / (max_x - min_x);\n    let scale_y = 0.80 * height / (max_y - min_y);\n\n    // offset the center slightly as the spiral biases slightly\n    center_x -= 0.5 * scale_x * (max_x + min_x);\n    center_y -= 0.5 * scale_y * (max_y + min_y);\n\n    points_x[0] = center_x;\n    points_y[0] = center_y;\n\n    for (let i = 1; i <= max_index; ++i) {\n      points_x[i] = center_x + (points_x[i] * scale_x);\n      points_y[i] = center_y + (points_y[i] * scale_y);\n    }\n  }\n\n  /** Add the initialise function to the force object that will be returned */\n  force.initialize = function (_) {\n    nodes = _;\n    initialize();\n  };\n\n  /** Allow the user to supply their own value or function that\n   *  sets the strength for each node\n   */\n  force.strength = function (_) {\n    return arguments.length ? ((strength = typeof _ === \"function\" ?\n      _ : _constant(+_)), initialize(), force) : strength;\n  };\n\n  /** Allow the user to supply their own value or function that\n   *  sets the index on the spiral for each node\n   */\n  force.index = function (_) {\n    return arguments.length ? ((index = typeof _ === \"function\" ?\n      _ : _return_index()), initialize(), force) : index;\n  };\n\n  return force;\n}","import PropTypes from \"prop-types\";\nimport * as d3 from \"d3\";\n\nimport React from \"react\";\n\nimport lodash from \"lodash\";\nimport {\n  v4 as uuidv4\n} from \"uuid\";\n\nimport force_spiral from \"./force_spiral.js\";\n\nimport styles from \"../ForceGraph.module.css\";\n\nimport positionGroups from \"../../data/positionGroups.json\";\n\nfunction _null_function() {}\n\nfunction constrain(x, w, r = 20) {\n  return Math.max(3 * r, Math.min(w - r, x));\n}\n\nfunction randomShift(min = 0.01, max = 0.15) {\n  return 1 - Math.random() * (max - min) + max;\n}\n\nfunction handleMouseOver(THIS) {\n  function handle() {\n    let svg = THIS._mainGroup;\n    if (!svg) {\n      return;\n    }\n\n    let node = d3.select(this);\n    node.raise();\n\n    let id = node.attr(\"id\");\n\n    if (!id) {\n      return;\n    }\n\n    //highlight the node\n    let items = svg.selectAll(`#${id}`);\n    items.classed(styles.highlight, true);\n\n    //highlight the connection lines with this node as a source\n    items = svg.selectAll(`[source_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    //highlight the nodes with this node as a target\n    items.each((d) => {\n      let target_id = d.target.id;\n      svg.selectAll(`#${target_id}`).classed(styles.highlight, true);\n    });\n\n    //highlight the connection lines with this node as a target\n    items = svg.selectAll(`[target_id=${id}]`);\n    items.classed(styles.highlight, true);\n\n    //highlight the nodes with this node as a source\n    items.each((d) => {\n      let source_id = d.source.id;\n      svg.selectAll(`#${source_id}`).classed(styles.highlight, true);\n    });\n\n    if (node.attr(\"source_id\")) {\n      svg.selectAll(`#${node.attr(\"source_id\")}`).classed(styles.highlight, true);\n\n      svg.selectAll(`#${node.attr(\"target_id\")}`).classed(styles.highlight, true);\n    }\n\n    THIS.state.signalMouseOver(id);\n  }\n\n  return handle;\n}\n\nfunction handleMouseOut(THIS) {\n  function handle() {\n    let svg = THIS._mainGroup;\n    if (!svg) {\n      return;\n    }\n\n    let node = d3.select(this);\n    let id = node.attr(\"id\");\n\n    let items = svg.selectAll(`#${id}`);\n\n    items.classed(styles.highlight, false);\n\n    //highlight the connection lines with this node as a source\n    items = svg.selectAll(`[source_id=${id}]`);\n    items.classed(styles.highlight, false);\n\n    //highlight the nodes with this node as a target\n    items.each((d) => {\n      let target_id = d.target.id;\n      svg.selectAll(`#${target_id}`).classed(styles.highlight, false);\n    });\n\n    //highlight the connection lines with this node as a target\n    items = svg.selectAll(`[target_id=${id}]`);\n    items.classed(styles.highlight, false);\n\n    //highlight the nodes with this node as a source\n    items.each((d) => {\n      let source_id = d.source.id;\n      svg.selectAll(`#${source_id}`).classed(styles.highlight, false);\n    });\n\n    if (node.attr(\"source_id\")) {\n      svg.selectAll(`#${node.attr(\"source_id\")}`).classed(styles.highlight, false);\n\n      svg.selectAll(`#${node.attr(\"target_id\")}`).classed(styles.highlight, false);\n    }\n\n    THIS.state.signalMouseOut(id);\n  }\n\n  return handle;\n}\n\nfunction _resolve(item) {\n  if (!item) {\n    return null;\n  } else if (item.getID) {\n    return item.getID();\n  } else {\n    return item;\n  }\n}\n\n/* eslint-disable react/no-direct-mutation-state */\nclass ForceGraphD3 extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateLink = this.updateLink.bind(this);\n    this.updateNodeText = this.updateNodeText.bind(this);\n    this.updateNode = this.updateNode.bind(this);\n    this.draw = this.draw.bind(this);\n    this.drawFromScratch = this.drawFromScratch.bind(this);\n    this.setPositionColors = this.setPositionColors.bind(this);\n    this.getPositionColor = this.getPositionColor.bind(this);\n    this.update = this.update.bind(this);\n    this.updateGraph = this.updateGraph.bind(this);\n\n    this.drag = this.drag.bind(this);\n    this.dragLink = this.dragLink.bind(this);\n    this.getWeight = this.getWeight.bind(this);\n\n    // Generate a UID for this graph so that we don't clash\n    // with any other graphs on the same page\n    let uid = uuidv4();\n\n    this.state = {\n      width: null,\n      height: null,\n      social: null,\n      selected: null,\n      highlighted: null,\n      lastPhysics: \"fast\",\n      physicsEnabled: this.props.physicsEnabled,\n      signalClicked: _null_function,\n      signalMouseOut: _null_function,\n      signalMouseOver: _null_function,\n      indirectConnectionsVisible: false,\n      hideUnconnectedNodes: false,\n      standardSimulation: true,\n      selectedShipID: null,\n      lastSimulationType: \"Standard\",\n      colors: {},\n      groupTable: {},\n      uid: uid.slice(uid.length - 8),\n    };\n\n    this._size_changed = true;\n    this._graph_changed = true;\n    this._is_running = false;\n    this._is_drawn = false;\n\n    // Set parameters for the force simulation\n    this._target_decay = 0.1;\n    this._target_alpha = 0.3;\n\n    this._tooltips = [];\n    // this.updateGraph = this.updateGraph.bind(this);\n    // this.update = this.update.bind(this);\n\n    this.state.standardSimulation = true;\n\n    this.update(props);\n  }\n\n  getSelectedShipID() {\n    return this.props.selectedShipID;\n  }\n\n  getNodeBio(id) {\n    return this.state.social.getBiographies().getByID(id);\n  }\n\n  getNodeConnections(id) {\n    return this.state.social.getConnections().find(id);\n  }\n\n  gotConnections(id) {\n    return this.state.social.getConnections().gotConnections(id);\n  }\n\n  updateGraph(social) {\n    let w = this.state.width;\n    let h = this.state.height;\n\n    this.state.social = social;\n\n    if (!w || !h) {\n      return;\n    }\n\n    let graph = null;\n\n    if (social) {\n      graph = social.getGraph();\n    }\n\n    // The social object will cache the 'getGraph' result, meaning\n    // that any change in this object signals that the graph needs\n    // to be redrawn\n    if (graph !== this.state.graph) {\n      //save the cached graph\n      this.state.graph = graph;\n\n      // This view needs to clone its own copy of the graph, as\n      // D3 will update the graph object. We need to clone in case\n      // two ForceGraph.d3 views are viewing the same Social graph\n      graph = lodash.cloneDeep(this.state.graph);\n\n      // need to update IDs so that the edges refer to the index\n      // of the node in the nodes array - this could be optimised!\n      for (let l in graph.edges) {\n        let edge = graph.edges[l];\n        for (let n in graph.nodes) {\n          let node = graph.nodes[n];\n          if (edge.source === node.id) {\n            edge.source = n;\n            edge.source_id = node.id;\n          } else if (edge.target === node.id) {\n            edge.target = n;\n            edge.target_id = node.id;\n          }\n        }\n      }\n\n      for (let n in graph.nodes) {\n        let node = graph.nodes[n];\n\n        node.x = w * Math.random();\n        node.y = h * Math.random();\n\n        if (node.fixed && this.props.simulationType === \"Structured\") {\n          node.fx = w * node.fixedLocation[\"x\"] * randomShift();\n          node.fy = h * node.fixedLocation[\"y\"] * randomShift();\n        }\n      }\n\n      this._graph = graph;\n      this._graph_changed = true;\n    }\n  }\n\n  update(props) {\n    let size_changed = false;\n\n    if (!this.state.physicsEnabled) {\n      this.state.physicsEnabled = this.props.physicsEnabled;\n    }\n\n    if (!this.state.standardSimulation) {\n      this.state.standardSimulation = this.props.standardSimulation;\n    }\n\n    if (props.indirectConnectionsVisible !== this.state.indirectConnectionsVisible) {\n      this.state.indirectConnectionsVisible = props.indirectConnectionsVisible;\n      this._graph_changed = true;\n    }\n\n    let hasWidth = Object.prototype.hasOwnProperty.call(props, \"width\");\n\n    if (hasWidth) {\n      if (this.state.width !== props.width) {\n        this.state.width = props.width;\n        // this.setState({ width: props.width });\n        size_changed = true;\n      }\n    }\n\n    let hasHeight = Object.prototype.hasOwnProperty.call(props, \"height\");\n\n    if (hasHeight) {\n      if (this.state.height !== props.height) {\n        this.state.height = props.height;\n        // this.setState({ height: props.height });\n        size_changed = true;\n      }\n    }\n\n    if (size_changed) {\n      this._size_changed = true;\n    }\n\n    let hasSignalClicked = Object.prototype.hasOwnProperty.call(props, \"signalClicked\");\n\n    if (hasSignalClicked) {\n      if (this.state.signalClicked) {\n        this.state.signalClicked = props.signalClicked;\n      } else {\n        this.state.signalClicked = _null_function;\n      }\n    }\n\n    let hasSignalMouseOut = Object.prototype.hasOwnProperty.call(props, \"signalMouseOut\");\n\n    if (hasSignalMouseOut) {\n      if (this.state.signalMouseOut) {\n        this.state.signalMouseOut = props.signalMouseOut;\n      } else {\n        this.state.signalMouseOut = _null_function;\n      }\n    }\n\n    let hasSignalMouseOver = Object.prototype.hasOwnProperty.call(props, \"signalMouseOver\");\n\n    if (hasSignalMouseOver) {\n      if (this.state.signalMouseOver) {\n        this.state.signalMouseOver = props.signalMouseOver;\n      } else {\n        this.state.signalMouseOver = _null_function;\n      }\n    }\n\n    let hasSocial = Object.prototype.hasOwnProperty.call(props, \"social\");\n\n    if (hasSocial) {\n      this.updateGraph(props.social);\n    }\n\n    // We can setup the colours object\n    this.setPositionColors();\n\n    let hasSelected = Object.prototype.hasOwnProperty.call(props, \"selected\");\n\n    if (hasSelected) {\n      this.state.selected = _resolve(props.selected);\n    }\n\n    let hasHighlighted = Object.prototype.hasOwnProperty.call(props, \"highlighted\");\n\n    if (hasHighlighted) {\n      this.state.highlighted = _resolve(props.highlighted);\n    }\n\n    // if (props.standardSimulation !== this.state.standardSimulation) {\n    //   this.state.standardSimulation = props.standardSimulation;\n    //   this._graph_changed = true;\n    // }\n\n    if (this.props.selectedShipID !== this.state.selectedShipID) {\n      this.state.selectedShipID = this.props.selectedShipID;\n      this._graph_changed = true;\n    }\n\n    if (this.props.simulationType !== this.state.simulationType) {\n      this.state.simulationType = this.props.simulationType;\n      //   this.changeSimulationType();\n      this._graph_changed = true;\n    }\n\n    // For now get the ID of the SS Great Eastern so we don't assign force to the nodes\n    this.state.greatEasternID = this.state.social.getProjects().getByName(\"SS Great Eastern\").getID();\n  }\n\n  className() {\n    return `ForceGraphD3-${this.state.uid}`;\n  }\n\n  getPositionColor(entity) {\n    // Businesses have a single colour\n    if (entity[\"type\"] === \"business\") {\n      return positionGroups[\"business\"][\"color\"];\n    }\n\n    // Anchor\n    if (entity[\"group\"] === \"anchor\") {\n      return positionGroups[\"anchor\"][\"color\"];\n    }\n\n    // This shouldn't happen, but all nodes must have a colour set\n    if (!entity[\"positions\"]) {\n      console.error(\"No colour available for this entity : \", entity);\n      return \"#FFFFFF\";\n    }\n\n    const positionCode = this.getPositionCode(entity);\n\n    let color = this.state.colors[positionCode];\n\n    return color;\n  }\n\n  getPositionCode(entity) {\n    const shipID = this.getSelectedShipID();\n\n    let code = null;\n    // There might not be a position for this project\n    try {\n      code = entity[\"positions\"][shipID][0];\n    } catch (error) {\n      code = \"NA\";\n    }\n\n    return code;\n  }\n\n  setPositionColors() {\n    // Read all the positions for this graph\n    const namedPositions = this.state.social.getPositions().items();\n\n    let colorTable = {};\n    let groupTable = {};\n\n    // Read the positions and colours from a JSON file that can be easily updated\n    for (let [position, uid] of Object.entries(namedPositions)) {\n      // Process these to remove whitespace and non letter/number characters so we have less likelihood of errors\n      let trimPosition = position\n        .toLowerCase()\n        .replace(/\\s/g, \"\")\n        .replace(/[.,/#!$%^&*;:{}=\\-_`~()]/g, \"\");\n\n      // Here positionGroups is the import JSON object containing\n      // which positions are in which group and the colour assigned to them\n      for (let [group, members] of Object.entries(positionGroups)) {\n        if (members[\"members\"].includes(trimPosition)) {\n          colorTable[uid] = members[\"color\"];\n          groupTable[uid] = group;\n          break;\n        } else {\n          // Assign bright blue to any we don't recognize, but this\n          // shouldn't (hopefully) happen if the JSON is correct\n          colorTable[uid] = positionGroups[\"unknown\"][\"color\"];\n        }\n      }\n    }\n\n    // Set the colour for the anchor\n    colorTable[\"anchor\"] = positionGroups[\"anchor\"][\"color\"];\n\n    // This is being called from within the ctor so we can't use setState here\n    this.state.colors = colorTable;\n    this.state.groupTable = groupTable;\n  }\n\n  getGroupForce(entity) {\n    if (!entity.positions) {\n      const entity_id = entity[\"id\"].toLowerCase();\n\n      // Need a better way of handling businesses\n      if (entity_id.startsWith(\"b\")) {\n        return -0.11;\n      } else {\n        console.error(\"Undefined positions for entity \", entity);\n        return 0;\n      }\n    }\n\n    if (this.props.selectedShipID === this.state.greatEasternID) {\n      return 0;\n    }\n\n    if (!this.gotConnections(entity.id)) {\n      return 0;\n    }\n\n    const leftForce = [\"engineering\"];\n    const rightForce = [\"commercial\"];\n    const noForce = [\"other\", \"anchor\", \"business\", \"unknown\"];\n\n    // Get the position codes for this entity\n    const positionCode = this.getPositionCode(entity);\n    // The groupTable tells us which group this entity belongs to and so determines its force\n    const positionGroup = this.state.groupTable[positionCode];\n\n    if (leftForce.includes(positionGroup)) {\n      return -0.17;\n    } else if (rightForce.includes(positionGroup)) {\n      return 0.1;\n    } else if (noForce.includes(positionGroup)) {\n      return 0.1;\n    }\n\n    return 0;\n  }\n\n  drag() {\n    let simulation = this._simulation;\n\n    return d3\n      .drag()\n      .on(\"start\", (d) => {\n        d.fx = d.x;\n        d.fy = d.y;\n      })\n      .on(\"drag\", (d) => {\n        if (!this._is_running) simulation.restart();\n\n        let w = this.state.width;\n        let h = this.state.height;\n\n        d.fx = constrain(d3.event.x, w, d.r);\n        d.fy = constrain(d3.event.y, h, d.r);\n      })\n      .on(\"end\", (d) => {\n        if (!d.fixed) {\n          d.fx = null;\n          d.fy = null;\n        }\n      });\n  }\n\n  dragLink() {\n    let simulation = this._simulation;\n\n    return d3\n      .drag()\n      .on(\"start\", (d) => {\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        //fix those nodes in place\n        source.fx = source.x;\n        source.fy = source.y;\n\n        target.fx = target.x;\n        target.fy = target.y;\n      })\n      .on(\"drag\", (d) => {\n        if (!this._is_running) simulation.restart();\n\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        //moves those nodes with the event - move the center point of the\n        //line connecting these two nodes...\n        let dx = 0.5 * (target.x - source.x);\n        let dy = 0.5 * (target.y - source.y);\n\n        source.fx = constrain(d3.event.x - dx, this.state.width, source.r);\n        source.fy = constrain(d3.event.y - dy, this.state.height, source.r);\n\n        target.fx = constrain(d3.event.x + dx, this.state.width, target.r);\n        target.fy = constrain(d3.event.y + dy, this.state.height, target.r);\n      })\n      .on(\"end\", (d) => {\n        // simulation.alphaTarget(0).restart();\n\n        //find the two nodes connected to this edge\n        let source = this._graph.nodes[d.source.index];\n        let target = this._graph.nodes[d.target.index];\n\n        if (!source.fixed) {\n          source.fx = null;\n          source.fy = null;\n        }\n\n        if (!target.fixed) {\n          target.fx = null;\n          target.fy = null;\n        }\n      });\n  }\n\n  getWeight(item) {\n    const shipID = this.getSelectedShipID();\n    // Big weights make the size of circles too large\n    const sizeScale = 0.5;\n\n    // let weight = sizeScale * item[\"weight\"][shipID];\n    let weight = sizeScale * item[\"weight\"][shipID];\n\n    if (!weight) weight = 2;\n\n    return weight;\n  }\n\n  updateNode(data) {\n    let node = this._mainGroup.select(\".node-group\").selectAll(\".node\");\n\n    node = node\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"circle\").attr(\"class\", `node ${styles.node}`),\n        (update) => update.attr(\"class\", `node ${styles.node}`)\n      )\n      // Here size is the weight given to that entity\n      .attr(\"r\", (d) => {\n        // If no project selected keep previous weight\n        // Otherwise update using the selected project code\n        return this.getWeight(d);\n      })\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .attr(\"fill\", (d) => {\n        return this.getPositionColor(d);\n      })\n      .on(\"click\", (d) => this.props.emitPopProps(d))\n      .on(\"mouseover\", handleMouseOver(this))\n      .on(\"mouseout\", handleMouseOut(this))\n      .call(this.drag());\n\n    return node;\n  }\n\n  updateNodeText(data) {\n    let text = this._mainGroup.select(\".node_text-group\").selectAll(\".node_text\");\n\n    // Big weights make the size of circles too large\n    const sizeScale = 0.5;\n\n    text = text\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"text\").attr(\"class\", `node_text ${styles.node_text}`),\n        (update) => update.attr(\"class\", `node_text ${styles.node_text}`)\n      )\n      .text((d) => d.label)\n      .style(\"font-size\", () => {\n        return \"1.5vh\";\n        // return Math.max(1.2, 2 * Math.log10(this.getWeight(d))) + \"vh\";\n      })\n      .attr(\"dx\", (d) => {\n        return this.getWeight(d) + \"px\";\n      })\n      .attr(\"dy\", (d) => {\n        return -1 * (3 + sizeScale * this.getWeight(d)) + \"px\";\n      })\n      .attr(\"text-anchor\", \"start\")\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .on(\"click\", (d) => this.props.emitPopProps(d))\n      .on(\"mouseover\", handleMouseOver(this))\n      .on(\"mouseout\", handleMouseOut(this))\n      .call(this.drag());\n\n    return text;\n  }\n\n  updateLink(data) {\n    let link = this._mainGroup.select(\".link-group\").selectAll(\".link\");\n\n    // Add prop here\n    let indirectStyle = this.state.indirectConnectionsVisible ? styles.linkIndirect : styles.linkInvisible;\n\n    const weightCutoff = 4;\n\n    link = link\n      .data(data, (d) => d.id)\n      .join(\n        (enter) => enter.append(\"path\").attr(\"class\", `link ${styles.link}`),\n        (update) => update.attr(\"class\", `link ${styles.link}`)\n      )\n      .attr(\"class\", (d) => {\n        // Here we're using the weight of the edges between\n        // nodes to  change the properties of the line drawn\n        if (d.type === \"direct\") {\n          if (d.value > weightCutoff) {\n            return `link ${styles.link}`;\n          } else {\n            return `link ${styles.linkWeak}`;\n          }\n        } else {\n          return `link ${indirectStyle}`;\n        }\n      })\n      .attr(\"id\", (d) => {\n        return d.id;\n      })\n      .attr(\"source_id\", (d) => {\n        return d.source_id;\n      })\n      .attr(\"target_id\", (d) => {\n        return d.target_id;\n      })\n      .on(\"mouseover\", handleMouseOver(this))\n      .on(\"mouseout\", handleMouseOut(this))\n      .call(this.dragLink());\n\n    return link;\n  }\n\n  changeSimulationType() {\n    if (this._graph) {\n      console.log(`${this.state.lastSimulationType} ${this.props.simulationType}`);\n\n      let simulation_type = this.props.simulationType;\n\n      if (simulation_type === \"Filtered\") {\n        simulation_type = this.state.lastSimulationType;\n      }\n\n      this.state.lastSimulationType = simulation_type;\n      this.state.selectedShipID = this.props.selectedShipID;\n\n      switch (simulation_type) {\n        case \"Gravity\":\n          this.gravitySimulation();\n          break;\n        case \"Structured\":\n          this.structuredSimulation();\n          break;\n        case \"Spiral\":\n          this.spiralSimulation();\n          break;\n        case \"Filtered\":\n          this.centreNodes();\n          break;\n        default:\n          console.log(`Unrecognised simulation type ${this.props.simulationType}`);\n          break;\n      }\n    }\n  }\n\n  gravitySimulation() {\n    if (this._simulation) {\n      this._simulation.stop();\n      this._simulation = null;\n      this._is_running = false;\n    }\n\n    let w = this.state.width;\n    let h = this.state.height;\n\n    let graph = this._graph;\n\n    // We don't want a force applied to null edges\n    let edges = graph.edges.filter((v) => v[\"type\"]);\n\n    // Node layout\n    const maxWeight = d3.max(graph.nodes, (d) => {\n      return d[\"weight\"][this.props.selectedShipID];\n    });\n\n    let strengthScale = d3.scalePow().exponent(5).range([0, 1]).domain([0, maxWeight]);\n    let radiusScale = d3.scaleLinear().domain([0, maxWeight]).range([1, 80]);\n\n    let simulation = d3\n      .forceSimulation(this._graph.nodes)\n      .alpha(1.0)\n      .alphaTarget(0)\n      .alphaDecay(0.01)\n      .force(\n        \"X\",\n        d3\n        .forceX()\n        .strength((d) => {\n          return strengthScale(d[\"weight\"][this.props.selectedShipID]);\n        })\n        .x(w / 2)\n      )\n      .force(\n        \"Y\",\n        d3\n        .forceY()\n        .strength((d) => {\n          return strengthScale(d[\"weight\"][this.props.selectedShipID]);\n        })\n        .y(h / 2)\n      )\n      .force(\n        \"charge\",\n        d3.forceManyBody().strength((d) => 2 * radiusScale(d[\"weight\"][this.props.selectedShipID]))\n      )\n      .force(\n        \"collide\",\n        d3\n        .forceCollide()\n        .strength(1)\n        .radius((d) => radiusScale(d[\"weight\"][this.props.selectedShipID]))\n        .iterations(30)\n      )\n      .force(\"link\", d3.forceLink().strength(0).links(edges).iterations(80))\n      // This function with help from https://stackoverflow.com/a/13456081\n      .on(\"tick\", () => {\n\n        this._link.attr(\"d\", (d) => {\n          if (d.target.x === undefined || d.source.x === undefined) {\n            return null;\n          }\n          // The smaller the curve factor the greater the curve\n          const curveFactor = 2;\n          const dx = d.target.x - d.source.x;\n          const dy = d.target.y - d.source.x;\n          const dr = curveFactor * Math.sqrt(dx * dx + dy * dy);\n\n          return \"M\" + d.source.x + \",\" + d.source.y + \"A\" + dr + \",\" + dr + \" 0 0,1 \" + d.target.x + \",\" + d.target.y;\n        });\n\n        this._node\n          .attr(\"cx\", (d) => {\n            return (d.x = constrain(d.x, w, d.r));\n          })\n          .attr(\"cy\", (d) => {\n            return (d.y = constrain(d.y, h, d.r));\n          });\n\n        this._label\n          .attr(\"x\", (d) => {\n            if (this.getLabelXOffset(d)) return this.getLabelXOffset(d);\n          })\n          .attr(\"y\", (d) => d.y);\n      })\n      .on(\"end\", () => {\n        this.restartSimulation();\n      });\n\n    this._is_running = true;\n\n    // Save the simulation so that we can update it later...\n    this._simulation = simulation;\n  }\n\n  spiralSimulation() {\n    if (this._simulation) {\n      this._simulation.stop();\n      this._simulation = null;\n      this._is_running = false;\n    }\n\n    let w = this.state.width;\n    let h = this.state.height;\n\n    let graph = this._graph;\n\n    // We don't want a force applied to null edges\n    let edges = graph.edges.filter((v) => v[\"type\"]);\n\n    // Node layout\n    const maxWeight = d3.max(graph.nodes, (d) => {\n      return d[\"weight\"][this.props.selectedShipID];\n    });\n\n    let radiusScale = d3.scaleLinear().domain([0, maxWeight]).range([1, 80]);\n\n    let simulation = d3\n      .forceSimulation(graph.nodes)\n      .alpha(1.0)\n      .alphaTarget(0)\n      .alphaDecay(0.01)\n      .force(\"spiral\",\n        force_spiral(w, h)\n        .strength(0.3)\n        .index((d) => {\n          return d.sort_index;\n        })\n      )\n      .force(\n        \"collide\",\n        d3\n        .forceCollide()\n        .strength(0.1)\n        .radius((d) => radiusScale(d[\"weight\"][this.props.selectedShipID]))\n        .iterations(30)\n      )\n      .force(\"link\", d3.forceLink().strength(0).links(edges).iterations(80))\n      // This function with help from https://stackoverflow.com/a/13456081\n      .on(\"tick\", () => {\n\n        this._link.attr(\"d\", (d) => {\n          if (d.target.x === undefined || d.source.x === undefined) {\n            return null;\n          }\n\n          // The smaller the curve factor the greater the curve\n          const curveFactor = 2;\n          const dx = d.target.x - d.source.x;\n          const dy = d.target.y - d.source.x;\n          const dr = curveFactor * Math.sqrt(dx * dx + dy * dy);\n\n          return `M${d.source.x},${d.source.y}A${dr},${dr} 0 0,1 ${d.target.x},${d.target.y}`;\n        });\n\n        this._node\n          .attr(\"cx\", (d) => {\n            return (d.x = constrain(d.x, w, d.r));\n          })\n          .attr(\"cy\", (d) => {\n            return (d.y = constrain(d.y, h, d.r));\n          });\n\n        this._label\n          .attr(\"x\", (d) => {\n            if (this.getLabelXOffset(d)) return this.getLabelXOffset(d);\n          })\n          .attr(\"y\", (d) => d.y);\n      })\n      .on(\"end\", () => {\n        this.restartSimulation();\n      });\n\n    this._is_running = true;\n\n    // Save the simulation so that we can update it later...\n    this._simulation = simulation;\n  }\n\n  structuredSimulation() {\n    if (this._simulation) {\n      this._simulation.stop();\n      this._simulation = null;\n      this._is_running = false;\n    }\n\n    let w = this.state.width;\n    let h = this.state.height;\n\n    let graph = this._graph;\n    // We don't want a force applied to null edges\n    let edges = graph.edges.filter((v) => v[\"type\"]);\n\n    let simulation = d3\n      .forceSimulation(graph.nodes)\n      .force(\"charge\", d3.forceManyBody().strength(-40).distanceMin(4))\n      .force(\n        \"link\",\n        d3\n        .forceLink()\n        .links(edges)\n        .distance((d) => {\n          if (d[\"type\"] === \"direct\") {\n            return 75 * (1 + d.value);\n          } else {\n            return 125 * (1 + d.value);\n          }\n        })\n        .iterations(5)\n      )\n      .force(\n        \"collision\",\n        d3\n        .forceCollide()\n        .radius((d) => {\n          return 3 * (1 + 10 * d.size);\n        })\n        .strength(10.0)\n        .iterations(5)\n      )\n      // This forces the groupings given in position_groups.json left/right\n      .force(\n        \"X\",\n        d3.forceX().strength((d) => {\n          return this.getGroupForce(d);\n        })\n      )\n      // This function with help from https://stackoverflow.com/a/13456081\n      .on(\"tick\", () => {\n\n        this._link.attr(\"d\", (d) => {\n          if (d.target.x === undefined || d.source.x === undefined) {\n            return null;\n          }\n          const curveFactor = 3;\n          const dx = d.target.x - d.source.x;\n          const dy = d.target.y - d.source.x;\n          const dr = curveFactor * Math.sqrt(dx * dx + dy * dy);\n\n          return `M${d.source.x},${d.source.y}A${dr},${dr} 0 0,1 ${d.target.x},${d.target.y}`;\n        });\n\n        this._node\n          .attr(\"cx\", (d) => {\n            return (d.x = constrain(d.x, w, d.r));\n          })\n          .attr(\"cy\", (d) => {\n            return (d.y = constrain(d.y, h, d.r));\n          });\n\n        this._label.attr(\"x\", (d) => this.getLabelXOffset(d)).attr(\"y\", (d) => d.y);\n      })\n      .on(\"end\", () => {\n        this.restartSimulation();\n      });\n\n    this._is_running = true;\n\n    // Save the simulation so that we can update it later...\n    this._simulation = simulation;\n  }\n\n  centreNodes() {\n    if (this._simulation) {\n      this._simulation.stop();\n      this._simulation = null;\n      this._is_running = false;\n    }\n    let w = this.state.width;\n    let h = this.state.height;\n\n    let simulation = d3\n      .forceSimulation(this._graph.nodes)\n      .alpha(0.4)\n      .alphaTarget(0)\n      .alphaDecay(0.05)\n      .force(\n        \"link\",\n        d3\n        .forceLink()\n        .links(this._graph.edges)\n        .distance((d) => {\n          return 75 * (1 + d.value);\n        })\n        .iterations(5)\n      )\n      .force(\n        \"collision\",\n        d3\n        .forceCollide()\n        .radius((d) => {\n          return 3 * (1 + d.size);\n        })\n        .strength(1.0)\n        .iterations(5)\n      )\n      .force(\"charge\", d3.forceManyBody().strength(-10).distanceMin(10).distanceMax(25))\n      .force(\n        \"X\",\n        d3\n        .forceX()\n        .strength(0.5)\n        .x(w / 2)\n      )\n      .force(\n        \"Y\",\n        d3\n        .forceY()\n        .strength(0.5)\n        .y(h / 2)\n      )\n      .on(\"tick\", () => {\n        this._link.attr(\"d\", (d) => {\n          const curveFactor = 3;\n          const dx = d.target.x - d.source.x;\n          const dy = d.target.y - d.source.x;\n          const dr = curveFactor * Math.sqrt(dx * dx + dy * dy);\n\n          return `M${d.source.x},${d.source.y}A${dr},${dr} 0 0,1 ${d.target.x},${d.target.y}`;\n        });\n        this._node\n          .attr(\"cx\", (d) => {\n            return (d.x = constrain(d.x, w, d.r));\n          })\n          .attr(\"cy\", (d) => {\n            return (d.y = constrain(d.y, h, d.r));\n          });\n        this._label\n          .attr(\"x\", (d) => {\n            return this.getLabelXOffset(d);\n          })\n          .attr(\"y\", (d) => d.y);\n      })\n      .on(\"end\", () => {\n        this.restartSimulation();\n      });\n\n    this._is_running = true;\n\n    // Save the simulation so that we can update it later...\n    this._simulation = simulation;\n\n    // this.updateGraph(this.state.social);\n  }\n\n  getTextWidth(text, font) {\n    // https://stackoverflow.com/a/21015393\n    // If given, use cached canvas for better performance\n    // else, create new canvas\n    let canvas = this.getTextWidth.canvas || (this.getTextWidth.canvas = document.createElement(\"canvas\"));\n    let context = canvas.getContext(\"2d\");\n    context.font = font;\n    let metrics = context.measureText(text);\n    return metrics.width;\n  }\n\n  getLabelXOffset(d) {\n    const swapSection = 0.2 * window.innerWidth;\n    const radius = this.getWeight(d);\n    const textWidth = this.getTextWidth(d[\"label\"], \"Playfair Display SemiBold\");\n\n    if (d.x > window.innerWidth - swapSection) {\n      const maxOffset = 0.2 * window.innerWidth;\n      return d.x - Math.min(radius + 1.5 * textWidth, maxOffset);\n    } else {\n      return d.x;\n    }\n  }\n\n  slowPhysics() {\n    if (this._simulation && this.state.physicsEnabled === true) {\n      this.state.physicsEnabled = false;\n      this._simulation.alpha(0.1).alphaTarget(0).alphaDecay(0.05).velocityDecay(0.8).restart();\n    }\n  }\n\n  fastPhysics() {\n    if (this._simulation && this.state.physicsEnabled === false) {\n      this.state.physicsEnabled = true;\n      this._simulation.alpha(1).alphaTarget(0.5).alphaMin(0.2).alphaDecay(0.001).restart();\n    }\n  }\n\n  restartSimulation() {\n    if (this._simulation) {\n      this._simulation.restart();\n      this._is_running = true;\n    }\n  }\n\n  stopSimulation() {\n    this._simulation.stop();\n    this._is_running = false;\n  }\n\n  isRunning() {\n    return this._is_running;\n  }\n\n  updateLinks(indirectConnectionsVisible) {\n    if (this._graph.edges) {\n      this.setState({\n        indirectConnectionsVisible: indirectConnectionsVisible,\n      });\n      this.updateLink(this._graph.edges);\n    }\n  }\n\n  drawFromScratch() {\n    let graph = this._graph;\n\n    if (!graph) {\n      if (this.state.social) {\n        this.updateGraph(this.state.social);\n      }\n\n      graph = this._graph;\n      if (!graph) {\n        console.log(\"Nothing to draw...\");\n        return;\n      }\n    }\n\n    d3.select(`.${this.className()} > *`).remove();\n\n    let container = d3.select(`.${this.className()}`);\n\n    if (!container) {\n      console.log(`Cannot find container element class ${this.className()}`);\n      return;\n    }\n\n    const width = this.state.width;\n    const height = this.state.height;\n\n    if (!width || !height) {\n      console.log(`Invalid width or height? ${width} x ${height}`);\n      return;\n    }\n\n    let svg = container\n      .append(\"svg\")\n      .attr(\"height\", height)\n      .attr(\"width\", width)\n      .attr(\"id\", \"svg-viz\")\n      .attr(\"align\", \"center\")\n      .on(\"click\", () => {\n        this.state.signalClicked(null);\n      });\n\n    let mainGroup = svg;\n    this._mainGroup = mainGroup;\n\n    this.spiralSimulation();\n\n    mainGroup.append(\"g\").attr(\"class\", \"link-group\");\n    mainGroup.append(\"g\").attr(\"class\", \"node-group\");\n    mainGroup.append(\"g\").attr(\"class\", \"node_text-group\");\n\n    this._link = this.updateLink(graph.edges);\n    this._node = this.updateNode(graph.nodes);\n    this._label = this.updateNodeText(graph.nodes);\n\n    this._is_drawn = true;\n  }\n\n  draw() {\n    if (!this._is_drawn) {\n      this.drawFromScratch();\n      this._size_changed = false;\n      this._graph_changed = false;\n      return;\n    }\n\n    let update_simulation = false;\n\n    if (this._size_changed) {\n      let container = d3.select(`.${this.className()}`);\n      container.selectAll(\"svg\").attr(\"width\", this.state.width).attr(\"height\", this.state.height);\n      this._size_changed = false;\n      update_simulation = true;\n      this._label = this.updateNodeText(this._graph.nodes);\n    }\n\n    if (this._graph_changed) {\n      this._node = this.updateNode(this._graph.nodes);\n      this._label = this.updateNodeText(this._graph.nodes);\n      this._link = this.updateLink(this._graph.edges);\n      this._graph_changed = false;\n      update_simulation = true;\n    }\n\n    if (update_simulation) {\n      this.changeSimulationType();\n    }\n  }\n}\n\nForceGraphD3.propTypes = {\n  emitPopProps: PropTypes.func.isRequired,\n  physicsEnabled: PropTypes.bool.isRequired,\n  standardSimulation: PropTypes.bool.isRequired,\n  simulationType: PropTypes.string.isRequired,\n  selectedShipID: PropTypes.string,\n};\n\nexport default ForceGraphD3;","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport Popover from \"./Popover\";\nimport ForceGraphD3 from \"./d3/ForceGraph.d3.js\";\n\nimport lodash from \"lodash\";\n\nclass ForceGraph extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      popoversVisible: false,\n      popups: {},\n    };\n\n    this.updateSize = this.updateSize.bind(this);\n    this.emitPopProps = this.emitPopProps.bind(this);\n    this.clearPopups = this.clearPopups.bind(this);\n    this.componentDidUpdate = this.componentDidUpdate.bind(this);\n\n    this.graph = new ForceGraphD3(props);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.updateSize);\n    this.updateSize();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.updateSize);\n  }\n\n  componentDidUpdate() {\n    // TODO - look up better way of doing this\n    // This feels very clunky\n    let localProps = lodash.cloneDeep(this.props);\n    localProps[\"emitPopProps\"] = this.emitPopProps;\n    this.graph.props = localProps;\n    this.graph.update(this.props);\n    this.graph.draw();\n  }\n\n  updateSize() {\n    if (this.container && this.graph) {\n      this.graph.update({\n        width: this.container.offsetWidth,\n        height: this.container.offsetHeight,\n      });\n      this.graph.draw();\n    }\n  }\n\n  // Used for multiple popups\n  updatePopupState(id, node) {\n    this.setState((prevState) => {\n      let popups = Object.assign({}, prevState.popups);\n      popups[id] = node;\n      return { popups: popups };\n    });\n  }\n\n  emitPopProps(node) {\n    // this.clearPopups();\n    this.setState({ popups: { id: node } });\n\n    // Keep code for multiple popups\n    // if (this.state.popups[id]) {\n    //   this.updatePopupState(id, false);\n    // } else {\n    //   this.updatePopupState(id, node);\n    // }\n  }\n\n  clearPopups() {\n    this.setState({ popups: {} });\n  }\n\n  render() {\n    let s = this.graph.className();\n\n    let popups = [];\n\n    for (let [id, node] of Object.entries(this.state.popups)) {\n      if (node !== false) {\n        let p = (\n          <Popover\n            key={id}\n            togglePopover={this.emitPopProps}\n            node={node}\n            social={this.props.social}\n            selectedShipID={this.props.selectedShipID}\n            clearPopups={this.clearPopups}\n          />\n        );\n        popups.push(p);\n      }\n    }\n\n    if (!this.props.physicsEnabled) {\n      this.graph.slowPhysics();\n    } else {\n      this.graph.fastPhysics();\n    }\n\n    return (\n      <div ref={(el) => (this.container = el)} style={{ width: \"100%\", height: \"100%\" }}>\n        <div id={s} className={s}>\n          {popups}\n        </div>\n      </div>\n    );\n  }\n}\n\nForceGraph.propTypes = {\n  social: PropTypes.object.isRequired,\n  selectedShipID: PropTypes.string,\n  indirectConnectionsVisible: PropTypes.bool.isRequired,\n  physicsEnabled: PropTypes.bool.isRequired,\n  simulationType: PropTypes.string.isRequired,\n};\n\nexport default ForceGraph;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport styles from \"./HowDoIOverlay.module.css\";\n\nimport howDoIText from \"../data/howDoIOverlayText.json\";\n\nclass HowDoIOverlay extends React.Component {\n  render() {\n    return (\n      <div className={styles.container}>\n        <div className={styles.closeButton}>\n          <button onClick={this.props.close} style={{ background: \"none\", border: \"none\", fontSize: \"2.4vh\" }}>\n            x\n          </button>\n        </div>\n        <div className={styles.textContainer}>\n          <div className={styles.header}>How do I navigate Brunel&apos;s Network?</div>\n          <div className={styles.intro}>\n            <p>{howDoIText[\"intro\"]}</p>\n          </div>\n          <div className={styles.body}>\n            <p>{howDoIText[\"paraOne\"]}</p>\n            <br />\n            <p>{howDoIText[\"paraTwo\"]}</p>\n            <br />\n            <p>{howDoIText[\"paraThree\"]}</p>\n            <br />\n            <p>{howDoIText[\"paraFour\"]}</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nHowDoIOverlay.propTypes = {\n  close: PropTypes.func.isRequired,\n};\n\nexport default HowDoIOverlay;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport moment from \"moment\";\n\nimport Timeline, { TimelineHeaders, CustomHeader } from \"react-calendar-timeline\";\n\nimport \"./TimelineCSSOverride.css\";\n\nclass NewTimeline extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.setFilter = this.setFilter.bind(this);\n    this.itemRenderer = this.itemRenderer.bind(this);\n\n    this.state = {\n      defaultTimeStart: moment(\"1829-01-01\"),\n      defaultTimeEnd: moment(\"1846-12-31\"),\n      lastShip: null,\n    };\n\n    this.textStyle = {\n      overflow: \"hidden\",\n      paddingLeft: 3,\n      textOverflow: \"ellipsis\",\n      whiteSpace: \"nowrap\",\n    };\n\n    this.dateHeaderStyle = {\n      color: \"black\",\n      fontSize: \"16px\",\n      backgroundColor: \"#E8CEAA\",\n      //   backgroundColor: \"#E3D8A0\",\n      fontFamily: \"Playfair Display SC\",\n      border: \"white\",\n    };\n  }\n\n  setFilter(id, shipName) {\n    if (shipName === this.state.lastShip) {\n      this.props.resetFilters();\n      // Allows the ship to be selected again\n      this.setState({ lastShip: \"\" });\n      return;\n    }\n\n    this.setState({ lastShip: shipName });\n    this.props.onClick(id, shipName);\n  }\n\n  openOverview() {\n    return;\n  }\n\n  itemRenderer({ item, itemContext, getItemProps }) {\n    const background = itemContext.selected ? \"#3F592F\" : \"#003366\";\n    const border = itemContext.resizing ? \"#3F592F\" : \"#003366\";\n\n    return (\n      <div\n        {...getItemProps({\n          style: {\n            background,\n            border,\n            borderStyle: \"solid\",\n            fontSize: \"18px\",\n            fontFamily: \"Playfair Display SC\",\n            borderWidth: 0,\n          },\n          onMouseDown: () => {\n            this.setFilter(item[\"project_id\"], item[\"title\"]);\n          },\n        })}\n      >\n        <div style={this.textStyle}>{itemContext.title}</div>\n      </div>\n    );\n  }\n\n  render() {\n    const projects = this.props.projects;\n\n    const timeline_items = projects.values().map((project, index) => {\n      let item = project.getNewTimeLine();\n\n      item[\"id\"] = index;\n      item[\"group\"] = 1;\n\n      return item;\n    });\n\n    const groups = [{ id: 1, title: \"Projects\" }];\n\n    return (\n      <Timeline\n        groups={groups}\n        items={timeline_items}\n        sidebarWidth={0}\n        itemTouchSendsClick={true}\n        stackItems\n        lineHeight={60}\n        itemHeightRatio={0.8}\n        showCursorLine\n        canMove={false}\n        canResize={false}\n        traditionalZoom={true}\n        timeSteps={{ year: 1 }}\n        itemRenderer={this.itemRenderer}\n        defaultTimeStart={this.state.defaultTimeStart}\n        defaultTimeEnd={this.state.defaultTimeEnd}\n      >\n        <TimelineHeaders>\n          {/* <DateHeader unit=\"primaryHeader\" style={this.dateHeaderStyle} /> */}\n          <CustomHeader height={30} unit=\"year\">\n            {({ headerContext: { intervals }, getRootProps, getIntervalProps }) => {\n              return (\n                <div {...getRootProps()}>\n                  {intervals.map((interval, index) => {\n                    const intervalStyle = {\n                      lineHeight: \"30px\",\n                      textAlign: \"center\",\n                      borderLeft: \"1px solid white\",\n                      cursor: \"pointer\",\n                      backgroundColor: \"#E9CEAB\",\n                      color: \"black\",\n                      fontFamily: \"Playfair Display SC\",\n                    };\n                    return (\n                      <div\n                        key={index}\n                        {...getIntervalProps({\n                          interval,\n                          style: intervalStyle,\n                        })}\n                      >\n                        <div className=\"sticky\">{interval.startTime.format(\"YYYY\")}</div>\n                      </div>\n                    );\n                  })}\n                </div>\n              );\n            }}\n          </CustomHeader>\n        </TimelineHeaders>\n      </Timeline>\n    );\n  }\n}\n\nNewTimeline.propTypes = {\n  projects: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n};\n\nexport default NewTimeline;\n","import PropTypes from \"prop-types\";\nimport React, { Component } from \"react\";\nimport { Tabs, Tab, TabPanel, TabList } from \"react-web-tabs\";\n\nimport NewTimeline from \"./NewTimeline\";\n\nimport styles from \"./TimeLineBox.module.css\";\n\nclass TimeLineBox extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dimensions: { height: 300, width: 600 },\n    };\n\n    this.tabs = {};\n    this.container = null;\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", () => {\n      this.updateSize();\n    });\n    this.updateSize();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", () => {\n      this.updateSize();\n    });\n  }\n\n  activate(tabId) {\n    Object.keys(this.tabs).forEach((key) => {\n      if (key !== tabId) {\n        let tab = this.tabs[key];\n        if (tab) {\n          tab.deactivate();\n        }\n      }\n    });\n\n    if (this.tabs[tabId]) {\n      this.tabs[tabId].activate();\n    }\n  }\n\n  updateSize() {\n    if (this.container) {\n      this.setState({\n        dimensions: {\n          width: this.container.offsetWidth,\n          height: this.container.offsetHeight,\n        },\n      });\n    }\n\n    Object.keys(this.tabs).forEach((key) => {\n      let tab = this.tabs[key];\n      if (tab) {\n        tab.updateSize(this.state.dimensions);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div ref={(el) => (this.container = el)} className={styles.container}>\n        <Tabs\n          key=\"timeline-tabs\"\n          onChange={(tabId) => {\n            this.activate(tabId);\n            this.updateSize();\n          }}\n          className={styles.tabs}\n        >\n          <TabList className={styles.tabList}>\n            <Tab className={styles.tab} key=\"items\" tabFor=\"items\">\n              Timeline\n            </Tab>\n            {/* <Tab className={styles.tab} key=\"projects\" tabFor=\"projects\">\n              Projects\n            </Tab> */}\n            <Tab className={styles.tab} key=\"analysis\" tabFor=\"analysis\">\n              Analysis\n            </Tab>\n          </TabList>\n\n          <TabPanel key=\"items\" tabId=\"items\" className={styles.tabPanel}>\n            <NewTimeline\n              projects={this.props.projects}\n              onClick={this.props.shipSelect}\n              resetFilters={this.props.resetFilters}\n            />\n          </TabPanel>\n\n          {/* <TabPanel key=\"projects\" tabId=\"projects\" className={styles.tabPanel}>\n            <NewTimeline\n              projects={this.props.projects}\n              onClick={this.props.shipSelect}\n              resetFilters={this.props.resetFilters}\n            />\n          </TabPanel> */}\n\n          <TabPanel key=\"analysis\" tabId=\"analysis\" className={styles.tabPanel}>\n            <div className={styles.centerContainer}>\n              <p>This will contain tools and graphs for temporal social network analysis.</p>\n            </div>\n          </TabPanel>\n        </Tabs>\n      </div>\n    );\n  }\n}\n\nTimeLineBox.propTypes = {\n  projects: PropTypes.object.isRequired,\n  shipSelect: PropTypes.func.isRequired,\n  resetFilters: PropTypes.func.isRequired,\n  //   emitClicked: PropTypes.func.isRequired,\n  //   emitSelected: PropTypes.func.isRequired,\n  //   emitWindowChanged: PropTypes.func.isRequired,\n  //   getItemTimeLine: PropTypes.func.isRequired,\n  //   getItemWindow: PropTypes.func.isRequired,\n  //   getMaxWindow: PropTypes.func.isRequired,\n  //   getProjectTimeLine: PropTypes.func.isRequired,\n  //   getProjectWindow: PropTypes.func.isRequired,\n  //   selected: PropTypes.func,\n};\n\nexport default TimeLineBox;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport {\n  Accordion,\n  AccordionItem,\n  AccordionItemHeading,\n  AccordionItemButton,\n  AccordionItemPanel,\n} from \"react-accessible-accordion\";\n\nimport styles from \"./Accordion.module.css\";\n\nfunction BAccordion(props) {\n  return (\n    <Accordion\n      className={styles.accordion}\n      preExpanded={props.preExpanded}\n      allowMultipleExpanded={props.allowMultipleExpanded}\n      allowZeroExpanded={props.allowZeroExpanded}\n    >\n      {props.children}\n    </Accordion>\n  );\n}\n\nBAccordion.propTypes = {\n  preExpanded: PropTypes.bool,\n  allowMultipleExpanded: PropTypes.bool,\n  allowZeroExpanded: PropTypes.bool,\n  children: PropTypes.string,\n};\n\nfunction BAccordionItem(props) {\n  return (\n    <AccordionItem className={styles.accordionItem} style={props.style} uuid={props.uuid}>\n      {props.children}\n    </AccordionItem>\n  );\n}\n\nBAccordionItem.propTypes = {\n  style: PropTypes.string,\n  uuid: PropTypes.string,\n  children: PropTypes.string,\n};\n\nfunction BAccordionTitle(props) {\n  return (\n    <AccordionItemHeading style={props.style}>\n      <AccordionItemButton className={styles.accordionButton}>{props.children}</AccordionItemButton>\n    </AccordionItemHeading>\n  );\n}\n\nBAccordionTitle.propTypes = {\n  style: PropTypes.string,\n  children: PropTypes.string,\n};\n\nfunction BAccordionPanel(props) {\n  return <AccordionItemPanel style={props.style}>{props.children}</AccordionItemPanel>;\n}\n\nBAccordionPanel.propTypes = {\n  style: PropTypes.string,\n  children: PropTypes.string,\n};\n\nexport {\n  BAccordion as Accordion,\n  BAccordionItem as AccordionItem,\n  BAccordionTitle as AccordionTitle,\n  BAccordionPanel as AccordionPanel,\n  BAccordion as default,\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"./ResponsiveList.module.css\";\n\nfunction ResponsiveList(props) {\n  return <div className={styles.list}>{props.children}</div>;\n}\n\nResponsiveList.propTypes = {\n  children: PropTypes.elementType.isRequired,\n};\n\nfunction ResponsiveListItem(props) {\n  return (\n    <div className={styles.item} key={props.key}>\n      {props.children}\n    </div>\n  );\n}\n\nResponsiveListItem.propTypes = {\n  key: PropTypes.string.isRequired,\n  children: PropTypes.elementType.isRequired,\n};\n\nexport { ResponsiveListItem, ResponsiveList, ResponsiveList as default };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./CheckBox.module.css\";\n\nfunction CheckBox(props) {\n  return (\n    <label className={styles.checkBox} style={props.style}>\n      <input data-testid=\"checkbox\" type=\"checkbox\" checked={props.checked} onChange={props.onChange} />\n      <span className={styles.checkMark} />\n    </label>\n  );\n}\n\nCheckBox.propTypes = {\n  style: PropTypes.string,\n  checked: PropTypes.bool,\n  onChange: PropTypes.func,\n};\n\nexport default CheckBox;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./DefaultButton.module.css\";\n\nfunction DefaultButton(props) {\n  return (\n    <button href=\"#\" className={styles.button} onClick={props.onClick} style={props.style}>\n      {props.children}\n    </button>\n  );\n}\n\nDefaultButton.propTypes = {\n  onClick: PropTypes.func,\n  style: PropTypes.object,\n  children: PropTypes.string,\n};\n\nexport default DefaultButton;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Accordion, AccordionItem, AccordionTitle, AccordionPanel } from \"./Accordion\";\n\nimport { ResponsiveList, ResponsiveListItem } from \"./ResponsiveList\";\nimport CheckBox from \"./CheckBox\";\nimport DefaultButton from \"./DefaultButton\";\n\nimport styles from \"./FilterBox.module.css\";\n\nfunction null_function() {}\n\nfunction filterList(items, props) {\n  let social = props.social;\n\n  let emitSelected = props.emitSelected;\n\n  if (!emitSelected) {\n    emitSelected = null_function;\n  }\n\n  let emitToggleFilter = props.emitToggleFilter;\n\n  if (!emitToggleFilter) {\n    emitToggleFilter = null_function;\n  }\n\n  let output = items.values().map((item) => {\n    let is_filtered = social.isFiltered(item);\n\n    return (\n      <ResponsiveListItem key={item.getName()}>\n        <DefaultButton\n          style={{ position: \"relative\", maxWidth: \"80%\" }}\n          onClick={() => {\n            emitSelected(item);\n          }}\n        >\n          {item.getName()}\n        </DefaultButton>\n        &nbsp;\n        <CheckBox\n          checked={is_filtered}\n          onChange={() => {\n            emitToggleFilter(item);\n          }}\n        />\n      </ResponsiveListItem>\n    );\n  });\n\n  return <ResponsiveList>{output}</ResponsiveList>;\n}\n\nfilterList.propTypes = {\n  social: PropTypes.object.isRequired,\n  emitSelected: PropTypes.func,\n  emitToggleFilter: PropTypes.func,\n};\n\nfunction FilterBox(props) {\n  let social = props.social;\n\n  if (!social) {\n    return <div>No social to display!</div>;\n  }\n\n  let filter_text = social.getFilterText();\n\n  if (!filter_text) {\n    filter_text = \"No filters\";\n  }\n\n  let emitClearFilters = props.emitClearFilters;\n\n  if (!emitClearFilters) {\n    emitClearFilters = null_function;\n  }\n\n  let filter_info = (\n    <AccordionItem uuid=\"filterinfo\">\n      <AccordionTitle>Current Filter</AccordionTitle>\n      <AccordionPanel>\n        <div className={styles.filterContainer}>\n          <div className={styles.filterText}>{filter_text}</div>\n          <div>\n            <DefaultButton onClick={emitClearFilters}>Clear Filters</DefaultButton>\n          </div>\n        </div>\n      </AccordionPanel>\n    </AccordionItem>\n  );\n\n  let projects = filterList(social.getProjects(false), props);\n  let sources = filterList(social.getSources(false), props);\n  let positions = filterList(social.getPositions(false), props);\n  let affiliations = filterList(social.getAffiliations(false), props);\n  let people = filterList(social.getPeople(false), props);\n  let businesses = filterList(social.getBusinesses(false), props);\n\n  return (\n    <Accordion allowMultipleExpanded={false} allowZeroExpanded={true}>\n      {filter_info}\n\n      <AccordionItem uuid=\"projects\">\n        <AccordionTitle>Projects</AccordionTitle>\n        <AccordionPanel>{projects}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"sources\">\n        <AccordionTitle>Sources</AccordionTitle>\n        <AccordionPanel>{sources}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"people\">\n        <AccordionTitle>People</AccordionTitle>\n        <AccordionPanel>{people}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"businesses\">\n        <AccordionTitle>Businesses</AccordionTitle>\n        <AccordionPanel>{businesses}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"positions\">\n        <AccordionTitle>Positions</AccordionTitle>\n        <AccordionPanel>{positions}</AccordionPanel>\n      </AccordionItem>\n\n      <AccordionItem uuid=\"affiliations\">\n        <AccordionTitle>Affiliations</AccordionTitle>\n        <AccordionPanel>{affiliations}</AccordionPanel>\n      </AccordionItem>\n    </Accordion>\n  );\n}\n\nFilterBox.propTypes = {\n  social: PropTypes.object.isRequired,\n  emitSelected: PropTypes.func,\n  emitClearFilters: PropTypes.func,\n};\n\nexport default FilterBox;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\n\nimport styles from \"./SlidingPanel.module.css\";\nimport SlideFromLeft from \"./transitions/SlideFromLeft.module.css\";\nimport SlideFromRight from \"./transitions/SlideFromRight.module.css\";\nimport SlideFromBottom from \"./transitions/SlideFromBottom.module.css\";\nimport SlideFromTop from \"./transitions/SlideFromTop.module.css\";\n\nclass SlidingPanel extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isOpen: false,\n      position: \"right\",\n      defaultSize: \"40%\",\n      minSize: \"300px\",\n      maxSize: null,\n    };\n  }\n\n  render() {\n    let container = styles.rightContainer;\n    let transition = SlideFromRight;\n\n    let width = this.props.width;\n    let height = this.props.height;\n\n    if (height && !width) {\n      width = \"100%\";\n    }\n\n    if (width && !height) {\n      height = \"100%\";\n    }\n\n    let horiz_size = { width: width };\n    let vert_size = { height: height };\n\n    let style = { width: width, height: height, minSize: this.state.minSize };\n\n    if (this.props.maxSize) {\n      horiz_size.maxWidth = this.props.maxSize;\n      vert_size.maxHeight = this.props.maxSize;\n    }\n\n    // let style = horiz_size;\n    // Get the passed in position\n    let position = this.props.position;\n    if (!position) {\n      position = this.state.position;\n    }\n\n    if (position === \"right\") {\n      container = styles.rightContainer;\n      transition = SlideFromRight;\n    } else if (position === \"rightBottom\") {\n      container = styles.rightContainer;\n      transition = SlideFromBottom;\n    } else if (position === \"bottom\") {\n      container = styles.bottomContainer;\n      transition = SlideFromBottom;\n    } else if (position === \"top\") {\n      container = styles.topContainer;\n      transition = SlideFromTop;\n    } else if (position === \"left\") {\n      container = styles.leftContainer;\n      transition = SlideFromLeft;\n    }\n\n    container = `${container} ${styles.container}`;\n\n    return (\n      <CSSTransition in={this.props.isOpen} timeout={200} classNames={transition} unmountOnExit>\n        <div className={container} style={style}>\n          {this.props.children}\n        </div>\n      </CSSTransition>\n    );\n  }\n}\n\nSlidingPanel.propTypes = {\n  children: PropTypes.oneOfType([PropTypes.array, PropTypes.object]).isRequired,\n  isOpen: PropTypes.bool,\n  maxSize: PropTypes.string,\n  minSize: PropTypes.string,\n  position: PropTypes.string,\n  width: PropTypes.string,\n  height: PropTypes.string,\n};\n\nexport default SlidingPanel;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./ShipSelector.module.css\";\n\nclass ShipSelector extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const projects = this.props.projects;\n\n    // We want the graph to start with the GW selected\n    const ssGW = projects.getByName(\"SS Great Western\");\n    this.props.shipFilter(ssGW);\n\n    this.state = { lastShip: ssGW.getName() };\n  }\n\n  setFilter(item) {\n    const shipName = item.getName();\n\n    if (shipName === this.state.lastShip) {\n      return;\n    }\n\n    this.setState({ lastShip: shipName });\n    this.props.shipFilter(item);\n  }\n\n  render() {\n    let projects = this.props.projects;\n\n    let output = projects.values().map((item) => {\n      return (\n        <button href=\"#\" key={item.getName()} className={styles.button} onClick={() => this.setFilter(item)}>\n          {item.getName()}\n        </button>\n      );\n    });\n\n    return output;\n  }\n}\n\nShipSelector.propTypes = {\n  projects: PropTypes.object.isRequired,\n  shipFilter: PropTypes.func.isRequired,\n};\n\nexport default ShipSelector;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"./ShipTitle.module.css\";\n\nfunction ShipTitle(props) {\n  if (props.name == null) {\n    return null;\n  } else {\n    return (\n      <button data-testid=\"shipTitle\" className={styles.shipTitle}>\n        {props.name}\n      </button>\n    );\n  }\n}\n\nShipTitle.propTypes = {\n  shipTitle: PropTypes.string,\n  style: PropTypes.string,\n};\n\nexport default ShipTitle;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\nimport Spinner from \"react-spinkit\";\n\nimport TextButton from \"./TextButton\";\n\nimport styles from \"./SearchBar.module.css\";\n\n// This class is heavily inspired by react-search-field\n// from https://github.com/nutboltu/react-search-field\n\nfunction _null_function() {}\n\nfunction SearchResults(props) {\n  let results = props.results;\n\n  if (!results) {\n    return null;\n  }\n\n  let items = [];\n\n  results.forEach((item, index) => {\n    items.push(\n      <li data-testid={\"searchResult\" + index} key={\"searchResult\" + index}>\n        {item}\n      </li>\n    );\n  });\n\n  return <ul>{items}</ul>;\n}\n\nSearchResults.propTypes = {\n  results: PropTypes.any,\n};\n\nclass SearchBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      value: \"\",\n      suggestions: null,\n      searching: null,\n      results: null,\n    };\n  }\n\n  componentDidUpdate(nextProps) {\n    if (this.props.searchText !== nextProps.searchText) {\n      this.setState({\n        value: nextProps.searchText,\n      });\n    }\n  }\n\n  setResults(results) {\n    this.props.emitResults();\n    this.setState({ searching: null, suggestions: null, results: results });\n  }\n\n  setSuggestions(suggestions) {\n    this.props.emitResults();\n    this.setState({ searching: null, suggestions: suggestions, results: null });\n  }\n\n  createButton(item, index) {\n    const name = item.getName();\n    return (\n      <TextButton\n        key={name.concat(\"_\", index)}\n        textColor=\"#f1f1f1\"\n        hoverColor=\"#111\"\n        fontSize=\"2vh\"\n        onClick={() => {\n          this.props.emitSelected(item);\n        }}\n      >\n        {name}\n      </TextButton>\n    );\n  }\n\n  startSuggestion(text) {\n    let social = this.props.social;\n    if (!social) {\n      return;\n    }\n\n    let items = null;\n\n    try {\n      items = social.find(text);\n    } catch (error) {\n      items = null;\n    }\n\n    let emitSelected = this.props.emitSelected;\n\n    if (!emitSelected) {\n      emitSelected = _null_function;\n    }\n\n    if (items) {\n      let results = items.map((item, index) => {\n        return this.createButton(item, index);\n      });\n\n      this.setSuggestions(results);\n    } else {\n      this.setSuggestions(null);\n    }\n  }\n\n  startSearch(text) {\n    let social = this.props.social;\n\n    if (!social) {\n      this.setResults([<div key=\"noresults\">No results!</div>]);\n      return;\n    }\n\n    let items = null;\n\n    try {\n      items = social.find(text);\n    } catch (error) {\n      //   console.warn(error);\n      items = null;\n    }\n\n    let emitSelected = this.props.emitSelected;\n\n    if (!emitSelected) {\n      emitSelected = _null_function;\n    }\n\n    if (items) {\n      let results = items.map((item, index) => {\n        return this.createButton(item, index);\n      });\n\n      this.setResults(results);\n    } else {\n      this.setResults([<div key=\"rnoresults\">Really no results!</div>]);\n    }\n  }\n\n  searchFor(text) {\n    if (text && text.length > 0) {\n      this.setState({ searching: text, suggestions: null, results: null });\n\n      setTimeout(() => {\n        this.startSearch(text);\n      }, 10);\n    } else {\n      this.setState({ suggestions: null, searching: null, results: null });\n    }\n  }\n\n  autocomplete(text) {\n    if (text && text.length > 0) {\n      this.startSuggestion(text);\n    } else {\n      this.setState({ suggestions: null, searching: null, results: null });\n    }\n  }\n\n  isSearching() {\n    return this.state.searching !== null;\n  }\n\n  isSuggesting() {\n    return this.state.suggestions !== null;\n  }\n\n  hasResults() {\n    return this.state.results !== null;\n  }\n\n  stopSearch() {\n    this.setState({ searching: null, suggestions: null, results: null });\n  }\n\n  onChange(event) {\n    if (this.isSearching()) {\n      return;\n    }\n\n    this.setState({ value: event.target.value });\n    this.autocomplete(event.target.value);\n  }\n\n  onEnter(event) {\n    if (this.isSearching() || this.isEmpty()) {\n      return;\n    }\n\n    const enterKey = 13;\n    const isEnterPressed = event.which === enterKey || event.keyCode === enterKey;\n\n    if (isEnterPressed) {\n      this.searchFor(event.target.value);\n    }\n  }\n\n  onSearch() {\n    if (this.isSearching() || this.isEmpty()) {\n      return;\n    }\n\n    this.searchFor(this.state.value);\n  }\n\n  isEmpty() {\n    return !(this.state.value && this.state.value.length > 0);\n  }\n\n  isSearchingComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchPending}>\n            <div>Searching for &quot;{this.state.searching}&quot;...</div>\n            <div style={{ display: \"inline-block\" }}>\n              <Spinner name=\"ball-grid-pulse\" color=\"green\" fadeIn=\"none\" />\n            </div>\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.stopSearch();\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  isSuggestingComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchResult}>\n            <SearchResults results={this.state.suggestions} />\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.setState({ suggestions: null });\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  resultsComponent() {\n    return (\n      <div className={styles.searchContainer}>\n        <div className={styles.resultContainer}>\n          <div className={styles.searchResult}>\n            <SearchResults results={this.state.results} />\n          </div>\n          <div\n            className={styles.closeResultButton}\n            onClick={() => {\n              this.setState({ results: null });\n            }}\n          >\n            X\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <div className={styles.searchContainer}>\n          <input\n            data-testid=\"searchInput\"\n            className={styles.searchBox}\n            onChange={(event) => {\n              this.onChange(event);\n            }}\n            onKeyPress={(event) => {\n              this.onEnter(event);\n            }}\n            placeholder={this.props.placeholder}\n            type=\"text\"\n            value={this.state.value}\n          />\n        </div>\n        {this.isSearching() ? this.isSearchingComponent() : null}\n        {this.isSuggesting() ? this.isSuggestingComponent() : null}\n        {this.hasResults() ? this.resultsComponent() : null}\n      </div>\n    );\n  }\n}\n\nSearchBar.propTypes = {\n  emitSelected: PropTypes.func.isRequired,\n  emitResults: PropTypes.func.isRequired,\n  social: PropTypes.object.isRequired,\n  placeholder: PropTypes.string,\n  searchText: PropTypes.string,\n};\n\nexport default SearchBar;\n","import PropTypes from \"prop-types\";\nimport React from \"react\";\n\nimport SearchBar from \"./SearchBar\";\nimport Overlay from \"./Overlay\";\n\nimport styles from \"./SearchOverlay.module.css\";\nimport OverlayWrapper from \"./OverlayWrapper\";\n\nclass SearchOverlay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.emitResults = this.emitResults.bind(this);\n    this.state = {\n      isOverlayOpen: true,\n      isBioOverlayOpen: true,\n      isSourceOverlayOpen: false,\n      haveResults: false,\n      selectedEntity: null,\n    };\n\n    this.toggleSourceOverlay = this.toggleSourceOverlay.bind(this);\n    this.toggleBioOverlay = this.toggleBioOverlay.bind(this);\n    this.emitSelected = this.emitSelected.bind(this);\n\n    this.toggleOverlay = this.toggleOverlay.bind(this);\n  }\n\n  emitResults() {\n    this.setState({ haveResults: true });\n  }\n\n  emitSelected(item) {\n    this.setState({ selectedEntity: item });\n  }\n\n  toggleOverlay() {\n    this.setState({ isOverlayOpen: !this.state.isOverlayOpen });\n  }\n\n  toggleSourceOverlay() {\n    this.setState({ isOverlayOpen: true, isSourceOverlayOpen: true, isBioOverlayOpen: false });\n  }\n\n  toggleBioOverlay() {\n    this.setState({ isOverlayOpen: true, isSourceOverlayOpen: false, isBioOverlayOpen: true });\n  }\n\n  render() {\n    // let searchStyle = this.state.haveResults ? styles.resultsContainer : styles.smallContainer;\n\n    const placeholderText = \"Search...\";\n    const socialSources = this.props.social.getSources();\n\n    // TODO - rework these classes, code duplication with Popover.js here\n    const selectedShipID = this.props.selectedShipID;\n\n    let infoOverlay = null;\n\n    if (this.state.selectedEntity) {\n      const entity = this.state.selectedEntity;\n\n      console.log(`Selected ${entity}`);\n      console.log(entity);\n\n      // If we can't find it in the selected ship then get the sources for the other ship\n      let sourceIDs = null;\n\n      if (entity.getSources){\n        sourceIDs = entity.getSources()[selectedShipID];\n      }\n\n      let buttonStrings = [];\n      let sourceButtonText = \"\";\n\n      if (!sourceIDs) {\n        console.error(\"Cannot find sources for this project : \", selectedShipID, \"\\n Sources : \", socialSources);\n      } else {\n        for (const id of sourceIDs) {\n          buttonStrings.push(socialSources.get(id).getName());\n        }\n      }\n      sourceButtonText = buttonStrings.join(\", \");\n\n      infoOverlay = (\n        <OverlayWrapper\n          entity={entity}\n          isBioOverlayOpen={this.state.isBioOverlayOpen}\n          isOverlayOpen={this.state.isOverlayOpen}\n          isSourceOverlayOpen={this.state.isSourceOverlayOpen}\n          social={this.props.social}\n          sourceButtonText={sourceButtonText}\n          sourceIDs={sourceIDs}\n          toggleBioOverlay={this.toggleBioOverlay}\n          toggleOverlay={this.toggleOverlay}\n          toggleSourceOverlay={this.toggleSourceOverlay}\n        />\n      );\n    }\n\n    return (\n      <Overlay toggleOverlay={this.props.toggleSearchOverlay}>\n        <div className={styles.container}>\n          <div className={styles.smallContainer}>\n            <SearchBar\n              social={this.props.social}\n              emitHighlighted={this.props.emitHighlighted}\n              emitClicked={this.props.emitClicked}\n              emitResults={this.emitResults}\n              emitSelected={this.emitSelected}\n              placeholder={placeholderText}\n            ></SearchBar>\n          </div>\n          {infoOverlay}\n        </div>\n      </Overlay>\n    );\n  }\n}\n\nSearchOverlay.propTypes = {\n  toggleSearchOverlay: PropTypes.func.isRequired,\n  emitHighlighted: PropTypes.func.isRequired,\n  emitSelected: PropTypes.func.isRequired,\n  emitClicked: PropTypes.func.isRequired,\n  social: PropTypes.object.isRequired,\n  selectedShipID: PropTypes.string.isRequired,\n};\n\nexport default SearchOverlay;\n","class KeyError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error(this, KeyError);\n  }\n}\n\nclass ValueError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error(this, ValueError);\n  }\n}\n\nclass DuplicateError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error(this, DuplicateError);\n  }\n}\n\nclass MissingError extends Error {\n  constructor(...args) {\n    super(...args);\n    Error(this, MissingError);\n  }\n}\n\nexport { KeyError, ValueError, DuplicateError, MissingError };\n","import Dry from \"json-dry\";\nimport moment from \"moment\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction _toDate(val, def = null) {\n  if (val) {\n    if (val._isAMomentObject) {\n      return val;\n    }\n\n    /*if (val.toISOString){\n      val = val.toISOString();\n    }*/\n\n    let date = moment(val);\n\n    if (!date.isValid()) {\n      console.log(`Invalid Date ${val}`);\n      throw new ValueError(`Invalid Date ${val}`);\n    }\n\n    return date;\n  } else {\n    if (!def) {\n      return null;\n    } else {\n      return _toDate(def);\n    }\n  }\n}\n\n// NOTE FOR FUTURE - moment(x) < moment(y) === true\n//            even though moment(x).toDate() < moment(y).toDate() === false\n//   MOMENT COMPARISONS ARE BROKEN!\n\nfunction _get_min(d1, d2) {\n  if (d1) {\n    if (d2) {\n      if (d1.toDate() < d2.toDate()) {\n        return d1;\n      } else {\n        return d2;\n      }\n    } else {\n      return d1;\n    }\n  } else {\n    return d2;\n  }\n}\n\nfunction _get_max(d1, d2) {\n  if (d1) {\n    if (d2) {\n      if (d1.toDate() > d2.toDate()) {\n        return d1;\n      } else {\n        return d2;\n      }\n    } else {\n      return d1;\n    }\n  } else {\n    return d2;\n  }\n}\n\nfunction _merge_raw(s1, s2) {\n  if (!s1) {\n    return s2;\n  } else if (!s2) {\n    return s1;\n  }\n\n  return `${s1} + ${s2}`;\n}\n\nclass RoughDate {\n  constructor(state) {\n    this.state = {\n      start: null,\n      end: null,\n      raw: null,\n    };\n\n    this.setState(state);\n\n    this._isARoughDateObject = true;\n  }\n\n  setState(state) {\n    if (!state || state === \"null\" || state === null) {\n      this.state = { start: null };\n      return;\n    } else if (state._isARoughDateObject) {\n      this.state = { ...state.state };\n      return;\n    } else if (state._isADateRangeObject) {\n      this.state = state.toDate();\n      return;\n    } else if (state._isAMomentObject) {\n      this.state = { start: _toDate(state) };\n      return;\n    } else if (state.toISOString) {\n      this.state = { start: _toDate(state) };\n      return;\n    } else if (Object.prototype.hasOwnProperty.call(state, \"value\")) {\n      this.state = { start: state.value };\n      return;\n    } else if (typeof state === \"string\") {\n      this.state = { start: _toDate(state), raw: state };\n      return;\n    }\n\n    let start = _toDate(state.start);\n    let end = _toDate(state.end);\n\n    if (!start) {\n      this.state = { start: null };\n      return;\n    }\n\n    this.state.start = start;\n    this.state.end = end;\n    this.state.raw = state.raw;\n\n    if (this.isNull()) {\n      console.log(\"NULL RoughDate?\");\n      console.log(state);\n    }\n  }\n\n  static clone(item) {\n    let d = new RoughDate();\n    d.state = lodash.cloneDeep(item.state);\n    return d;\n  }\n\n  static max(d1, d2) {\n    return new RoughDate(_get_max(d1.getLatest(), d2.getLatest()));\n  }\n\n  static min(d1, d2) {\n    return new RoughDate(_get_min(d1.getEarliest(), d2.getEarliest()));\n  }\n\n  static delta(d1, d2) {\n    return d1.getLatestDate() - d2.getEarliestDate();\n  }\n\n  static getDelta(d1, d2) {\n    return RoughDate.delta(d1, d2);\n  }\n\n  static eq(item, other) {\n    if (item._isARoughDateObject && other._isARoughDateObject) {\n      return (\n        item.getEarliestString() === other.getEarliestString() && item.getLatestString() === other.getLatestString()\n      );\n    } else {\n      return false;\n    }\n  }\n\n  static lt(d1, d2) {\n    if (d1.isNull() || d2.isNull()) {\n      return false;\n    } else {\n      return d1.getEarliestDate() < d2.getEarliestDate();\n    }\n  }\n\n  static gt(d1, d2) {\n    if (d1.isNull() || d2.isNull()) {\n      return false;\n    } else {\n      return d1.getEarliestDate() > d2.getEarliestDate();\n    }\n  }\n\n  static le(d1, d2) {\n    return RoughDate.eq(d1, d2) || RoughDate.lt(d1, d2);\n  }\n\n  static ge(d1, d2) {\n    return RoughDate.eq(d1, d2) || RoughDate.gt(d1, d2);\n  }\n\n  static ne(d1, d2) {\n    return !RoughDate.eq(d1, d2);\n  }\n\n  add(delta) {\n    if (this.state.start) {\n      this.state.start.add(delta);\n    }\n\n    if (this.state.end) {\n      this.state.end.add(delta);\n    }\n\n    this.state.raw = null;\n  }\n\n  sub(delta) {\n    this.add(-delta);\n  }\n\n  isNull() {\n    if (this.state.start) {\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  isFuzzy() {\n    if (this.state.end) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  isExact() {\n    return !(this.isNull() || this.isFuzzy());\n  }\n\n  toString() {\n    if (this.isNull()) {\n      return \"Date:unknown\";\n    } else if (this.isFuzzy()) {\n      return `~${this.state.start.format(\"LL\")}-${this.state.end.format(\"LL\")}`;\n    } else {\n      return this.state.start.format(\"LL\");\n    }\n  }\n\n  toSimpleString() {\n    if (this.isNull()) {\n      return \"unknown\";\n    } else if (this.isFuzzy()) {\n      let s = this.state.start.toDate();\n      let e = this.state.end.toDate();\n\n      if (s.getMonth() === 0 && e.getMonth() === 11 && s.getDate() === 1 && e.getDate() === 31) {\n        //the dates span full years\n        if (s.getFullYear() === e.getFullYear()) {\n          return s.getFullYear();\n        } else {\n          return `${s.getFullYear()}-${e.getFullYear()}`;\n        }\n      } else {\n        return `${s.getDate()}/${s.getMonth() + 1}/${s.getFullYear()}-${e.getDate()}/${\n          e.getMonth() + 1\n        }/${e.getFullYear()}`;\n      }\n    } else {\n      return this.state.start.format(\"LL\");\n    }\n  }\n\n  getEarliest() {\n    let state = { start: this.state.start };\n    let r = new RoughDate();\n    r.state = state;\n    return r;\n  }\n\n  getLatest() {\n    if (this.state.end) {\n      let state = { start: this.state.end };\n      let r = new RoughDate();\n      r.state = state;\n      return r;\n    } else {\n      return this.getEarliest();\n    }\n  }\n\n  getEarliestDate() {\n    let d = this.getEarliest();\n\n    if (d) {\n      return d.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestDate() {\n    let d = this.getLatest();\n\n    if (d) {\n      return d.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getEarliestString() {\n    let d = this.getEarliest();\n\n    if (d) {\n      return d.toDate().toISOString();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestString() {\n    let d = this.getLatest();\n\n    if (d) {\n      return d.toDate().toISOString();\n    } else {\n      return null;\n    }\n  }\n\n  toRange() {\n    if (this.isNull()) {\n      return new DateRange();\n    } else if (this.isExact()) {\n      return new DateRange({ both: this.state.start });\n    } else {\n      return new DateRange({ start: this.state.start, end: this.state.end });\n    }\n  }\n\n  toDateRange() {\n    if (this.isNull()) {\n      return new DateRange();\n    } else if (this.isFuzzy()) {\n      return new DateRange({ start: this.getEarliest(), end: this.getLatest() });\n    } else {\n      return new DateRange({ both: this.getEarliest() });\n    }\n  }\n\n  toDate() {\n    let m = this.toMoment();\n\n    if (m) {\n      try {\n        return m.toDate();\n      } catch (error) {\n        console.log(`STRANGE ERROR ${error}`);\n        console.log(`m = ${m}`);\n        console.log(m);\n        return null;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  //   toUnixTimestamp() {\n  //     return parseInt((this.toDate().getTime() / 1000).toFixed(0));\n  //   }\n\n  toMoment() {\n    if (this.isNull()) {\n      return null;\n    } else if (this.isExact()) {\n      return this.state.start;\n    } else {\n      throw new ValueError(`Cannot extract a single date from an inexact date ${this}`);\n    }\n  }\n\n  getRaw() {\n    return this.state.raw;\n  }\n\n  getStart() {\n    return this.state.start;\n  }\n\n  getEnd() {\n    if (this.state.end) {\n      return this.state.end;\n    } else {\n      return this.state.start;\n    }\n  }\n\n  merge(other) {\n    let state = {\n      start: _get_min(this.getStart(), other.getStart()),\n      end: _get_max(this.getEnd(), other.getEnd()),\n      raw: _merge_raw(this.getRaw(), other.getRaw()),\n    };\n\n    let date = new RoughDate();\n    date.state = state;\n\n    return date;\n  }\n}\n\nRoughDate.unDry = function (value) {\n  return new RoughDate(value);\n};\n\nDry.registerClass(\"Date\", RoughDate);\n\nexport default RoughDate;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport RoughDate from \"./RoughDate\";\nimport { ValueError } from \"./Errors\";\n\nfunction _clean(val) {\n  if (!val || val._isADateRangeObject) {\n    return val;\n  } else if (val._isARoughDateObject) {\n    return val.toDateRange();\n  } else if (\n    Object.prototype.hasOwnProperty.call(val, \"start\") ||\n    Object.prototype.hasOwnProperty.call(val, \"end\") ||\n    Object.prototype.hasOwnProperty.call(val, \"both\") ||\n    Object.prototype.hasOwnProperty.call(val, \"value\")\n  ) {\n    return new DateRange(val);\n  } else {\n    return new DateRange({ both: new RoughDate(val) });\n  }\n}\n\nclass DateRange {\n  constructor(state) {\n    this.state = {\n      start: null,\n      end: null,\n    };\n\n    this.setState(state);\n    this._isADateRangeObject = true;\n  }\n\n  toString() {\n    if (this.hasBounds()) {\n      if (this.isInstant()) {\n        return `DateRange(${this.getStartString()})`;\n      } else {\n        return `DateRange(${this.getStartString()} to ${this.getEndString()})`;\n      }\n    } else {\n      return \"DateRange::unbounded\";\n    }\n  }\n\n  toSimpleString() {\n    if (this.hasBounds()) {\n      if (this.isInstant()) {\n        return this.getStart().toSimpleString();\n      } else {\n        return this.getEarliestStart().merge(this.getLatestEnd()).toSimpleString();\n      }\n    } else if (this.hasStart()) {\n      return `${this.getStart().toSimpleString()}<=>future`;\n    } else if (this.hasEnd()) {\n      return `past<=>${this.getEnd().toSimpleString()}`;\n    } else {\n      return \"past<=>future\";\n    }\n  }\n\n  static clone(item) {\n    let d = new DateRange();\n    d.state = lodash.cloneDeep(item.state);\n    return d;\n  }\n\n  static eq(item, other) {\n    if (item === other) {\n      return true;\n    }\n\n    if (item.hasStart() && other.hasStart()) {\n      if (!RoughDate.eq(item.getStart(), other.getStart())) {\n        return false;\n      }\n    } else if (item.hasStart() || other.hasStart()) {\n      return false;\n    }\n\n    if (item.hasEnd() && other.hasEnd()) {\n      if (!RoughDate.eq(item.getEnd(), other.getEnd())) {\n        return false;\n      }\n    } else if (item.hasEnd() || other.hasEnd()) {\n      return false;\n    }\n\n    return true;\n  }\n\n  static mergeAll(dates) {\n    if (!dates) {\n      return null;\n    } else if (dates._isARoughDateObject || dates._isARoughDateObject) {\n      return dates;\n    }\n\n    if (!dates.length || dates.length === 0) {\n      return null;\n    }\n\n    let date = dates[0];\n\n    if (dates.length > 1) {\n      for (let i = 1; i < dates.length; ++i) {\n        if (!dates[i].isNull()) {\n          if (date.isNull()) {\n            date = dates[i];\n          } else {\n            date = date.merge(dates[i]);\n          }\n        }\n      }\n    }\n\n    if (date.isNull()) {\n      return null;\n    } else {\n      return date;\n    }\n  }\n\n  merge(other) {\n    if (!other) {\n      return this;\n    } else if (other._isARoughDateObject) {\n      other = other.toDateRange();\n    }\n\n    return new DateRange({\n      start: RoughDate.min(this.getEarliestStart(), other.getEarliestStart()),\n      end: RoughDate.max(this.getLatestEnd(), other.getLatestEnd()),\n    });\n  }\n\n  hasBounds() {\n    return this.hasStart() && this.hasEnd();\n  }\n\n  hasEnd() {\n    if (this.state.end) {\n      return !this.state.end.isNull();\n    } else {\n      return false;\n    }\n  }\n\n  hasStart() {\n    if (this.state.start) {\n      return !this.state.start.isNull();\n    } else {\n      return false;\n    }\n  }\n\n  isInstant() {\n    return this.hasStart() && this.state.start === this.state.end;\n  }\n\n  // Returns a DateRange object\n  toDate() {\n    if (this.hasStart()) {\n      if (this.hasEnd()) {\n        return this.getStart().merge(this.getEnd());\n      } else {\n        return this.getStart();\n      }\n    } else {\n      return this.getEnd();\n    }\n  }\n\n  contains(date) {\n    date = _clean(date);\n\n    if (!date) {\n      return true;\n    } else if (date._isADateRangeObject) {\n      const my_start = this.getEarliestStart();\n      const other_start = date.getEarliestStart();\n\n      if (my_start && other_start) {\n        if (RoughDate.gt(my_start, other_start)) {\n          return false;\n        }\n      } else if (other_start) {\n        return false;\n      }\n\n      const my_end = this.getLatestEnd();\n      const other_end = date.getLatestEnd();\n\n      if (my_end && other_end) {\n        if (RoughDate.lt(my_end, other_end)) {\n          return false;\n        }\n      } else if (my_end) {\n        return false;\n      }\n\n      return true;\n    } else {\n      throw new ValueError(`Invalid Date ${date}`);\n    }\n  }\n\n  intersect(other) {\n    other = _clean(other);\n\n    if (!other) {\n      return this;\n    }\n\n    if (!other.hasBounds()) {\n      return this;\n    } else if (!this.hasBounds()) {\n      return other;\n    }\n\n    const start = RoughDate.max(this.getStart(), other.getStart());\n\n    if (!this.contains(start)) {\n      return null;\n    }\n\n    const end = RoughDate.min(this.getEnd(), other.getEnd());\n\n    if (!this.contains(end)) {\n      return null;\n    }\n\n    if (RoughDate.eq(start, end)) {\n      return new DateRange({ both: start });\n    } else {\n      return new DateRange({ start: start, end: end });\n    }\n  }\n\n  union(other) {\n    other = _clean(other);\n    if (!other) {\n      return this;\n    } else if (!other._isADateRangeObject) {\n      other = new DateRange({ value: other });\n    }\n\n    const start = RoughDate.min(this.getStart(), other.getStart());\n    const end = RoughDate.max(this.getEnd(), other.getEnd());\n\n    if (RoughDate.eq(start, end)) {\n      return new DateRange({ both: start });\n    } else {\n      return new DateRange({ start: start, end: end });\n    }\n  }\n\n  getDelta() {\n    if (this.hasStart() && this.hasEnd()) {\n      try {\n        return this.getLatestEnd().toDate() - this.getEarliestStart().toDate();\n      } catch (error) {\n        console.log(error);\n        console.log(this.hasStart(), this.hasEnd());\n        console.log(this.getStart(), this.getEnd());\n        console.log(this.getLatestEnd(), this.getEarliestStart());\n        throw error;\n      }\n    } else {\n      return null;\n    }\n  }\n\n  zoomIn(scale = 1) {\n    let state = lodash.cloneDeep(this.state);\n\n    let delta = null;\n\n    if (state.start !== null && state.end !== null) {\n      delta = this.getDelta() / (2.0 + scale);\n    } else {\n      delta = 3600000;\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(-delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  zoomOut(scale = 1) {\n    let state = lodash.cloneDeep(this.state);\n\n    let delta = null;\n\n    if (state.start !== null && state.end !== null) {\n      delta = this.getDelta() * scale;\n    } else {\n      delta = 3600000;\n    }\n\n    if (state.start) {\n      state.start.add(-delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  shiftEarlier(delta = null) {\n    let state = lodash.cloneDeep(this.state);\n\n    if (delta === null) {\n      if (state.start !== null && state.end !== null) {\n        delta = -this.getDelta(); //milliseconds\n      } else {\n        delta = -3600000; //milliseconds\n      }\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  shiftLater(delta = null) {\n    let state = lodash.cloneDeep(this.state);\n\n    if (delta === null) {\n      if (state.start !== null && state.end !== null) {\n        delta = this.getDelta(); //milliseconds\n      } else {\n        delta = 3600000; //milliseconds\n      }\n    }\n\n    if (state.start) {\n      state.start.add(delta, \"ms\");\n    }\n\n    if (state.end) {\n      state.end.add(delta, \"ms\");\n    }\n\n    return new DateRange(state);\n  }\n\n  getStart() {\n    return this.state.start;\n  }\n\n  getEnd() {\n    return this.state.end;\n  }\n\n  getEarliestStart() {\n    if (this.hasStart()) {\n      return this.getStart().getEarliest();\n    } else {\n      return null;\n    }\n  }\n\n  getLatestEnd() {\n    if (this.hasEnd()) {\n      return this.getEnd().getLatest();\n    } else {\n      return null;\n    }\n  }\n\n  getStartDate() {\n    let e = this.getEarliestStart();\n    if (e) {\n      return e.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getEndDate() {\n    let e = this.getLatestEnd();\n    if (e) {\n      return e.toDate();\n    } else {\n      return null;\n    }\n  }\n\n  getStartString() {\n    if (this.state.start) {\n      return this.state.start.toString();\n    } else {\n      return \"unbounded\";\n    }\n  }\n\n  getEndString() {\n    if (this.state.end) {\n      return this.state.end.toString();\n    } else {\n      return \"unbounded\";\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      if (state === \"null\" || state === null) {\n        this.state = { start: null, end: null };\n        return;\n      } else if (state._isADateRangeObject) {\n        this.state = { ...state.state };\n      } else if (state._isARoughDateObject) {\n        this.state = { start: state, end: state };\n      } else if (Object.prototype.hasOwnProperty.call(state, \"value\")) {\n        this.setState(state.value);\n        return;\n      } else if (Object.prototype.hasOwnProperty.call(state, \"both\")) {\n        this.state.start = new RoughDate(state.both);\n        this.state.end = this.state.start;\n      } else if (typeof state === \"string\") {\n        this.state.start = new RoughDate(state);\n        this.state.end = this.state.start;\n      } else {\n        let start = null;\n\n        if (state.start) {\n          start = new RoughDate(state.start);\n\n          if (start.isNull()) {\n            start = null;\n          }\n        }\n\n        let end = null;\n\n        if (state.end) {\n          end = new RoughDate(state.end);\n\n          if (end.isNull()) {\n            end = null;\n          }\n        }\n\n        if (start && end) {\n          if (RoughDate.gt(start, end)) {\n            let tmp = start;\n            start = end;\n            end = tmp;\n          }\n\n          if (RoughDate.gt(start, end)) {\n            let tmp = RoughDate.min(start, end);\n            end = RoughDate.max(start, end);\n            start = tmp;\n          }\n        }\n\n        this.state.start = start;\n        this.state.end = end;\n      }\n    } else {\n      this.state.start = null;\n      this.state.end = null;\n    }\n  }\n\n  toDry() {\n    return this.state;\n  }\n}\n\nDateRange.unDry = function (value) {\n  return new DateRange(value);\n};\n\nDry.registerClass(\"DateRange\", DateRange);\n\nexport default DateRange;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport fixedNodes from \"../data/fixedNodes.json\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _filterWindow(values, window) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    let dates = values[key];\n\n    let intersect = window.intersect(dates);\n\n    if (!intersect) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nfunction _filterProject(values, project) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    if (!(key in project)) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nclass Person {\n  constructor(props) {\n    this.state = {\n      name: null,\n      titles: [],\n      firstnames: [],\n      surnames: [],\n      suffixes: [],\n      id: null,\n      positions: {},\n      affiliations: {},\n      projects: {},\n      sources: {},\n      alive: null,\n      gender: null,\n      notes: [],\n      orig_name: null,\n      weight: {},\n      edge_count: {},\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAPersonObject = true;\n  }\n\n  static clone(item) {\n    let c = new Person();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  isNode() {\n    return true;\n  }\n\n  inGroup(group) {\n    if (group.getID) {\n      let ids = {};\n      ids[group.getID()] = 1;\n      group = ids;\n    }\n\n    let seen = {};\n\n    Object.keys(this.state.affiliations).forEach((key) => {\n      for (let index in this.state.affiliations[key]) {\n        if (this.state.affiliations[key][index] in group) {\n          seen[this.state.affiliations[key][index]] = 1;\n        }\n      }\n    });\n\n    Object.keys(this.state.positions).forEach((key) => {\n      for (let index in this.state.positions[key]) {\n        if (this.state.positions[key][index] in group) {\n          seen[this.state.positions[key][index]] = 1;\n        }\n      }\n    });\n\n    return Object.keys(seen).length === Object.keys(group).length;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(this.state.sources).forEach((key) => {\n      let s = this.state.sources[key];\n\n      Object.keys(source).forEach((source_id) => {\n        if (s.includes(source_id)) {\n          seen[source_id] = 1;\n        }\n      });\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nprojects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nprojects) {\n      return null;\n    }\n\n    let affiliations = _filterProject(this.state.affiliations, project);\n    let positions = _filterProject(this.state.positions, project);\n    let weight = _filterProject(this.state.weight, project);\n    let edge_count = _filterProject(this.state.edge_count, project);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions ||\n        weight !== this.state.weight || edge_count !== this.state.edge_count) {\n      let person = new Person();\n      person.state = { ...this.state };\n      person.state.affiliations = affiliations;\n      person.state.positions = positions;\n      person.state.weight = weight;\n      person.state.edge_count = edge_count;\n      person._getHook = this._getHook;\n      return person;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    window = window.intersect(this.getAlive());\n\n    if (!window) {\n      return null;\n    }\n\n    let affiliations = _filterWindow(this.state.affiliations, window);\n    let positions = _filterWindow(this.state.positions, window);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions) {\n      let person = new Person();\n      person.state = { ...this.state };\n      person.state.affiliations = affiliations;\n      person.state.positions = positions;\n      person._getHook = this._getHook;\n      return person;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.titles = setState(state.titles, []);\n      this.state.firstnames = setState(state.firstnames, []);\n      this.state.surnames = setState(state.surnames, []);\n      this.state.suffixes = setState(state.suffixes, []);\n      this.state.id = setState(state.id);\n      this.state.positions = setState(state.positions, {});\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.projects = setState(state.projects, {});\n      this.state.sources = setState(state.sources, {});\n      this.state.alive = setState(state.alive);\n      this.state.gender = setState(state.gender);\n      this.state.orig_name = setState(state.orig_name);\n      this.state.notes = setState(state.notes, []);\n      this.state.weight = setState(state.weight);\n      this.state.edge_count = setState(state.edge_count);\n\n      if (!this.state.orig_name || this.state.orig_name === \"None\") {\n        throw new ValueError(`No name for ${this}`);\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Person(${this.getName()})`;\n  }\n\n  getAlive() {\n    return this.state.alive;\n  }\n\n  getFirstName() {\n    if (this.state.firstnames) {\n      return this.state.firstnames.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getTitle() {\n    if (this.state.titles) {\n      return this.state.titles.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getSurname() {\n    if (this.state.surnames) {\n      return this.state.surnames.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getSuffix() {\n    if (this.state.suffixes) {\n      return this.state.suffixes.join(\" \");\n    } else {\n      return null;\n    }\n  }\n\n  getName() {\n    var parts = [];\n\n    let part = this.getTitle();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getFirstName();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getSurname();\n    if (part) {\n      parts.push(part);\n    }\n\n    part = this.getSuffix();\n    if (part) {\n      parts.push(part);\n    }\n\n    if (parts.length > 0) {\n      return parts.join(\" \");\n    } else {\n      return \"null\";\n    }\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getPositions() {\n    // Returns the positions object for each project\n    return this.state.positions;\n  }\n\n  getPosition(projectID) {\n    // Return the position for the associated projectID\n    // Returns an array of position IDs\n    return this.state.positions[projectID];\n  }\n\n  getScores() {\n    return this.state.scores;\n  }\n\n  getBorn() {\n    if (this.state.alive) {\n      return this.state.alive.getStart();\n    } else {\n      return null;\n    }\n  }\n\n  getDied() {\n    if (this.state.alive) {\n      return this.state.alive.getEnd();\n    } else {\n      return null;\n    }\n  }\n\n  getTimeLine() {\n    const alive = this.getAlive();\n\n    if (!alive) {\n      return null;\n    } else {\n      return {\n        start: alive.getStart(),\n        end: alive.getEnd(),\n        id: this.getID(),\n        content: this.getName(),\n      };\n    }\n  }\n\n  getWeight() {\n    return this.state.weight;\n  }\n\n  getedge_count() {\n    return this.state.edge_count;\n  }\n\n  getProjectWeight(projectKey) {\n    const weight = this.state.weight[projectKey];\n\n    if (!weight) {\n      console.error(\"No weight for \" + this.getName() + this.getID() + \" for project with key \" + projectKey);\n      return 1;\n    }\n\n    return weight;\n  }\n\n  getNode(isAnchor = false) {\n    let node = {\n      id: this.getID(),\n      label: this.getName(),\n      title: this.getName(),\n      fixed: false,\n      shape: \"circle\",\n    };\n\n    const name = this.getName();\n\n    node[\"weight\"] = this.getWeight();\n    node[\"type\"] = \"person\";\n\n    // Position will be used to set the colour used\n    // for the node representing this person\n    node[\"positions\"] = this.getPositions();\n    node[\"edge_count\"] = this.getedge_count();\n\n    let keys = Object.keys(this.state.projects);\n\n    if (keys.length > 0) {\n      node[\"group\"] = keys.sort().join(\":\");\n    } else {\n      node[\"group\"] = \"unknown\";\n    }\n\n    if (isAnchor) {\n      node[\"shape\"] = \"rect\";\n      node[\"fixed\"] = true;\n      node[\"group\"] = \"anchor\";\n    }\n\n    if (name in fixedNodes) {\n      node[\"fixed\"] = true;\n      node[\"fixedLocation\"] = fixedNodes[name];\n    }\n\n    return node;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPerson.unDry = function (value) {\n  return new Person(value);\n};\n\nDry.registerClass(\"Person\", Person);\n\nexport default Person;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Person from \"./Person\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_person_uid() {\n  let uid = uuidv4();\n  return \"P\" + uid.substring(uid.length - 7);\n}\n\nclass People {\n  constructor(props) {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAPeopleObject = true;\n    this.load(props);\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new People();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Person || item._isAPersonObject;\n  }\n\n  add(person) {\n    if (!this.canAdd(person)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(person.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(person);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    person = Person.clone(person);\n\n    let id = person.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Person ID ${person}`);\n      }\n\n      person._updateHooks(this._getHook);\n      this.state.registry[id] = person;\n    } else {\n      let uid = _generate_person_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_person_uid();\n      }\n\n      person.state.id = uid;\n    }\n\n    person._updateHooks(this._getHook);\n    this._names[person.getName()] = person.getID();\n    this.state.registry[person.getID()] = person;\n\n    return person;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Person with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Person || name._isAPersonObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    // let keys = Object.keys(this._names).join(\"', '\");\n\n    // throw new MissingError(`No Person matches '${name}. Available People are '${keys}'`);\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n\n      if (person) {\n        for (let i = 0; i < funcs.length; ++i) {\n          person = funcs[i](person);\n          if (!person) {\n            break;\n          }\n        }\n\n        if (person) {\n          registry[key] = person;\n          names[person.getName()] = key;\n        }\n      }\n    });\n\n    let people = new People();\n    people.state.registry = registry;\n    people._names = names;\n    people._updateHooks(this._getHook);\n\n    return people;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n      if (person) {\n        let timeline = person.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  getNodes({ anchor = null } = {}) {\n    let nodes = [];\n\n    if (anchor.getID) {\n      anchor = anchor.getID();\n    }\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let person = this.state.registry[key];\n\n      if (person) {\n        let node = null;\n        if (key === anchor) {\n          node = person.getNode({ is_anchor: true });\n        } else {\n          node = person.getNode();\n        }\n\n        if (node) {\n          nodes.push(node);\n        }\n      }\n    });\n\n    return nodes;\n  }\n\n  getRegistry() {\n    // Returns the registry of people\n    // key: value - uid: person\n    return this.state.registry;\n  }\n\n  get(id) {\n    let person = this.state.registry[id];\n\n    if (!person) {\n      throw new MissingError(`No Person with ID ${id}`);\n    }\n\n    return person;\n  }\n\n  load(data) {\n    if (data) {\n      if (data.array) {\n        data = data.array;\n      }\n      data.forEach((element) => {\n        let person = Person.load(element);\n        this.add(person);\n      });\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPeople.unDry = function (value) {\n  let people = new People();\n  people.state = value;\n  people._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    people._names[v.getName()] = key;\n  });\n\n  return people;\n};\n\nDry.registerClass(\"People\", People);\n\nexport default People;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport fixedNodes from \"../data/fixedNodes.json\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _filterWindow(values, window) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    let dates = values[key];\n\n    let intersect = window.intersect(dates);\n\n    if (!intersect) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nfunction _filterProject(values, project) {\n  if (!values) {\n    return values;\n  }\n\n  let ret = null;\n\n  Object.keys(values).forEach((key) => {\n    if (!(key in project)) {\n      if (!ret) {\n        ret = { ...values };\n      }\n      delete ret[key];\n    }\n  });\n\n  if (ret) {\n    return ret;\n  } else {\n    return values;\n  }\n}\n\nclass Business {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      projects: {},\n      sources: {},\n      positions: {},\n      scores: {},\n      affiliations: {},\n      notes: [],\n      weight: {},\n      edge_count: {},\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isABusinessObject = true;\n  }\n\n  static clone(item) {\n    let c = new Business();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  isNode() {\n    return true;\n  }\n\n  inGroup(group) {\n    if (group.getID) {\n      let ids = {};\n      ids[group.getID()] = 1;\n      group = ids;\n    }\n\n    let seen = {};\n\n    Object.keys(this.state.affiliations).forEach((key) => {\n      for (let index in this.state.affiliations[key]) {\n        if (this.state.affiliations[key][index] in group) {\n          seen[this.state.affiliations[key][index]] = 1;\n        }\n      }\n    });\n\n    Object.keys(this.state.positions).forEach((key) => {\n      for (let index in this.state.positions[key]) {\n        if (this.state.positions[key][index] in group) {\n          seen[this.state.positions[key][index]] = 1;\n        }\n      }\n    });\n\n    return Object.keys(seen).length === Object.keys(group).length;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(this.state.sources).forEach((key) => {\n      let s = this.state.sources[key];\n\n      Object.keys(source).forEach((source_id) => {\n        if (s.includes(source_id)) {\n          seen[source_id] = 1;\n        }\n      });\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nprojects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nprojects) {\n      return null;\n    }\n\n    let affiliations = _filterProject(this.state.affiliations, project);\n    let positions = _filterProject(this.state.positions, project);\n    let weight = _filterProject(this.state.weight, project);\n    let edge_count = _filterProject(this.state.edge_count, project);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions ||\n        weight !== this.state.weight || edge_count !== this.state.edge_count) {\n      let business = new Business();\n      business.state = { ...this.state };\n      business.state.affiliations = affiliations;\n      business.state.positions = positions;\n      business.state.weight = weight;\n      business.state.edge_count = edge_count;\n      business._getHook = this._getHook;\n      return business;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    let affiliations = _filterWindow(this.state.affiliations, window);\n    let positions = _filterProject(this.state.positions, window);\n\n    if (affiliations !== this.state.affiliations || positions !== this.state.positions) {\n      let business = new Business();\n      business.state = { ...this.state };\n      business.state.affiliations = affiliations;\n      business.state.positions = positions;\n      business._getHook = this._getHook;\n      return business;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.projects = setState(state.projects, {});\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.positions = setState(state.positions, {});\n      this.state.scores = setState(state.scores, {});\n      this.state.sources = setState(state.sources, {});\n      this.state.notes = setState(state.notes, []);\n      this.state.weight = setState(state.weight);\n      this.state.edge_count = setState(state.edge_count);\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Business without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  getWeight() {\n    return this.state.weight;\n  }\n\n  toString() {\n    return `Business(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getPosition(projectID) {\n    // Return the position for the associated projectID\n    // Returns an array of position IDs\n    return this.state.positions[projectID];\n  }\n\n  getPositions() {\n    // Return the position for the associated projectID\n    // Returns an array of position IDs\n    return this.state.positions;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getScores() {\n    return this.state.scores;\n  }\n\n  getedge_count() {\n    return this.state.edge_count;\n  }\n\n  getNode(is_anchor = false) {\n    let node = { id: this.getID(), label: this.getName(), title: this.getName(), shape: \"circle\" };\n\n    const weight = this.getWeight();\n\n    node[\"size\"] = 0.5 * weight;\n    node[\"weight\"] = weight;\n    node[\"type\"] = \"business\";\n\n    node[\"edge_count\"] = this.getedge_count();\n\n    // Position will be used to set the colour used\n    // for the node representing this person\n    node[\"positions\"] = this.getPositions();\n\n    let keys = Object.keys(this.state.projects);\n\n    if (keys.length > 0) {\n      node[\"group\"] = keys.sort().join(\":\");\n    } else {\n      node[\"group\"] = \"unknown\";\n    }\n\n    if (is_anchor) {\n      node[\"shape\"] = \"rect\";\n      node[\"physics\"] = false;\n      node[\"group\"] = \"anchor\";\n      node[\"size\"] = 20.0;\n    }\n\n    if (this.getName() in fixedNodes) {\n      node[\"fixed\"] = true;\n    }\n    return node;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nBusiness.unDry = function (value) {\n  return new Business(value);\n};\n\nDry.registerClass(\"Business\", Business);\n\nexport default Business;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Business from \"./Business\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_business_uid() {\n  let uid = uuidv4();\n  return \"B\" + uid.substring(uid.length - 7);\n}\n\nclass Businesses {\n  constructor(props) {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isABusinessesObject = true;\n    this.load(props);\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Businesses();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Business || item._isABusinessObject;\n  }\n\n  add(business) {\n    if (!this.canAdd(business)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(business.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(business);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    business = Business.clone(business);\n\n    let id = business.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Business ID ${business}`);\n      }\n\n      business._updateHooks(this._getHook);\n      this.state.registry[id] = business;\n    } else {\n      let uid = _generate_business_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_business_uid();\n      }\n\n      business.state.id = uid;\n    }\n\n    business._updateHooks(this._getHook);\n    this._names[business.getName()] = business.getID();\n    this.state.registry[business.getID()] = business;\n\n    return business;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Business with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Business || name._isABusinessObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    // let keys = Object.keys(this._names).join(\"', '\");\n\n    // throw new MissingError(`No Business matches '${name}. Available Businesses are '${keys}'`);\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n\n      if (business) {\n        for (let i = 0; i < funcs.length; ++i) {\n          business = funcs[i](business);\n          if (!business) {\n            break;\n          }\n        }\n\n        if (business) {\n          registry[key] = business;\n          names[business.getName()] = key;\n        }\n      }\n    });\n\n    let businesses = new Businesses();\n    businesses.state.registry = registry;\n    businesses._names = names;\n    businesses._updateHooks(this._getHook);\n\n    return businesses;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n      if (business) {\n        let timeline = business.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  getNodes({ anchor = null } = {}) {\n    let nodes = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let business = this.state.registry[key];\n\n      if (business) {\n        let node = null;\n        if (key === anchor) {\n          node = business.getNode({ is_anchor: true });\n        } else {\n          node = business.getNode();\n        }\n\n        if (node) {\n          nodes.push(node);\n        }\n      }\n    });\n\n    return nodes;\n  }\n\n  get(id) {\n    let business = this.state.registry[id];\n\n    if (!business) {\n      throw new MissingError(`No Business with ID ${id}`);\n    }\n\n    return business;\n  }\n\n  getRegistry() {\n    // Returns the registry of people\n    // key: value - uid: person\n    return this.state.registry;\n  }\n\n  load(data) {\n    if (data) {\n      if (data.array) {\n        data = data.array;\n      }\n      data.forEach((element) => {\n        let business = Business.load(element);\n        this.add(business);\n      });\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nBusinesses.unDry = function (value) {\n  let businesses = new Businesses();\n  businesses.state = value;\n  businesses._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    businesses._names[v.getName()] = key;\n  });\n\n  return businesses;\n};\n\nDry.registerClass(\"Businesses\", Businesses);\n\nexport default Businesses;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nfunction _mergeSources(state, other, key) {\n  state = state[key];\n  other = other[key];\n\n  Object.keys(other).forEach((key) => {\n    if (!(key in state)) {\n      state[key] = other[key];\n    } else {\n      for (let item in other[key]) {\n        if (!(item in state[key])) {\n          state[key].push(item);\n        }\n      }\n    }\n  });\n}\n\nclass Connection {\n  constructor(props) {\n    this.state = {\n      id: null,\n      n0: null,\n      n1: null,\n      shared: null,\n      type: null,\n      duration: null,\n      affiliations: null,\n      correspondances: null,\n      projects: null,\n      notes: null,\n    };\n\n    this.setState(props);\n    this._getHook = null;\n    this._isAConnectionObject = true;\n  }\n\n  static clone(item) {\n    let c = new Connection();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  getName() {\n    let n0 = this.state.n0;\n    let n1 = this.state.n1;\n\n    if (n0 <= n1) {\n      return `${n0}<=>${n1}`;\n    } else {\n      return `${n1}<=>${n0}`;\n    }\n  }\n\n  getNode0() {\n    if (this._getHook) {\n      return this._getHook(this.state.n0);\n    } else {\n      return this.state.n0;\n    }\n  }\n\n  getNode1() {\n    if (this._getHook) {\n      return this._getHook(this.state.n1);\n    } else {\n      return this.state.n1;\n    }\n  }\n\n  getNode0ID() {\n    return this.state.n0;\n  }\n\n  getNode1ID() {\n    return this.state.n1;\n  }\n\n  areNodesVisible(n) {\n    return n[this.state.n0] && n[this.state.n1];\n  }\n\n  getNode0Name() {\n    let node0 = this.getNode0();\n\n    try {\n      return node0.getName();\n    } catch (error) {\n      return node0;\n    }\n  }\n\n  getNode1Name() {\n    let node1 = this.getNode1();\n\n    try {\n      return node1.getName();\n    } catch (error) {\n      return node1;\n    }\n  }\n\n  getDuration() {\n    return this.state.duration;\n  }\n\n  getAffiliationSources() {\n    return this.state.affiliations;\n  }\n\n  getCorrespondanceSources() {\n    return this.state.correspondances;\n  }\n\n  filterSource(source) {\n    if (source.getID) {\n      let id = source.getID();\n      source = {};\n      source[id] = 1;\n    }\n\n    let nsources = Object.keys(source).length;\n\n    let seen = {};\n\n    Object.keys(source).forEach((key) => {\n      if (this.state.affiliations[key] || this.state.correspondances[key]) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nsources) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterProject(project) {\n    // Filter this connection by project ID\n    if (project.getID) {\n      let id = project.getID();\n      project = {};\n      project[id] = 1;\n    }\n\n    let nProjects = Object.keys(project).length;\n\n    let seen = {};\n\n    Object.keys(this.state.projects).forEach((key) => {\n      if (key in project) {\n        seen[key] = 1;\n      }\n    });\n\n    if (Object.keys(seen).length !== nProjects) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  filterWindow(window) {\n    if (!window) {\n      return this;\n    } else if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (!window) {\n      return this;\n    }\n\n    let duration = this.getDuration();\n\n    if (!duration) {\n      return this;\n    }\n\n    let intersect = window.intersect(duration);\n\n    if (!intersect) {\n      return null;\n    } else {\n      return this;\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.id = setState(state.id);\n      this.state.n0 = setState(state.n0);\n      this.state.n1 = setState(state.n1);\n      this.state.shared = setState(state.shared, []);\n      this.state.type = setState(state.type);\n      this.state.duration = setState(state.duration);\n      this.state.affiliations = setState(state.affiliations, {});\n      this.state.correspondances = setState(state.correspondances, {});\n      this.state.notes = setState(state.notes, []);\n      this.state.weights = setState(state.weights, {});\n      this.state.projects = setState(state.projects, {});\n\n      if (!this.state.n0 || !this.state.n1) {\n        throw new ValueError(`Invalid connection ${this}`);\n      }\n    }\n  }\n\n  merge(other) {\n    if (!this._getHook) {\n      if (other._getHook) {\n        return other.merge(this);\n      }\n    }\n\n    let state = lodash.cloneDeep(this.state);\n\n    Object.keys(other.state.shared).forEach((key) => {\n      if (!(key in state.shared)) {\n        state.shared[key] = other.state.shared[key];\n      }\n    });\n\n    Object.keys(other.state.notes).forEach((key) => {\n      if (!(key in state.notes)) {\n        state.notes[key] = other.state.notes[key];\n      }\n    });\n\n    _mergeSources(state, other.state, \"affiliations\");\n    _mergeSources(state, other.state, \"correspondances\");\n\n    state.duration = state.duration.merge(other.state.duration);\n\n    let c = new Connection();\n    c.state = state;\n    c._getHook = this._getHook;\n\n    return c;\n  }\n\n  toString() {\n    return `Connection(${this.getNode0Name()}<=>${this.getNode1Name()})`;\n  }\n\n  getColorFromType() {\n    switch (this.state.type) {\n      case \"direct\":\n        return \"rgb(180,150,150)\";\n      case \"indirect\":\n        return \"rgb(180,180,180)\";\n      default:\n        return \"orange\";\n    }\n  }\n\n  getType() {\n    return this.state.type;\n  }\n\n  getWeights() {\n    return this.state.weights;\n  }\n\n  getWeight() {\n    let weight = 1.0;\n\n    Object.keys(this.state.weights).forEach((key) => {\n      weight += this.state.weights[key];\n    });\n\n    return weight;\n  }\n\n  getWeightFromType() {\n    let weight = this.getWeight();\n\n    switch (this.state.type) {\n      case \"direct\":\n        return 1.0 * weight;\n      case \"indirect\":\n        return 0.5 * weight;\n      default:\n        console.log(`Unknown type? ${this.state.type}`);\n        return 0.5 * weight;\n    }\n  }\n\n  toEdge() {\n    let color = this.getColorFromType();\n    // let weight = this.getWeightFromType();\n    let weight = this.getWeight();\n\n    let edge = {\n      id: this.getID(),\n      source: this.state.n0,\n      target: this.state.n1,\n      value: weight,\n      type: this.state.type,\n      color: color,\n    };\n\n    return edge;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nConnection.unDry = function (value) {\n  return new Connection(value);\n};\n\nConnection.load = function (data) {\n  return new Connection({ name: data.name });\n};\n\nDry.registerClass(\"Connection\", Connection);\n\nexport default Connection;\n","\n/** Return the ID number of the passed node. This is used to\n *  standardise how I get IDs. It will first try 'getID()',\n * then, if that fails, .id, and will then return the object\n * itself\n */\nexport default function get_id(node) {\n  if (node.getID) {\n    return node.getID();\n  } else if (node.id) {\n    return node.id;\n  } else {\n    return node;\n  }\n}\n","import Dry from \"json-dry\";\nimport {\n  v4 as uuidv4\n} from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Connection from \"./Connection\";\nimport get_id from \"./get_id\";\n\nimport {\n  KeyError,\n  MissingError\n} from \"./Errors\";\n\nfunction _generate_connection_uid() {\n  let uid = uuidv4();\n  return \"C\" + uid.substring(uid.length - 7);\n}\n\nclass Connections {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._connections = {};\n    this._isAConnectionsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Connections();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  canAdd(item) {\n    return item instanceof Connection || item._isAConnectionObject;\n  }\n\n  add(connection) {\n    if (!this.canAdd(connection)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(connection.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(connection);\n      this.state.registry[get_id(existing)] = existing;\n      return existing;\n    }\n\n    connection = Connection.clone(connection);\n\n    let id = get_id(connection);\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Connection ID ${connection}`);\n      }\n    } else {\n      let uid = _generate_connection_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_connection_uid();\n      }\n\n      connection.state.id = uid;\n    }\n\n    connection._updateHooks(this._getHook);\n    let connection_id = get_id(connection);\n    this._names[connection.getName()] = connection_id;\n    this.state.registry[connection_id] = connection;\n\n    let id0 = connection.getNode0ID();\n    let id1 = connection.getNode1ID();\n\n    if (!(id0 in this._connections)) {\n      this._connections[id0] = {};\n    }\n\n    if (!(id1 in this._connections)) {\n      this._connections[id1] = {};\n    }\n\n    this._connections[id0][id1] = 1;\n    this._connections[id1][id0] = 1;\n\n    return connection;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No connection with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Connection || name._isAConnectionObject) {\n      return this.get(get_id(name));\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    } else {\n      return results;\n    }\n\n    // let keys = Object.keys(this._names).join(\"', '\");\n\n    // throw new TypeError(`No connection matches '${name}. Available Connections are '${keys}'`);\n  }\n\n  gotConnections(id) {\n    return !(this.find(id).length === 0);\n  }\n\n  get(id) {\n    let connection = this.state.registry[id];\n\n    if (!connection) {\n      throw new MissingError(`No Connection with ID ${id}`);\n    }\n\n    return connection;\n  }\n\n  filter(funcs = []) {\n    if (funcs.length === 0) {\n      return this;\n    }\n\n    let registry = {};\n    let names = {};\n    let conns = {};\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let connection = this.state.registry[key];\n\n      if (connection) {\n        for (let i = 0; i < funcs.length; ++i) {\n          connection = funcs[i](connection);\n          if (!connection) {\n            break;\n          }\n        }\n\n        if (connection) {\n          registry[key] = connection;\n          names[connection.getName()] = key;\n\n          let id0 = connection.getNode0ID();\n          let id1 = connection.getNode1ID();\n\n          if (!(id0 in conns)) {\n            conns[id0] = {};\n          }\n\n          if (!(id1 in conns)) {\n            conns[id1] = {};\n          }\n\n          conns[id0][id1] = 1;\n          conns[id1][id0] = 1;\n        }\n      }\n    });\n\n    let connections = new Connections();\n\n    connections.state.registry = registry;\n    connections._names = names;\n    connections._connections = conns;\n    connections._updateHooks(this._getHook);\n\n    return connections;\n  }\n\n  getConnectionsTo(item) {\n    if (item.getID) {\n      let id = item.getID();\n      item = {};\n      item[id] = 1;\n    }\n\n    let nnodes = Object.keys(item).length;\n\n    let seen = {};\n\n    function _add(id) {\n      if (!(id in seen)) {\n        seen[id] = 1;\n      } else {\n        seen[id] += 1;\n      }\n    }\n\n    for (let key in this.state.registry) {\n      let connection = this.state.registry[key];\n\n      if (connection.getNode0ID() in item) {\n        _add(connection.getNode1ID());\n      } else if (connection.getNode1ID() in item) {\n        _add(connection.getNode0ID());\n      }\n    }\n\n    let connections = [];\n\n    if (this._getHook) {\n      Object.keys(seen).forEach((key) => {\n        try {\n          if (seen[key] === nnodes) {\n            connections.push(this._getHook(key));\n          }\n        } catch (error) {\n          console.error(error);\n        }\n      });\n    } else {\n      connections = Object.keys(seen);\n    }\n\n    return connections;\n  }\n\n  areConnected(item0, item1) {\n    item0 = get_id(item0);\n    item1 = get_id(item1);\n\n    if (item0 in this._connections) {\n      return item1 in this._connections[item0];\n    } else {\n      return false;\n    }\n  }\n\n  getEdges(ids = null) {\n    let edges = [];\n\n    if (ids) {\n      Object.keys(this.state.registry).forEach((key) => {\n        let connection = this.state.registry[key];\n        if (connection.areNodesVisible(ids)) {\n          edges.push(connection.toEdge());\n        }\n      });\n    } else {\n      Object.keys(this.state.registry).forEach((key) => {\n        let connection = this.state.registry[key];\n        edges.push(connection.toEdge());\n      });\n    }\n\n    return edges;\n  }\n\n  toDry() {\n    return {\n      value: this.state\n    };\n  }\n}\n\nConnections.unDry = function (value) {\n  let connections = new Connections();\n  connections.state = value;\n  connections._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    connections._names[v.getName()] = key;\n\n    let id0 = v.getNode0ID();\n    let id1 = v.getNode1ID();\n\n    if (!(id0 in connections._connections)) {\n      connections._connections[id0] = {};\n    }\n\n    if (!(id1 in connections._connections)) {\n      connections._connections[id1] = {};\n    }\n\n    connections._connections[id0][id1] = 1;\n    connections._connections[id1][id0] = 1;\n  });\n\n  return connections;\n};\n\nDry.registerClass(\"Connections\", Connections);\n\nexport default Connections;","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Position {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      sources: [],\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAPositionObject = true;\n  }\n\n  static clone(item) {\n    let c = new Position();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  static makeCanonical(name) {\n    if (!name) {\n      return null;\n    } else {\n      return name.trim().toLowerCase();\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n\n      this.state.canonical = Position.makeCanonical(this.state.name);\n\n      if (!this.state.name){\n        throw new ValueError(\"You cannot have an Position without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Position(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPosition.unDry = function (value) {\n  return new Position(value);\n};\n\nDry.registerClass(\"Position\", Position);\n\nexport default Position;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Position from \"./Position\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_position_uid() {\n  let uid = uuidv4();\n  return \"Q\" + uid.substring(uid.length - 7);\n}\n\nclass Positions {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAPositionsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Positions();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  items() {\n    return this._names;\n  }\n\n  canAdd(item) {\n    return item instanceof Position || item._isAPositionObject;\n  }\n\n  add(position) {\n    if (!this.canAdd(position)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(position.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(position);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    position = Position.clone(position);\n\n    let id = position.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Position ID ${position}`);\n      }\n\n      position._updateHooks(this._getHook);\n      this.state.registry[id] = position;\n    } else {\n      let uid = _generate_position_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_position_uid();\n      }\n\n      position.state.id = uid;\n    }\n\n    position._updateHooks(this._getHook);\n    this._names[position.getName()] = position.getID();\n    this.state.registry[position.getID()] = position;\n\n    return position;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No position with name ${name}`);\n    }\n  }\n\n  getNameByID(id) {\n    return this.get(id).getName();\n  }\n\n  find(name) {\n    if (name instanceof Position || name._isApositionObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n  }\n\n  get(id) {\n    let position = this.state.registry[id];\n\n    if (!position) {\n      throw new MissingError(`No Position with ID ${id}`);\n    }\n\n    return position;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nPositions.unDry = function (value) {\n  let positions = new Positions();\n  positions.state = value;\n  positions._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    positions._names[v.getName()] = key;\n  });\n\n  return positions;\n};\n\nDry.registerClass(\"Positions\", Positions);\n\nexport default Positions;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Affiliation {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      sources: [],\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAAffiliationObject = true;\n  }\n\n  static clone(item) {\n    let c = new Affiliation();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  static makeCanonical(name) {\n    if (!name) {\n      return null;\n    } else {\n      return name.trim().toLowerCase();\n    }\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n\n      this.state.canonical = Affiliation.makeCanonical(this.state.name);\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Affiliation without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Affiliation(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nAffiliation.unDry = function (value) {\n  return new Affiliation(value);\n};\n\nDry.registerClass(\"Affiliation\", Affiliation);\n\nexport default Affiliation;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Affiliation from \"./Affiliation\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_affiliation_uid() {\n  let uid = uuidv4();\n  return \"A\" + uid.substring(uid.length - 7);\n}\n\nclass Affiliations {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAAffiliationsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Affiliations();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Affiliation || item._isAAffiliationObject;\n  }\n\n  add(affiliation) {\n    if (!this.canAdd(affiliation)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(affiliation.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(affiliation);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    affiliation = Affiliation.clone(affiliation);\n\n    let id = affiliation.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Affiliation ID ${affiliation}`);\n      }\n\n      affiliation._updateHooks(this._getHook);\n      this.state.registry[id] = affiliation;\n    } else {\n      let uid = _generate_affiliation_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_affiliation_uid();\n      }\n\n      affiliation.state.id = uid;\n    }\n\n    affiliation._updateHooks(this._getHook);\n    this._names[affiliation.getName()] = affiliation.getID();\n    this.state.registry[affiliation.getID()] = affiliation;\n\n    return affiliation;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No affiliation with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Affiliation || name._isAAffiliationObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    // let keys = Object.keys(this._names).join(\"', '\");\n\n    // throw new MissingError(`No affiliation matches '${name}. Available Affiliations are '${keys}'`);\n  }\n\n  get(id) {\n    let affiliation = this.state.registry[id];\n\n    if (!affiliation) {\n      throw new MissingError(`No Affiliation with ID ${id}`);\n    }\n\n    return affiliation;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nAffiliations.unDry = function (value) {\n  let affiliations = new Affiliations();\n  affiliations.state = value;\n  affiliations._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    affiliations._names[v.getName()] = key;\n  });\n\n  return affiliations;\n};\n\nDry.registerClass(\"Affiliations\", Affiliations);\n\nexport default Affiliations;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport RoughDate from \"./RoughDate\";\n\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Source {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      date: null,\n      description: null,\n      notes: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isASourceObject = true;\n  }\n\n  static clone(item) {\n    let c = new Source();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  getDate() {\n    return this.state.date;\n  }\n\n  updateDate(date, force = false) {\n    if (!(date instanceof RoughDate || date._isARoughDateObject)) {\n      date = new RoughDate(date);\n    }\n\n    if (date.isNull()) {\n      return false;\n    }\n\n    if (this.getDate().isNull()) {\n      this.state.date = date;\n      return true;\n    }\n\n    if (RoughDate.ne(this.getDate(), date)) {\n      if (force) {\n        this.state.date = this.getDate().merge(date);\n        return true;\n      } else {\n        console.log(`Disagreement of date for ${this}: ${this.getDate()} vs ${date}`);\n      }\n    }\n\n    return false;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.description = setState(state.description);\n      this.state.notes = setState(state.notes, []);\n      this.state.sources = setState(state.sources, []);\n      this.state.date = setState(state.date, new RoughDate());\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have an Source without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Source(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getDescription() {\n    return this.state.description;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nSource.unDry = function (value) {\n  return new Source(value);\n};\n\nDry.registerClass(\"Source\", Source);\n\nexport default Source;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Source from \"./Source\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_source_uid() {\n  let uid = uuidv4();\n  return \"S\" + uid.substring(uid.length - 7);\n}\n\nclass Sources {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isASourcesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Sources();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n    names.sort();\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  canAdd(item) {\n    return item instanceof Source || item._isASourceObject;\n  }\n\n  add(source) {\n    if (!this.canAdd(source)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(source.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(source);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    source = Source.clone(source);\n\n    let id = source.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Source ID ${source}`);\n      }\n\n      source._updateHooks(this._getHook);\n      this.state.registry[id] = source;\n    } else {\n      let uid = _generate_source_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_source_uid();\n      }\n\n      source.state.id = uid;\n    }\n\n    source._updateHooks(this._getHook);\n    this._names[source.getName()] = source.getID();\n    this.state.registry[source.getID()] = source;\n\n    return source;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      console.error(`No source with name ${name}`);\n    }\n  }\n\n  search(name) {\n    if (name instanceof Source || name._isASourceObject) {\n      name = name.getName();\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let item = this.state.registry[key];\n\n      let description = item.getDescription();\n\n      if (!description) {\n        description = \"\";\n      }\n\n      try {\n        if (item.getName().toLowerCase().indexOf(name) !== -1) {\n          results.push(item);\n        } else if (description.toLowerCase().indexOf(name) !== -1) {\n          results.push(item);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    } else {\n      return null;\n    }\n  }\n\n  find(name) {\n    if (name instanceof Source || name._isASourceObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No source matches '${name}. Available sources are '${keys}'`);\n  }\n\n  get(id) {\n    let source = this.state.registry[id];\n\n    if (!source) {\n      throw new MissingError(`No Source with ID ${id}`);\n    }\n\n    return source;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nSources.unDry = function (value) {\n  let sources = new Sources();\n  sources.state = value;\n  sources._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    sources._names[v.getName()] = key;\n  });\n\n  return sources;\n};\n\nDry.registerClass(\"Sources\", Sources);\n\nexport default Sources;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Note {\n  constructor(props) {\n    this.state = {\n      text: null,\n      id: null,\n      sources: [],\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isANoteObject = true;\n  }\n\n  static clone(item) {\n    let c = new Note();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.text = setState(state.text);\n      this.state.id = setState(state.id);\n      this.state.sources = setState(state.sources, []);\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  toString() {\n    return `Note(${this.getText()})`;\n  }\n\n  getText() {\n    return this.state.text;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nNote.unDry = function (value) {\n  return new Note(value);\n};\n\nDry.registerClass(\"Note\", Note);\n\nexport default Note;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Note from \"./Note\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_note_uid() {\n  let uid = uuidv4();\n  return \"N\" + uid.substring(uid.length - 7);\n}\n\nclass Notes {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isANotesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Notes();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  canAdd(item) {\n    return item instanceof Note || item._isANoteObject;\n  }\n\n  add(note) {\n    if (!this.canAdd(note)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(note.getName());\n    } catch (error) {\n      console.error(error);\n    }\n\n    if (existing) {\n      existing = existing.merge(note);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    note = note.clone(Note);\n\n    let id = note.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Note ID ${note}`);\n      }\n\n      note._updateHooks(this._getHook);\n      this.state.registry[id] = Note;\n    } else {\n      let uid = _generate_note_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_note_uid();\n      }\n\n      note.state.id = uid;\n    }\n\n    note._updateHooks(this._getHook);\n    this._names[note.getName()] = note.getID();\n    this.state.registry[note.getID()] = note;\n\n    return note;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No Note with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Note || name._isANoteObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No Note matches '${name}. Available Notes are '${keys}'`);\n  }\n\n  get(id) {\n    let Note = this.state.registry[id];\n\n    if (!Note) {\n      throw new MissingError(`No Note with ID ${id}`);\n    }\n\n    return Note;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nNotes.unDry = function (value) {\n  let notes = new Notes();\n  notes.state = value;\n  notes._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    notes._names[v.getName()] = key;\n  });\n\n  return notes;\n};\n\nDry.registerClass(\"Notes\", Notes);\n\nexport default Notes;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport DateRange from \"./DateRange\";\nimport { ValueError } from \"./Errors\";\n\nfunction setState(val, def = null) {\n  if (val) {\n    return val;\n  } else {\n    return def;\n  }\n}\n\nclass Project {\n  constructor(props) {\n    this.state = {\n      name: null,\n      id: null,\n      url: null,\n      duration: new DateRange(),\n      notes: {},\n    };\n\n    this.setState(props);\n\n    this._getHook = null;\n    this._isAProjectObject = true;\n  }\n\n  static clone(item) {\n    let c = new Project();\n    c._getHook = item._getHook;\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  getID() {\n    return this.state.id;\n  }\n\n  setState(state) {\n    if (state) {\n      this.state.name = setState(state.name);\n      this.state.id = setState(state.id);\n      this.state.notes = setState(state.notes, {});\n      this.state.url = setState(state.url, null);\n      this.state.duration = new DateRange({ value: state.duration });\n\n      if (!this.state.name) {\n        throw new ValueError(\"You cannot have a Project without a name\");\n      }\n    }\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  merge() {\n    return this;\n  }\n\n  toString() {\n    return `Project(${this.getName()})`;\n  }\n\n  getName() {\n    return this.state.name;\n  }\n\n  getURL() {\n    return this.state.url;\n  }\n\n  getDuration() {\n    return this.state.duration;\n  }\n\n  getTimeLine() {\n    const duration = this.getDuration();\n\n    if (duration && duration.hasBounds()) {\n      return {\n        start: duration.getEarliestStart().toDate(),\n        end: duration.getLatestEnd().toDate(),\n        id: this.getID(),\n        content: this.getName(),\n      };\n    } else {\n      return null;\n    }\n  }\n\n  getNewTimeLine() {\n    const duration = this.getDuration();\n\n    if (duration && duration.hasBounds()) {\n      return {\n        start_time: duration.getEarliestStart().toMoment(),\n        end_time: duration.getLatestEnd().toMoment(),\n        project_id: this.getID(),\n        title: this.getName(),\n      };\n    } else {\n      return null;\n    }\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nProject.unDry = function (value) {\n  return new Project(value);\n};\n\nDry.registerClass(\"Project\", Project);\n\nexport default Project;\n","import Dry from \"json-dry\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport lodash from \"lodash\";\n\nimport Project from \"./Project\";\nimport { KeyError, MissingError } from \"./Errors\";\n\nfunction _generate_project_uid() {\n  let uid = uuidv4();\n  return \"J\" + uid.substring(uid.length - 7);\n}\n\nclass Projects {\n  constructor() {\n    this.state = {\n      registry: {},\n    };\n\n    this._names = {};\n    this._isAProjectsObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n    for (let key in this.state.registry) {\n      this.state.registry[key]._updateHooks(hook);\n    }\n  }\n\n  static clone(item) {\n    let c = new Projects();\n    c.state = lodash.cloneDeep(item.state);\n    c._names = lodash.cloneDeep(item._names);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  values() {\n    let names = Object.keys(this._names);\n\n    let output = [];\n\n    names.forEach((key) => {\n      output.push(this.get(this._names[key]));\n    });\n\n    return output;\n  }\n\n  getNames() {\n    return Object.keys(this._names);\n  }\n\n  getIDs() {\n    return Object.values(this._names);\n  }\n\n  projects() {\n    return this._names;\n  }\n\n  getDetails() {\n    return this._names;\n  }\n\n  canAdd(item) {\n    return item instanceof Project || item._isAProjectObject;\n  }\n\n  add(project) {\n    if (!this.canAdd(project)) {\n      return null;\n    }\n\n    let existing = null;\n\n    try {\n      existing = this.getByName(project.getName());\n    } catch (error) {\n      console.error(\"Cannot get project\", error);\n    }\n\n    if (existing) {\n      existing = existing.merge(project);\n      this.state.registry[existing.getID()] = existing;\n      return existing;\n    }\n\n    project = Project.clone(project);\n\n    let id = project.getID();\n\n    if (id) {\n      if (id in this.state.registry) {\n        throw new KeyError(`Duplicate Project ID ${project}`);\n      }\n\n      project._updateHooks(this._getHook);\n      this.state.registry[id] = project;\n    } else {\n      let uid = _generate_project_uid();\n\n      while (uid in this.state.registry) {\n        uid = _generate_project_uid();\n      }\n\n      project.state.id = uid;\n    }\n\n    project._updateHooks(this._getHook);\n    this._names[project.getName()] = project.getID();\n    this.state.registry[project.getID()] = project;\n\n    return project;\n  }\n\n  getByName(name) {\n    let id = this._names[name];\n\n    if (id) {\n      return this.get(id);\n    } else {\n      throw new MissingError(`No project with name ${name}`);\n    }\n  }\n\n  find(name) {\n    if (name instanceof Project || name._isAProjectObject) {\n      return this.get(name.getID());\n    }\n\n    name = name.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this._names).forEach((key) => {\n      if (key.toLowerCase().indexOf(name) !== -1) {\n        results.push(this.get(this._names[key]));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    }\n\n    let keys = Object.keys(this._names).join(\"', '\");\n\n    throw new MissingError(`No project matches '${name}. Available projects are '${keys}'`);\n  }\n\n  get(id) {\n    let project = this.state.registry[id];\n\n    if (!project) {\n      throw new MissingError(`No Project with ID ${id}`);\n    }\n\n    return project;\n  }\n\n  getTimeLine() {\n    let items = [];\n\n    Object.keys(this.state.registry).forEach((key) => {\n      let project = this.state.registry[key];\n      if (project) {\n        let timeline = project.getTimeLine();\n        if (timeline) {\n          items.push(timeline);\n        }\n      }\n    });\n\n    return items;\n  }\n\n  toDry() {\n    return { value: this.state };\n  }\n}\n\nProjects.unDry = function (value) {\n  let projects = new Projects();\n  projects.state = value;\n  projects._names = {};\n\n  Object.keys(value.registry).forEach((key) => {\n    let v = value.registry[key];\n    projects._names[v.getName()] = key;\n  });\n\n  return projects;\n};\n\nDry.registerClass(\"Projects\", Projects);\n\nexport default Projects;\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nclass Biographies {\n  constructor() {\n    this.state = {\n      bios: {},\n    };\n\n    this._getHook = null;\n    this._isABiographiesObject = true;\n  }\n\n  _updateHooks(hook) {\n    this._getHook = hook;\n  }\n\n  static clone(item) {\n    let c = new Biographies();\n    c.state = lodash.cloneDeep(item.state);\n    c._getHook = item._getHook;\n    return c;\n  }\n\n  get(node) {\n    if (!node) {\n      return null;\n    } else if (node.getID) {\n      node = node.getID();\n    }\n\n    return this.state.bios[node];\n  }\n\n  getByID(id) {\n    if (!id) return null;\n\n    return this.state.bios[id];\n  }\n\n  getNode(id) {\n    if (this._getHook) {\n      return this._getHook(id);\n    } else {\n      return id;\n    }\n  }\n\n  search(text) {\n    if (!text) {\n      return null;\n    }\n\n    text = text.trim().toLowerCase();\n\n    let results = [];\n\n    Object.keys(this.state.bios).forEach((key) => {\n      if (this.state.bios[key].toLowerCase().indexOf(text) !== -1) {\n        results.push(this.getNode(key));\n      }\n    });\n\n    if (results.length === 1) {\n      return results[0];\n    } else if (results.length > 1) {\n      return results;\n    } else {\n      return null;\n    }\n  }\n\n  add(node, biography) {\n    if (!node || !biography) {\n      return null;\n    } else if (node.getID) {\n      node = node.getID();\n    }\n\n    let bio = this.state.bios[node];\n\n    if (bio) {\n      console.log(`There is already a bio for ${this.getNode(node)}`);\n      biography = `${bio}\\n${biography}`;\n    }\n\n    this.state.bios[node] = biography;\n  }\n}\n\nBiographies.unDry = function (value) {\n  let bios = new Biographies();\n  bios.state = value;\n  return bios;\n};\n\nDry.registerClass(\"Biographies\", Biographies);\n\nexport default Biographies;\n","import get_id from \"./get_id\";\n\n/** Score by the weight of each node */\nfunction score_by_weight(nodes, edges, social) {\n  let scores = [];\n\n  for (let i in nodes) {\n    let node = nodes[i];\n    scores.push([node.weight[Object.keys(node.weight)[0]], i]);\n  }\n\n  scores.sort((x, y) => {\n    return y[0] - x[0];\n  });\n\n  for (let i in scores) {\n    nodes[scores[i][1]].sort_index = i;\n  }\n}\n\n/** Score by the number of connections only */\nfunction score_by_connections(nodes, edges, social) {\n  let counts = {};\n\n  let add_count = (id) => {\n    // ensures x == 1 if id doesn't exist in counts\n    let x = (counts[id] || 0) + 1;\n    counts[id] = x;\n  };\n\n  for (let i in edges) {\n    add_count(edges[i].source);\n    add_count(edges[i].target);\n  }\n\n  let scores = [];\n\n  for (let i in nodes) {\n    let node = nodes[i];\n    let node_id = get_id(node);\n    let score = 0.0;\n\n    if (counts[node_id]) {\n      score += counts[node_id];\n    }\n\n    scores.push([score, i]);\n  }\n\n  // sort the scores such that the most connected nodes are first\n  scores.sort((x, y) => {\n    return y[0] - x[0];\n  });\n\n  for (let i in scores) {\n    nodes[scores[i][1]].sort_index = i;\n  }\n}\n\n/** Score the passed nodes using the number of connections and their\n *  relationship to the anchor node\n */\nfunction score_by_connections_to_anchor(nodes, edges, social) {\n  let connections = social.getConnections();\n\n  let counts = {};\n\n  let add_count = (id) => {\n    // ensures x == 1 if id doesn't exist in counts\n    let x = (counts[id] || 0) + 1;\n    counts[id] = x;\n  };\n\n  for (let i in edges) {\n    add_count(edges[i].source);\n    add_count(edges[i].target);\n  }\n\n  let scores = [];\n\n  let anchor = social.getAnchor();\n  let anchor_id = get_id(anchor);\n\n  for (let i in nodes) {\n    let node = nodes[i];\n    let node_id = get_id(node);\n    let score = 0.0;\n\n    if (node_id === anchor_id) {\n      score += 1000000.0;\n    }\n\n    if (connections.areConnected(anchor_id, node_id)) {\n      score += 50000.0;\n    }\n\n    if (counts[node_id]) {\n      score += counts[node_id];\n    }\n\n    scores.push([score, i]);\n  }\n\n  // sort the scores such that the most connected nodes are first\n  scores.sort((x, y) => {\n    return y[0] - x[0];\n  });\n\n  for (let i in scores) {\n    nodes[scores[i][1]].sort_index = i;\n  }\n}\n\nexport {\n  score_by_connections as default,\n  score_by_connections,\n  score_by_connections_to_anchor,\n  score_by_weight\n};\n","import Dry from \"json-dry\";\nimport lodash from \"lodash\";\n\nimport People from \"./People\";\nimport Businesses from \"./Businesses\";\nimport Connections from \"./Connections\";\nimport Positions from \"./Positions\";\nimport Affiliations from \"./Affiliations\";\nimport Sources from \"./Sources\";\nimport Notes from \"./Notes\";\nimport Projects from \"./Projects\";\nimport Biographies from \"./Biographies\";\nimport DateRange from \"./DateRange\";\nimport get_id from \"./get_id\";\n\nimport score_by_connections from \"./ScoringFunctions\";\n\nimport {\n  ValueError\n} from \"./Errors\";\n\nconst fast_physics = {\n  enabled: true,\n  timestep: 0.5,\n};\n\nconst slow_physics = {\n  ...fast_physics\n};\nslow_physics.timestep = 0.1;\n\nfunction _push(values, list) {\n  if (!list || !values) {\n    return;\n  }\n\n  if (values.length) {\n    for (let i = 0; i < values.length; ++i) {\n      list.push(values[i]);\n    }\n  } else {\n    list.push(values);\n  }\n}\n\nclass Social {\n  constructor(props) {\n    if (props) {\n      this.state = props;\n    } else {\n      this.state = {};\n    }\n\n    this.state.anchor = null;\n    this.state.filter = {};\n    this.state.cache = {\n      graph: null,\n      projectTimeLine: null,\n      itemTimeLine: null,\n      node_filters: null,\n      edge_filters: null,\n      people: null,\n      businesses: null,\n      connections: null,\n    };\n    this.state.window = new DateRange();\n    this.state.max_window = new DateRange();\n    this.state.scoring_function = score_by_connections;\n    this._rebuilding = 0;\n\n    this._isASocialObject = true;\n  }\n\n  static clone(item) {\n    let c = new Social();\n    c.state = lodash.cloneDeep(item.state);\n    return c;\n  }\n\n  _updateHooks() {\n    let getHook = (id) => {\n      return this.get(id);\n    };\n\n    let state = {\n      ...this.state\n    };\n\n    if (!(this.state.people instanceof People)) {\n      state.people = new People();\n    } else {\n      state.people = this.state.people;\n    }\n\n    if (!(this.state.businesses instanceof Businesses)) {\n      state.businesses = new Businesses();\n    } else {\n      state.businesses = this.state.businesses;\n    }\n\n    if (!(this.state.connections instanceof Connections)) {\n      state.connections = new Connections();\n    } else {\n      state.connections = this.state.connections;\n    }\n\n    if (!(this.state.positions instanceof Positions)) {\n      state.positions = new Positions();\n    } else {\n      state.positions = this.state.positions;\n    }\n\n    if (!(this.state.affiliations instanceof Affiliations)) {\n      state.affiliations = new Affiliations();\n    } else {\n      state.affiliations = this.state.affiliations;\n    }\n\n    if (!(this.state.sources instanceof Sources)) {\n      state.sources = new Sources();\n    } else {\n      state.sources = this.state.sources;\n    }\n\n    if (!(this.state.notes instanceof Notes)) {\n      state.notes = new Notes();\n    } else {\n      state.notes = this.state.notes;\n    }\n\n    if (!(this.state.projects instanceof Projects)) {\n      state.projects = new Projects();\n    } else {\n      state.projects = this.state.projects;\n    }\n\n    if (!(this.state.biographies instanceof Biographies)) {\n      state.biographies = new Biographies();\n    } else {\n      state.biographies = this.state.biographies;\n    }\n\n    this.state = state;\n\n    for (let key in this.state) {\n      try {\n        this.state[key]._updateHooks(getHook);\n      } catch (error) {\n        // console.error(\"For key : \", key, \"\\nError: \", error);\n      }\n    }\n  }\n\n  clearCache() {\n    this.state.cache = {\n      graph: null,\n      projectTimeLine: null,\n      itemTimeLine: null,\n      node_filters: null,\n      edge_filters: null,\n      people: null,\n      businesses: null,\n      connections: null,\n    };\n    this._rebuilding = 0;\n  }\n\n  getNodeFilters() {\n    if (this.state.cache.node_filters) {\n      return this.state.cache.node_filters;\n    }\n\n    this._rebuilding += 1;\n    this.state.cache.node_filters = [];\n\n    // Must do time first, as this can affect all of the other filters!\n    let window = this.getWindow();\n\n    if (window.hasStart() || window.hasEnd()) {\n      this.state.cache.node_filters.push((item) => {\n        try {\n          return item.filterWindow(window);\n        } catch (error) {\n          console.log(`ERROR ${error}: ${item}`);\n          return item;\n        }\n      });\n    }\n\n    const project_filter = this.state.filter.project;\n\n    if (project_filter) {\n      this.state.cache.node_filters.push((item) => {\n        return item.filterProject(project_filter);\n      });\n    }\n\n    const source_filter = this.state.filter.source;\n\n    if (source_filter) {\n      this.state.cache.node_filters.push((item) => {\n        return item.filterSource(source_filter);\n      });\n    }\n\n    const node_filter = this.state.filter.node;\n\n    if (node_filter) {\n      let connections = this.getConnectionsTo(node_filter);\n      let filter = {\n        ...node_filter\n      };\n\n      for (let connection in connections) {\n        let node = connections[connection];\n        filter[get_id(node)] = 1;\n      }\n\n      this.state.cache.node_filters.push((item) => {\n        if (get_id(item) in filter) {\n          return item;\n        } else {\n          return null;\n        }\n      });\n    }\n\n    const group_filter = this.state.filter.group;\n\n    if (group_filter) {\n      this.state.cache.node_filters.push((item) => {\n        try {\n          if (item.inGroup(group_filter)) {\n            return item;\n          } else {\n            return null;\n          }\n        } catch (error) {\n          console.log(`Filter error: ${error}`);\n          return item;\n        }\n      });\n    }\n\n    this._rebuilding -= 1;\n    return this.state.cache.node_filters;\n  }\n\n  getEdgeFilters() {\n    if (!this.state.cache.edge_filters) {\n      this.state.cache.edge_filters = [];\n\n      // must do time first, as this can affect all of the other filters!\n      let window = this.getWindow();\n\n      if (window.hasStart() || window.hasEnd()) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterWindow(window);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n\n      const project_filter = this.state.filter.project;\n\n      if (project_filter) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterProject(project_filter);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n\n      const source_filter = this.state.filter.source;\n\n      if (source_filter) {\n        this.state.cache.edge_filters.push((item) => {\n          try {\n            return item.filterSource(source_filter);\n          } catch (error) {\n            console.log(`ERROR ${error}: ${item}`);\n            return item;\n          }\n        });\n      }\n    }\n\n    return this.state.cache.edge_filters;\n  }\n\n  getWindow() {\n    return this.state.window;\n  }\n\n  getMaxWindow() {\n    return this.state.max_window;\n  }\n\n  _fitWindow(window) {\n    let new_window = this.state.max_window.intersect(window);\n\n    let delta = window.getDelta();\n\n    if (new_window && new_window.getDelta() === delta) {\n      return window;\n    }\n\n    if (delta > this.state.max_window.getDelta()) {\n      return DateRange.clone(this.state.max_window);\n    }\n\n    if (window.getStartDate() < this.state.max_window.getStartDate()) {\n      return new DateRange({\n        start: this.state.max_window.getStartDate(),\n        end: this.state.max_window.getStartDate() + delta,\n      });\n    } else {\n      return new DateRange({\n        start: this.state.max_window.getEndDate() - delta,\n        end: this.state.max_window.getEndDate(),\n      });\n    }\n  }\n\n  setMaxWindow(window) {\n    if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (window === this.state.max_window) {\n      return;\n    }\n\n    this.state.max_window = window;\n\n    if (this.state.window && this.state.window.hasBounds()) {\n      let fitted = this._fitWindow(this.state.window);\n\n      if (fitted !== this.state.window) {\n        this.setWindow(fitted);\n      }\n    } else {\n      this.state.window = this.state.max_window;\n    }\n  }\n\n  setWindow(window) {\n    if (!window._isADateRangeObject) {\n      window = new DateRange(window);\n    }\n\n    if (DateRange.eq(window, this.state.window)) {\n      return false;\n    }\n\n    let fitted = this._fitWindow(window);\n\n    if (DateRange.eq(fitted, this.state.window)) {\n      return false;\n    }\n\n    this.state.window = fitted;\n    this.clearCache();\n    return true;\n  }\n\n  getPeople(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.people) {\n        // console.log(\"REBUILD PEOPLE\");\n        this._rebuilding += 1;\n        this.state.cache.people = this.state.people.filter(this.getNodeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.people;\n    } else {\n      return this.state.people;\n    }\n  }\n\n  getBusinesses(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.businesses) {\n        // console.log(\"REBUILD BUSINESSES\");\n        this._rebuilding += 1;\n        this.state.cache.businesses = this.state.businesses.filter(this.getNodeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.businesses;\n    } else {\n      return this.state.businesses;\n    }\n  }\n\n  getConnections(filtered = true) {\n    if (this._rebuilding) {\n      filtered = false;\n    }\n\n    if (filtered) {\n      if (!this.state.cache.connections) {\n        // console.log(\"REBUILD CONNECTIONS\");\n        this._rebuilding += 1;\n        this.state.cache.connections = this.state.connections.filter(this.getEdgeFilters());\n        this._rebuilding -= 1;\n      }\n\n      return this.state.cache.connections;\n    } else {\n      return this.state.connections;\n    }\n  }\n\n  getBiographies() {\n    return this.state.biographies;\n  }\n\n  getAffiliations() {\n    return this.state.affiliations;\n  }\n\n  getPositions() {\n    return this.state.positions;\n  }\n\n  getSources() {\n    return this.state.sources;\n  }\n\n  getNotes() {\n    return this.state.notes;\n  }\n\n  getProjects() {\n    return this.state.projects;\n  }\n\n  getConnectionsTo(item) {\n    return this.getConnections().getConnectionsTo(item);\n  }\n\n  getAnchor() {\n    return this.state.anchor;\n  }\n\n  getFilter() {\n    return {\n      ...this.state.filter\n    };\n  }\n\n  getFilterText() {\n    const filter = [];\n\n    let f = this.state.filter.node;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`connected to ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`connected to (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.source;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`with source ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`with sources (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.group;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`in group ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`in groups (${parts.join(\" and \")})`);\n      }\n    }\n\n    f = this.state.filter.project;\n\n    if (f) {\n      let parts = [];\n\n      Object.keys(f).forEach((key) => {\n        parts.push(this.get(key, false).getName());\n      });\n\n      parts.sort();\n\n      if (parts.length === 1) {\n        filter.push(`in project ${parts[0]}`);\n      } else if (parts.length > 1) {\n        filter.push(`in projects (${parts.join(\" and \")})`);\n      }\n    }\n\n    if (filter.length === 1) {\n      return filter[0];\n    } else if (filter.length > 1) {\n      return `[${filter.join(\"] and [\")}]`;\n    } else {\n      return null;\n    }\n  }\n\n  _getType(item) {\n    item = get_id(item);\n\n    if (item[0] === \"P\" || item[0] === \"B\") {\n      return \"node\";\n    } else if (item[0] === \"J\") {\n      return \"project\";\n    } else if (item[0] === \"S\") {\n      return \"source\";\n    } else {\n      return \"group\";\n    }\n  }\n\n  isFiltered(item) {\n    item = get_id(item);\n\n    let type = this._getType(item);\n\n    const filter = this.state.filter[type];\n\n    if (filter) {\n      return item in filter;\n    } else {\n      return false;\n    }\n  }\n\n  find(text) {\n    let result = [];\n\n    try {\n      let items = this.getPeople(false).find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getBusinesses(false).find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getPositions().find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getAffiliations().find(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getSources().search(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    try {\n      let items = this.getBiographies().search(text);\n      _push(items, result);\n    } catch (error) {\n      console.error(error);\n    }\n\n    return result;\n  }\n\n  resetAllFilters() {\n    this.state.filter = {};\n    this.clearCache();\n  }\n\n  resetFiltersNotShip() {\n    const projectFilter = this.state.filter[\"project\"];\n    this.state.filter = {};\n    this.state.filter[\"project\"] = projectFilter;\n    this.clearCache();\n  }\n\n  setAnchor(anchor) {\n    if (anchor) {\n      anchor = this.getPeople().find(anchor);\n    }\n\n    this.state.anchor = anchor;\n    this.clearCache();\n  }\n\n  toggleFilter(items) {\n    if (!Array.isArray(items)) {\n      items = [items];\n    }\n\n    for (let item of items) {\n      item = get_id(item);\n\n      let type = this._getType(item);\n\n      if (!(type in this.state.filter)) {\n        this.state.filter[type] = {};\n      }\n\n      if (item in this.state.filter[type]) {\n        delete this.state.filter[type][item];\n\n        if (Object.keys(this.state.filter[type]).length === 0) {\n          delete this.state.filter[type];\n        }\n      } else {\n        this.state.filter[type][item] = 1;\n      }\n    }\n\n    this.clearCache();\n  }\n\n  setFilters(...args) {\n    for (let items of args) {\n      if (!Array.isArray(items)) {\n        items = [items];\n      }\n\n      for (let item of items) {\n        item = get_id(item);\n\n        let type = this._getType(item);\n\n        if (!(type in this.state.filter)) {\n          this.state.filter[type] = {};\n        }\n\n        this.state.filter[type][item] = 1;\n      }\n    }\n\n    this.clearCache();\n  }\n\n  clearFilters(...args) {\n    for (let items of args) {\n      if (!Array.isArray(items)) {\n        items = [items];\n      }\n\n      for (let item of items) {\n        item = get_id(item);\n\n        let type = this._getType(item);\n\n        if (item in this.state.filter[type]) {\n          delete this.state.filter[type][item];\n\n          if (Object.keys(this.state.filter[type]).length === 0) {\n            delete this.state.filter[type];\n          }\n        }\n      }\n    }\n\n    this.clearCache();\n  }\n\n  toggleNodeFilter(nodes) {\n    this.toggleFilter(nodes);\n  }\n\n  clearProjectFilter() {\n    this.state.filter[\"project\"] = {};\n  }\n\n  toggleProjectFilter(project) {\n    if (!(\"project\" in this.state.filter)) {\n      this.state.filter[\"project\"] = {};\n    }\n\n    if (project in this.state.filter[\"project\"]) {\n      delete this.state.filter[\"project\"][project];\n    } else {\n      this.state.filter[\"project\"][project] = 1;\n    }\n  }\n\n  getProjectTimeLine() {\n    if (this.state.cache.projectTimeLine !== null) {\n      return this.state.cache.projectTimeLine;\n    }\n\n    let items = this.getProjects().getTimeLine();\n\n    this.state.cache.projectTimeLine = items;\n\n    return this.state.cache.projectTimeLine;\n  }\n\n  getItemTimeLine() {\n    if (this.state.cache.itemTimeLine !== null) {\n      return this.state.cache.itemTimeLine;\n    }\n\n    let items = this.getPeople().getTimeLine();\n\n    let projects = this.getProjects().getTimeLine();\n\n    projects.forEach((item) => {\n      item.type = \"background\";\n      items.push(item);\n    });\n\n    this.state.cache.itemTimeLine = items;\n\n    return this.state.cache.itemTimeLine;\n  }\n\n  /** Set the scoring function used to order the nodes */\n  setScoringFunction(func) {\n    if (func !== this.state.scoring_function) {\n      this.state.scoring_function = func;\n      this.clearCache();\n    }\n  }\n\n  /** Return the scoring function that should be used to order the\n   *  nodes in any ordered graph\n   */\n  getScoringFunction() {\n    return this.state.scoring_function;\n  }\n\n  /** Return the graph of nodes and edges that will be displayed by\n   *  the app. This should apply all of the filters and only return\n   *  the nodes and edges that should be visible. It should also\n   *  apply the indexing function so that the index of the nodes\n   *  show their sorted order according to the primary criterion\n   */\n  getGraph() {\n    if (this.state.cache.graph !== null) {\n      return this.state.cache.graph;\n    }\n\n    const anchor = this.state.anchor;\n    let nodes = this.getPeople().getNodes({\n      anchor: anchor\n    });\n    nodes = nodes.concat(this.getBusinesses().getNodes());\n\n    let n = {};\n    for (let i in nodes) {\n      n[get_id(nodes[i])] = 1;\n    }\n\n    let edges = this.getConnections().getEdges(n);\n\n    let scoring_function = this.getScoringFunction();\n\n    if (!scoring_function) {\n      scoring_function = score_by_connections;\n    }\n\n    scoring_function(nodes, edges, this);\n\n    this.state.cache.graph = {\n      nodes: nodes,\n      edges: edges\n    };\n    return this.state.cache.graph;\n  }\n\n  add(item) {\n    if (!item) {\n      return;\n    }\n\n    let added = false;\n\n    Object.keys(this.state).forEach((key) => {\n      if (!added) {\n        let group = this.state[key];\n        if (group && group.canAdd) {\n          if (group.canAdd(item)) {\n            group.add(item);\n            added = true;\n          }\n        }\n      }\n    });\n\n    if (!added) {\n      throw new ValueError(`Do not know how to add ${item} to this Social group`);\n    }\n  }\n\n  get(id, filtered = true) {\n    id = get_id(id);\n\n    if (this._rebuilding) {\n      // we cannot get filtered data when rebuilding, else otherwise\n      // we get race conditions and weird results\n      filtered = false;\n    }\n\n    try {\n      if (id[0] === \"C\") {\n        return this.getConnections(filtered).get(id);\n      } else if (id[0] === \"P\") {\n        return this.getPeople(filtered).get(id);\n      } else if (id[0] === \"B\") {\n        return this.getBusinesses(filtered).get(id);\n      } else if (id[0] === \"Q\") {\n        return this.getPositions().get(id);\n      } else if (id[0] === \"A\") {\n        return this.getAffiliations().get(id);\n      } else if (id[0] === \"S\") {\n        return this.getSources().get(id);\n      } else if (id[0] === \"N\") {\n        return this.getNotes().get(id);\n      } else if (id[0] === \"J\") {\n        return this.getProjects().get(id);\n      } else {\n        return id;\n      }\n    } catch (error) {\n      if (filtered) {\n        return this.get(id, false);\n      } else {\n        throw error;\n      }\n    }\n  }\n\n  toDry() {\n    return {\n      value: this.state\n    };\n  }\n}\n\nSocial.unDry = function (value) {\n  let social = new Social(value);\n  social._updateHooks();\n\n  return social;\n};\n\nDry.registerClass(\"Social\", Social);\n\nexport default Social;","// package imports\nimport React from \"react\";\nimport Dry from \"json-dry\";\n\n// Brunel components\nimport AboutOverlay from \"./components/AboutOverlay\";\nimport AnalysisPanel from \"./components/AnalysisPanel\";\nimport ForceGraph from \"./components/ForceGraph\";\nimport HowDoIOverlay from \"./components/HowDoIOverlay\";\nimport TimeLineBox from \"./components/TimeLineBox\";\nimport FilterBox from \"./components/FilterBox\";\nimport SlidingPanel from \"./components/SlidingPanel\";\nimport ShipSelector from \"./components/ShipSelector\";\nimport ShipTitle from \"./components/ShipTitle\";\nimport SearchOverlay from \"./components/SearchOverlay\";\nimport TextButton from \"./components/TextButton\";\nimport Overlay from \"./components/Overlay\";\n\n// Brunel model\nimport Social from \"./model/Social\";\n\n// Data for import\nimport graphData from \"./socialNetwork.json\";\nimport positionGroups from \"./data/positionGroups.json\";\n\n// Styling for the app\nimport styles from \"./SocialApp.module.css\";\nimport DateRange from \"./model/DateRange\";\nimport {\n  score_by_connections_to_anchor,\n  score_by_connections,\n  score_by_weight\n} from \"./model/ScoringFunctions\";\n\nclass SocialApp extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.togglePhysicsEnabled = this.togglePhysicsEnabled.bind(this);\n    this.resetAllFilters = this.resetAllFilters.bind(this);\n    this.setOverlay = this.setOverlay.bind(this);\n    this.toggleOverlay = this.toggleOverlay.bind(this);\n    this.closeOverlay = this.closeOverlay.bind(this);\n\n    // Load in the Dried graph data from JSON\n    let social = Dry.parse(graphData);\n\n    if (!(social instanceof Social)) {\n      console.error(\"Could not parse!\");\n      social = new Social();\n    }\n\n    // Special cases for Brunel project...\n    social.setAnchor(\"Brunel\");\n    social.setMaxWindow(new DateRange({ start: \"1800-01-01\", end: \"1860-12-31\" }));\n\n    this.state = {\n      social: social,\n      highlighted_item: null,\n      selected_item: null,\n      overlayItem: null,\n      isInfoPanelOpen: false,\n      isTimeLinePanelOpen: false,\n      isFilterPanelOpen: false,\n      isHamburgerMenuOpen: false,\n      isSearchOverlayOpen: false,\n      indirectConnectionsVisible: false,\n      unconnectedNodesVisible: false,\n      commercialFiltered: false,\n      engineersFiltered: false,\n      simulationType: \"Spiral\",\n      spiralOrder: \"Brunel\",\n      commericalNodeFilter: [],\n      engineerNodeFilter: [],\n      connectedNodes: null,\n      timeline: new TimeLineBox(),\n      isOverlayOpen: false,\n      isAnalysisOpen: false,\n      physicsEnabled: false,\n      selectedShip: null,\n      selectedShipID: null,\n    };\n\n    // TODO - work out a cleaner way of doing this\n    // Is set in ShipSelector correctly\n    const ssGW = social.getProjects().getByName(\"SS Great Western\");\n    this.state.selectedShip = ssGW.getName();\n    this.state.selectedShipID = ssGW.getID();\n\n    this.simulationTypes = Object.freeze({\n      Gravity: 1,\n      Filtered: 1,\n      Structured: 1,\n      Spiral: 1\n    });\n\n    this.spiralOrders = Object.freeze({\n      \"Brunel\": score_by_connections_to_anchor,\n      \"Connections\": score_by_connections,\n      \"Weight\": score_by_weight\n    });\n\n    // Find the investors and engineers for easy filtering\n    // This requires the\n    this.findInvestorsAndEngineers();\n\n    // Find the unconnected nodes for filtering\n    this.findConnectedNodes();\n\n    // Hide the unconnected nodes\n    this.state.social.toggleFilter(this.state.connectedNodes[this.state.selectedShipID]);\n    this.state.social.setScoringFunction(this.spiralOrders[this.state.spiralOrder]);\n    this.state.unconnectedNodesVisible = false;\n\n    this.socialGraph = null;\n  }\n\n  resetAllFilters() {\n    // This resets all filters including the ship filter\n    let social = this.state.social;\n    social.resetAllFilters();\n    this.setState({\n      social: social,\n      engineersFiltered: false,\n      commercialFiltered: false,\n      unconnectedNodesVisible: !this.state.unconnectedNodesVisible,\n    });\n  }\n\n  resetFiltersNotShip() {\n    // This resets all filters except the ship filter\n    let social = this.state.social;\n    social.resetFiltersNotShip();\n    this.setState({\n      social: social,\n      engineersFiltered: false,\n      commercialFiltered: false,\n      unconnectedNodesVisible: !this.state.unconnectedNodesVisible,\n    });\n  }\n\n  closePanels() {\n    this.setState({\n      isInfoPanelOpen: false,\n      isTimeLinePanelOpen: false,\n      isHamburgerMenuOpen: false,\n      isFilterPanelOpen: false,\n      isAnalysisOpen: false,\n      highlighted_item: null,\n    });\n  }\n\n  closeOverlay() {\n    this.setState({\n      isOverlayOpen: false,\n      overlayItem: null,\n    });\n  }\n\n  showInfo(item) {\n    if (item._isAProjectObject) {\n      this.setState({\n        overlayItem: item,\n        isOverlayOpen: true,\n      });\n    } else {\n      this.setState({\n        selected_item: item,\n        isInfoPanelOpen: true,\n      });\n    }\n  }\n\n  slotSetShip(item) {\n    if (!item._isAProjectObject) {\n      console.error(\"Cannot set item that is not a project.\");\n      return;\n    }\n\n    this.setState({ selectedShip: item.getName(), selectedShipID: item.getID() });\n    this.slotToggleFilter(item);\n  }\n\n  slotSetFilterbyID(id, name) {\n    // this.resetAllFilterss();\n    this.setState({ selectedShip: name, selectedShipID: id });\n    this.slotToggleFilter(id);\n  }\n\n  slotToggleProjectFilter(project) {\n    let social = this.state.social;\n    social.toggleProjectFilter(project);\n\n    this.setState({ social: social });\n  }\n\n  slotToggleFilter(item) {\n    if (!item) {\n      return;\n    }\n\n    let social = this.state.social;\n\n    // This feels clunky, is there a cleaner way of doing this?\n    // Currently we only want one ship selectable at a time\n    if (item._isAProjectObject) {\n      social.clearProjectFilter();\n    }\n\n    social.toggleFilter(item);\n\n    this.setState({ social: social });\n  }\n\n  slotSetFilters(...args) {\n    let social = this.state.social;\n    social.setFilters(...args);\n    this.setState({ social: social });\n  }\n\n  slotClearFilters(...args) {\n    let social = this.state.social;\n    social.clearFilters(...args);\n    this.setState({ social: social });\n  }\n\n  slotHighlighted(id) {\n    if (!id) {\n      return;\n    }\n\n    if (id._isADateRangeObject) {\n      return;\n    }\n\n    this.setState({ highlighted_item: id });\n  }\n\n  slotSelected(id) {\n    if (!id) {\n      this.closePanels();\n      return;\n    }\n\n    if (id._isADateRangeObject) {\n      let social = this.state.social;\n      if (social.setWindow(id)) {\n        this.setState({ social: social });\n      }\n      return;\n    }\n\n    const social = this.state.social;\n    const item = social.get(id);\n    this.showInfo(item);\n  }\n\n  slotWindowChanged(window) {\n    let social = this.state.social;\n\n    if (social.setWindow(window)) {\n      this.setState({ social: social });\n    }\n  }\n\n  hasConnections(entity) {\n    return this.state.social.getConnections().gotConnections(entity.id);\n    // const shipID = this.state.selectedShipID;\n    // try {\n    //   if (entity[\"edge_count\"][shipID] > 0) {\n    //     return true;\n    //   } else {\n    //     return false;\n    //   }\n    //   // We might not have an edge count for this ship\n    // } catch (error) {\n    //   return false;\n    // }\n  }\n\n  findInvestorsAndEngineers() {\n    // Creates a list of the IDs of all the nodes that belong to the commercial\n    // side of the projects\n    const people = this.state.social.getPeople(false).getRegistry();\n    const businesses = this.state.social.getBusinesses(false).getRegistry();\n\n    this.findAndGroupNodes(people);\n    this.findAndGroupNodes(businesses);\n  }\n\n  findAndGroupNodes(entities) {\n    // Add nodes to the commercial or engineering groups\n    let commericalNodeFilter = this.state.commericalNodeFilter;\n    let engineerNodeFilter = this.state.engineerNodeFilter;\n\n    const social = this.state.social;\n\n    for (const [id, entity] of Object.entries(entities)) {\n      // Should do this for each ship\n      for (const shipID of social.getProjects().getIDs()) {\n        // Lookup named position, here we'll only use the first position\n        // As each person may not have a role in every ship catch the error here\n        let positionID;\n        try {\n          positionID = entity.getPosition(shipID)[0];\n        } catch (error) {\n          continue;\n        }\n\n        // Trim any extra characters or whitespace from the position string\n        const namedPosition = social\n          .getPositions()\n          .getNameByID(positionID)\n          .toLowerCase()\n          .replace(/\\s/g, \"\")\n          .replace(/[.,/#!$%^&*;:{}=\\-_`~()]/g, \"\");\n\n        // Here we need to check if they've already been saved to stop double counting\n        if (positionGroups[\"commercial\"][\"members\"].includes(namedPosition)) {\n          if (!commericalNodeFilter.includes(id)) {\n            commericalNodeFilter.push(id);\n          }\n        }\n\n        if (positionGroups[\"engineering\"][\"members\"].includes(namedPosition)) {\n          if (!engineerNodeFilter.includes(id)) {\n            engineerNodeFilter.push(id);\n          }\n        }\n      }\n    }\n  }\n\n  findConnectedNodes() {\n    // Loop through and find the connected nodes and create a list of them\n    let connectedNodes = {};\n    let unconnectedNodes = {};\n\n    // This should be updated to properly count the number of unconnected nodes per ship\n    const shipIDs = this.state.social.getProjects().projects();\n\n    for (const shipID of Object.values(shipIDs)) {\n      let connected = [];\n      let unconnected = [];\n\n      const people = this.state.social.getPeople(false).getNodes(\"noanchor\");\n\n      for (const p of people) {\n        if (this.hasConnections(p)) {\n          connected.push(p.id);\n        } else {\n          unconnected.push(p.id);\n        }\n      }\n\n      const businesses = this.state.social.getBusinesses(false).getNodes(\"noanchor\");\n\n      for (const b of businesses) {\n        if (this.hasConnections(b)) {\n          connected.push(b.id);\n        } else {\n          unconnected.push(b.id);\n        }\n      }\n\n      connectedNodes[shipID] = connected;\n      unconnectedNodes[shipID] = unconnected;\n    }\n\n    // This function only called from within ctor so need to set directly here\n    /* eslint-disable react/no-direct-mutation-state */\n    this.state.connectedNodes = connectedNodes;\n    this.state.unconnectedNodes = unconnectedNodes;\n    /* eslint-enable react/no-direct-mutation-state */\n  }\n\n  toggleUnconnectedNodesVisible() {\n    this.slotToggleFilter(this.state.connectedNodes[this.state.selectedShipID]);\n    this.setState({ unconnectedNodesVisible: !this.state.unconnectedNodesVisible });\n  }\n\n  toggleSimulationType() {\n    const simType = this.state.simulationType;\n\n    if (simType === \"Gravity\") {\n      this.setSimulationType(\"Spiral\");\n    } else if (simType === \"Spiral\") {\n      this.setSimulationType(\"Structured\");\n    } else if (simType === \"Structured\") {\n      this.setSimulationType(\"Gravity\");\n    }\n  }\n\n  toggleSpiralOrder() {\n    const order = this.state.spiralOrder;\n\n    if (order === \"Brunel\") {\n      this.setSpiralOrder(\"Connections\");\n    } else if (order === \"Connections\") {\n      this.setSpiralOrder(\"Weight\");\n    } else if (order === \"Weight\") {\n      this.setSpiralOrder(\"Brunel\");\n    }\n  }\n\n  setSpiralOrder(order) {\n    if (order in this.spiralOrders) {\n      if (this.state.spiralOrder !== order) {\n        let social = this.state.social;\n        social.setScoringFunction(this.spiralOrders[order]);\n        this.setState({\n          social: social,\n          spiralOrder: order\n        });\n      }\n    } else {\n      console.error(\"Invalid spiral order, valid orders are \", Object.keys(this.spiralOrders));\n    }\n  }\n\n  setSimulationType(simType) {\n    if (simType in this.simulationTypes) {\n      this.setState({ simulationType: simType });\n    } else {\n      console.error(\"Invalid simulation type, valid types are \", Object.keys(this.simulationTypes));\n    }\n  }\n\n  // If unconnected nodes are enabled add them to the filter, if they're not remove them\n  filterEngineeringNodes() {\n    if (this.state.commercialFiltered) {\n      this.filterCommercialNodes();\n    }\n\n    if (this.state.engineersFiltered) {\n      this.resetFiltersNotShip();\n      this.toggleUnconnectedNodesVisible();\n    } else {\n      this.resetFiltersNotShip();\n      // If we have unconnected nodes as part of this filter set, get rid of them\n      const nodesToFilter = this.state.engineerNodeFilter.filter(\n        (v) => !this.state.unconnectedNodes[this.state.selectedShipID].includes(v)\n      );\n      this.slotToggleFilter(nodesToFilter);\n    }\n\n    this.setState({ engineersFiltered: !this.state.engineersFiltered });\n  }\n\n  filterCommercialNodes() {\n    if (this.state.engineersFiltered) {\n      this.filterEngineeringNodes();\n    }\n\n    if (this.state.commercialFiltered) {\n      this.resetFiltersNotShip();\n      this.toggleUnconnectedNodesVisible();\n    } else {\n      this.resetFiltersNotShip();\n      // If we have unconnected nodes as part of this filter set, get rid of them\n      const nodesToFilter = this.state.commericalNodeFilter.filter(\n        (v) => !this.state.unconnectedNodes[this.state.selectedShipID].includes(v)\n      );\n      this.slotToggleFilter(nodesToFilter);\n    }\n\n    this.setState({ commercialFiltered: !this.state.commercialFiltered });\n  }\n\n  toggleInfoPanel() {\n    this.setState({ isInfoPanelOpen: !this.state.isInfoPanelOpen });\n  }\n\n  toggleTimeLinePanel() {\n    this.setState({\n      isFilterPanelOpen: false,\n      isTimeLinePanelOpen: !this.state.isTimeLinePanelOpen,\n    });\n  }\n\n  toggleFilterPanel() {\n    this.setState({\n      isTimeLinePanelOpen: false,\n      isFilterPanelOpen: !this.state.isFilterPanelOpen,\n    });\n  }\n\n  toggleAnalysisPanel() {\n    this.setState({ isAnalysisOpen: !this.state.isAnalysisOpen });\n  }\n\n  toggleSearchOverlay() {\n    this.setState({ isSearchOverlayOpen: !this.state.isSearchOverlayOpen });\n  }\n\n  togglePhysicsEnabled() {\n    this.setState({ physicsEnabled: !this.state.physicsEnabled });\n  }\n\n  toggleindirectConnectionsVisible() {\n    this.setState({ indirectConnectionsVisible: !this.state.indirectConnectionsVisible });\n  }\n\n  setOverlay(item) {\n    this.setState({\n      overlayItem: item,\n      isOverlayOpen: true,\n    });\n  }\n\n  toggleOverlay() {\n    this.setState({ isOverlayOpen: !this.state.isOverlayOpen });\n  }\n\n  resetAll() {\n    window.location.reload(true);\n  }\n\n  render() {\n    const selected = this.state.selected_item;\n    const highlighted = this.state.highlighted_item;\n    const social = this.state.social;\n    let searchOverlay = null;\n\n    if (this.state.isSearchOverlayOpen) {\n      searchOverlay = (\n        <SearchOverlay\n          social={social}\n          toggleSearchOverlay={() => this.toggleSearchOverlay()}\n          emitSelected={(item) => {\n            this.slotSelected(item);\n          }}\n          emitHighlighted={(item) => {\n            this.slotHighlighted(item);\n          }}\n          emitClicked={(item) => {\n            this.slotClicked(item);\n          }}\n          selectedShipID={this.state.selectedShipID}\n        />\n      );\n    }\n\n    let overlay = null;\n    if (this.state.isOverlayOpen) {\n      overlay = <Overlay toggleOverlay={this.toggleOverlay}>{this.state.overlayItem}</Overlay>;\n    }\n\n    let analysisButton = null;\n    if (!this.state.isAnalysisOpen) {\n      analysisButton = (\n        <TextButton\n          fontSize=\"4.5vh\"\n          textColor=\"#f1f1f1\"\n          hoverColor=\"#9CB6A4\"\n          onClick={() => this.toggleAnalysisPanel()}\n        >\n          Menu\n        </TextButton>\n      );\n    }\n\n    let spiral_order = null;\n\n    if (this.state.simulationType === \"Spiral\") {\n      spiral_order = (\n        <div className={styles.spiralOrderButtonContainer}>\n          <TextButton fontSize=\"1.8vh\" textColor=\"#f1f1f1\" hoverColor=\"#f1f1f1\" padding=\"2px 2px 2px 2px\">\n            Spiral Order\n          </TextButton>\n          <TextButton\n            fontSize=\"2.7vh\"\n            textColor=\"#f1f1f1\"\n            hoverColor=\"#9CB6A4\"\n            padding=\"2px 2px 2px 2px\"\n            onClick={() => this.toggleSpiralOrder()}\n          >\n            {this.state.spiralOrder}\n          </TextButton>\n        </div>\n      );\n    }\n\n    return (\n      <div>\n        <div className={styles.whatIsButtonContainer}>\n          <TextButton\n            fontSize=\"3vh\"\n            hoverColor=\"#9CB6A4\"\n            padding=\"2px 2px 2px 2px\"\n            onClick={() => {\n              this.setOverlay(<AboutOverlay close={this.closeOverlay} />);\n            }}\n          >\n            What is Brunel&apos;s Network?\n          </TextButton>\n        </div>\n\n        <div className={styles.howDoIButtonContainer}>\n          <TextButton\n            fontSize=\"3vh\"\n            hoverColor=\"#9CB6A4\"\n            padding=\"2px 2px 2px 2px\"\n            onClick={() => {\n              this.setOverlay(<HowDoIOverlay close={this.closeOverlay} />);\n            }}\n          >\n            How do I navigate the network?\n          </TextButton>\n        </div>\n\n        <div className={styles.analysisButtonPanel}>{analysisButton}</div>\n\n        <div className={styles.resetButtonContainer}>\n          <TextButton fontSize=\"2.7vh\" hoverColor=\"#9CB6A4\" padding=\"2px 2px 2px 2px\" onClick={() => this.resetAll()}>\n            Reset\n          </TextButton>\n        </div>\n\n        <div className={styles.simulationTypeButtonContainer}>\n          <TextButton fontSize=\"1.8vh\" textColor=\"#f1f1f1\" hoverColor=\"#f1f1f1\" padding=\"2px 2px 2px 2px\">\n            Simulation type\n          </TextButton>\n          <TextButton\n            fontSize=\"2.7vh\"\n            textColor=\"#f1f1f1\"\n            hoverColor=\"#9CB6A4\"\n            padding=\"2px 2px 2px 2px\"\n            onClick={() => this.toggleSimulationType()}\n          >\n            {this.state.simulationType}\n          </TextButton>\n        </div>\n\n        {spiral_order}\n\n        <div className={styles.commercialNodeLabel}>\n          <TextButton\n            fontSize=\"4.3vh\"\n            textColor=\"#B52222\"\n            hoverColor=\"#FFFFF0\"\n            padding=\"1px 1px 1px 1px\"\n            onClick={() => this.filterCommercialNodes()}\n          >\n            Commercial&#x25CF;\n          </TextButton>\n        </div>\n        <div className={styles.engineeringNodeLabel}>\n          <TextButton\n            fontSize=\"4.3vh\"\n            textColor=\"#808080\"\n            hoverColor=\"#FFFFF0\"\n            padding=\"1px 1px 1px 1px\"\n            onClick={() => this.filterEngineeringNodes()}\n          >\n            Engineers&#x25CF;\n          </TextButton>\n        </div>\n\n        <SlidingPanel isOpen={this.state.isTimeLinePanelOpen} position=\"bottom\" height=\"15%\">\n          <span\n            className={styles.closePanelButton}\n            onClick={() => {\n              this.setState({ isTimeLinePanelOpen: false });\n            }}\n          >\n            X\n          </span>\n          <TimeLineBox\n            selected={selected}\n            projects={this.state.social.getProjects()}\n            shipSelect={(item) => {\n              this.slotSetFilter(item);\n            }}\n            resetFilters={this.resetAllFilters}\n          />\n        </SlidingPanel>\n\n        {/* Filter on bottom of page */}\n        <SlidingPanel isOpen={this.state.isFilterPanelOpen} position=\"bottom\" height=\"25%\">\n          <span\n            className={styles.closePanelButton}\n            onClick={() => {\n              this.setState({ isFilterPanelOpen: false });\n            }}\n          >\n            X\n          </span>\n          <FilterBox\n            social={social}\n            emitToggleFilter={(item) => {\n              this.slotToggleFilter(item);\n            }}\n            emitSelected={(item) => {\n              this.slotSelected(item);\n            }}\n            emitHighlighted={(item) => {\n              this.slotHighlighted(item);\n            }}\n            emitClearFilters={() => {\n              this.resetAllFilters();\n            }}\n          />\n        </SlidingPanel>\n\n        <div className={styles.shipNameContainer}>\n          <ShipTitle name={this.state.selectedShip} />\n        </div>\n\n        <div className={styles.bottomContainer}>\n          <ShipSelector projects={this.state.social.getProjects()} shipFilter={(item) => this.slotSetShip(item)} />\n        </div>\n        <div className={styles.acknowledgeContainer}>\n          Brunel&apos;s Network is a project by the Brunel Institute, a collaboration of the SS Great Britain Trust and\n          University of Bristol.\n        </div>\n\n        {/* The social graph itself */}\n        <div className={styles.mainContainer}>\n          <div className={styles.graphContainer}>\n            <ForceGraph\n              social={this.state.social}\n              selected={selected}\n              highlighted={highlighted}\n              emitClicked={(id) => this.slotSelected(id)}\n              setOverlay={this.setOverlay}\n              selectedShipID={this.state.selectedShipID}\n              indirectConnectionsVisible={this.state.indirectConnectionsVisible}\n              physicsEnabled={this.state.physicsEnabled}\n              simulationType={this.state.simulationType}\n            />\n          </div>\n        </div>\n\n        <SlidingPanel isOpen={this.state.isAnalysisOpen} position=\"rightBottom\" width=\"10%\">\n          <AnalysisPanel\n            toggleSearchOverlay={() => this.toggleSearchOverlay()}\n            toggleFilterPanel={() => this.toggleFilterPanel()}\n            toggleTimeLinePanel={() => this.toggleTimeLinePanel()}\n            togglePanel={() => this.toggleAnalysisPanel()}\n            toggleUnconnectedNodesVisible={() => {\n              this.toggleUnconnectedNodesVisible();\n            }}\n            toggleindirectConnectionsVisible={() => this.toggleindirectConnectionsVisible()}\n            closeOverlay={() => this.closeOverlay()}\n            commercialFiltered={this.state.commercialFiltered}\n            engineersFiltered={this.state.engineersFiltered}\n            filterEngineeringNodes={() => this.filterEngineeringNodes()}\n            filterCommercialNodes={() => this.filterCommercialNodes()}\n            physicsEnabled={this.state.physicsEnabled}\n            togglePhysicsEnabled={this.togglePhysicsEnabled}\n            indirectConnectionsVisible={this.state.indirectConnectionsVisible}\n            unconnectedNodesVisible={this.state.unconnectedNodesVisible}\n            resetFilters={() => this.resetFiltersNotShip()}\n          />\n        </SlidingPanel>\n        {searchOverlay}\n        {overlay}\n      </div>\n    );\n  }\n}\n\nexport default SocialApp;\n","var map = {\n\t\"./320px-SS_Great_Britain_diagram.jpg\": 118,\n\t\"./320px-SS_Great_Britain_transverse_section.jpg\": 119,\n\t\"./800px-Gutenberg_Bible.jpg\": 120,\n\t\"./A_Specimen_by_William_Caslon.jpg\": 121,\n\t\"./Brunel_letter_GWR.jpg\": 122,\n\t\"./Great_Western_maiden_voyage.jpg\": 123,\n\t\"./IllustriteZeitung_SS_GreatBritain.png\": 124,\n\t\"./RHowlett_IKB.jpg\": 125,\n\t\"./Sumerian_26th_c_Adab.jpg\": 126,\n\t\"./The_Steamer_Great_Western_small.jpg\": 127,\n\t\"./bg-128-168.jpg\": 128,\n\t\"./ssgb_logo.png\": 129\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 73;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"AboutOverlay_container__fzMAB\",\"closeButton\":\"AboutOverlay_closeButton__2M8EC\",\"textContainer\":\"AboutOverlay_textContainer__2A-mP\",\"header\":\"AboutOverlay_header__3hHMT\",\"intro\":\"AboutOverlay_intro__2XyY_\",\"introBody\":\"AboutOverlay_introBody__2-zQS\",\"sectionHeader\":\"AboutOverlay_sectionHeader__3I8nD\",\"body\":\"AboutOverlay_body__25TZB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"TextButton_button__2yNkD\",\"verticalSpaceTitle\":\"TextButton_verticalSpaceTitle__2Tk5T\",\"verticalSpace\":\"TextButton_verticalSpace__2Q6Km\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"titleText\":\"AnalysisPanel_titleText__b6UZM\",\"wholePanel\":\"AnalysisPanel_wholePanel__yyW2P\",\"buttonPanel\":\"AnalysisPanel_buttonPanel__1nbYH\",\"button\":\"AnalysisPanel_button__297y3\",\"verticalSpaceTitle\":\"AnalysisPanel_verticalSpaceTitle__zFl5A\",\"verticalSpace\":\"AnalysisPanel_verticalSpace__ZeDzh\",\"enter\":\"AnalysisPanel_enter__1WPvO\",\"enterActive\":\"AnalysisPanel_enterActive__pHxbg\",\"exit\":\"AnalysisPanel_exit__3aXKR\",\"exitActive\":\"AnalysisPanel_exitActive__3179E\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"closeButton\":\"Popover_closeButton__1Msfq\",\"popOver\":\"Popover_popOver__10jzZ\",\"header\":\"Popover_header__2TOZN\",\"bioSection\":\"Popover_bioSection__2BMbS\",\"sourceHeader\":\"Popover_sourceHeader__CJzXo\",\"sourceSection\":\"Popover_sourceSection__Njk1M\",\"edgeCount\":\"Popover_edgeCount__3R3z1\",\"edgeCountNumber\":\"Popover_edgeCountNumber__2tsEu\",\"readMore\":\"Popover_readMore__2c7rW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"BioOverlay_container__JNbgi\",\"closeButton\":\"BioOverlay_closeButton__3kwkz\",\"divider\":\"BioOverlay_divider__3RQPn\",\"textSection\":\"BioOverlay_textSection__1J4B5\",\"header\":\"BioOverlay_header__1tDmE\",\"nameHeader\":\"BioOverlay_nameHeader__cTRJ5\",\"positions\":\"BioOverlay_positions__1UpUj\",\"bio\":\"BioOverlay_bio__1QjHO\",\"sourcesHeader\":\"BioOverlay_sourcesHeader__2je7T\",\"sources\":\"BioOverlay_sources__XzlBO\",\"imageSection\":\"BioOverlay_imageSection__2wd2d\",\"imageDescription\":\"BioOverlay_imageDescription__1hLYH\"};","module.exports = __webpack_public_path__ + \"static/media/320px-SS_Great_Britain_diagram.898c32f6.jpg\";","module.exports = __webpack_public_path__ + \"static/media/320px-SS_Great_Britain_transverse_section.7767cb60.jpg\";","module.exports = __webpack_public_path__ + \"static/media/800px-Gutenberg_Bible.89cc4cbe.jpg\";","module.exports = __webpack_public_path__ + \"static/media/A_Specimen_by_William_Caslon.6240f5ce.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Brunel_letter_GWR.ee7f061c.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Great_Western_maiden_voyage.f85d382e.jpg\";","module.exports = __webpack_public_path__ + \"static/media/IllustriteZeitung_SS_GreatBritain.946104e0.png\";","module.exports = __webpack_public_path__ + \"static/media/RHowlett_IKB.68e88d10.jpg\";","module.exports = __webpack_public_path__ + \"static/media/Sumerian_26th_c_Adab.757d98b8.jpg\";","module.exports = __webpack_public_path__ + \"static/media/The_Steamer_Great_Western_small.8756970f.jpg\";","module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAPAAA/+4ADkFkb2JlAGTAAAAAAf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8AAEQgAgACAAwERAAIRAQMRAf/EAFIAAQEAAAAAAAAAAAAAAAAAAAAIAQEAAAAAAAAAAAAAAAAAAAAAEAABBAMAAAAAAAAAAAAAAADwATFBUaECIhEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8AppNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwBNG4uQwH//2Q==\"","module.exports = __webpack_public_path__ + \"static/media/ssgb_logo.ee48e16d.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SourceOverlay_container__19Q2o\",\"closeButton\":\"SourceOverlay_closeButton__2LDeH\",\"divider\":\"SourceOverlay_divider__3b3gS\",\"nameHeader\":\"SourceOverlay_nameHeader__2hk5a\",\"sourceName\":\"SourceOverlay_sourceName__12n91\",\"body\":\"SourceOverlay_body__3Ilgc\",\"biography\":\"SourceOverlay_biography__rfNz9\",\"imageSection\":\"SourceOverlay_imageSection__2dP8A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"Overlay_overlay__3n4WI\",\"overlayNoBackground\":\"Overlay_overlayNoBackground__17dWq\",\"container\":\"Overlay_container__Mgt_A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ForceGraph_container__TQtWA\",\"graph\":\"ForceGraph_graph__wst6B\",\"node\":\"ForceGraph_node__27s5W\",\"highlight\":\"ForceGraph_highlight__DhZbw\",\"link\":\"ForceGraph_link__2qaVU\",\"linkWeak\":\"ForceGraph_linkWeak__2lOg3\",\"linkIndirect\":\"ForceGraph_linkIndirect__1hzat\",\"linkInvisible\":\"ForceGraph_linkInvisible__2lF55\",\"node_text\":\"ForceGraph_node_text__3ovHB\",\"tooltip\":\"ForceGraph_tooltip__3ttDG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"HowDoIOverlay_container__NXP8l\",\"closeButton\":\"HowDoIOverlay_closeButton__1XerT\",\"textContainer\":\"HowDoIOverlay_textContainer__CwBr7\",\"header\":\"HowDoIOverlay_header__34qJ-\",\"intro\":\"HowDoIOverlay_intro__32MKa\",\"introBody\":\"HowDoIOverlay_introBody__3Tvz-\",\"sectionHeader\":\"HowDoIOverlay_sectionHeader__2STY2\",\"body\":\"HowDoIOverlay_body__28B14\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"TimeLineBox_container__3XwaK\",\"centerContainer\":\"TimeLineBox_centerContainer__16Ujh\",\"tabs\":\"TimeLineBox_tabs__yHSvr\",\"tablist\":\"TimeLineBox_tablist__yB2UA\",\"tab\":\"TimeLineBox_tab__157Wu\",\"tabPanel\":\"TimeLineBox_tabPanel__3u0d3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"accordion\":\"Accordion_accordion__34t4_\",\"accordionItem\":\"Accordion_accordionItem__VO6pK\",\"accordionButton\":\"Accordion_accordionButton__hVXWw\",\"accordionPanel\":\"Accordion_accordionPanel__1rZAH\",\"fadein\":\"Accordion_fadein__2cKpJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"list\":\"ResponsiveList_list__1-ZoE\",\"item\":\"ResponsiveList_item__3jhI7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkBox\":\"CheckBox_checkBox__36R4T\",\"checkMark\":\"CheckBox_checkMark__2h9Jd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"DefaultButton_button__1Uv_G\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filterContainer\":\"FilterBox_filterContainer__2KAxt\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SlidingPanel_container__360Fr\",\"leftContainer\":\"SlidingPanel_leftContainer__hQNC6\",\"rightContainer\":\"SlidingPanel_rightContainer__57qYr\",\"topContainer\":\"SlidingPanel_topContainer__YiYRz\",\"bottomContainer\":\"SlidingPanel_bottomContainer__2dEzd\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromLeft_enter__jKjRY\",\"enterActive\":\"SlideFromLeft_enterActive__159kE\",\"exit\":\"SlideFromLeft_exit___gRJ9\",\"exitActive\":\"SlideFromLeft_exitActive__YfXDY\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromRight_enter__3at5G\",\"enterActive\":\"SlideFromRight_enterActive__qhcn3\",\"exit\":\"SlideFromRight_exit__C9Did\",\"exitActive\":\"SlideFromRight_exitActive__2HcMW\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromBottom_enter__1iOKm\",\"enterActive\":\"SlideFromBottom_enterActive__248cg\",\"exit\":\"SlideFromBottom_exit__1SBqa\",\"exitActive\":\"SlideFromBottom_exitActive__1TiIq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"enter\":\"SlideFromTop_enter__2sGUw\",\"enterActive\":\"SlideFromTop_enterActive__3jElj\",\"exit\":\"SlideFromTop_exit__28rU4\",\"exitActive\":\"SlideFromTop_exitActive__2_Nxz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button\":\"ShipSelector_button__1cPR1\",\"disabledButton\":\"ShipSelector_disabledButton__2aQfJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"shipTitle\":\"ShipTitle_shipTitle__3ELcB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchContainer\":\"SearchBar_searchContainer__2xOxT\",\"resultContainer\":\"SearchBar_resultContainer__1_9Lx\",\"searchPending\":\"SearchBar_searchPending__1uhP9\",\"searchResult\":\"SearchBar_searchResult__1iaaf\",\"searchBox\":\"SearchBar_searchBox__3PHmH\",\"disabledButton\":\"SearchBar_disabledButton__2PWwO\",\"searchButton\":\"SearchBar_searchButton__1GItM\",\"magnifier\":\"SearchBar_magnifier__2xBEb\",\"closeResultButton\":\"SearchBar_closeResultButton__MIs2K\",\"hamburgerButton\":\"SearchBar_hamburgerButton__1PuEk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SearchOverlay_container__oPvtI\",\"smallContainer\":\"SearchOverlay_smallContainer__cokAy\",\"resultsContainer\":\"SearchOverlay_resultsContainer__3qrfB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"module\":\"SocialApp_module__3Cefy\",\"mainContainer\":\"SocialApp_mainContainer__1mJaw\",\"graphContainer\":\"SocialApp_graphContainer__1fIZ_\",\"shipNameContainer\":\"SocialApp_shipNameContainer__3G7ll\",\"resetButtonContainer\":\"SocialApp_resetButtonContainer__2FOA9\",\"spiralOrderButtonContainer\":\"SocialApp_spiralOrderButtonContainer__315nF\",\"simulationTypeButtonContainer\":\"SocialApp_simulationTypeButtonContainer__3m2Ow\",\"whatIsButtonContainer\":\"SocialApp_whatIsButtonContainer__2q6bj\",\"howDoIButtonContainer\":\"SocialApp_howDoIButtonContainer__M1-hh\",\"commercialNodeLabel\":\"SocialApp_commercialNodeLabel__2bQZd\",\"engineeringNodeLabel\":\"SocialApp_engineeringNodeLabel__344K3\",\"controlButton\":\"SocialApp_controlButton__dd05U\",\"bottomContainer\":\"SocialApp_bottomContainer__7teeO\",\"acknowledgeContainer\":\"SocialApp_acknowledgeContainer__T5R_g\",\"analysisButtonPanel\":\"SocialApp_analysisButtonPanel__ZVbzp\",\"filterText\":\"SocialApp_filterText__12DDf\",\"citationText\":\"SocialApp_citationText__m100A\",\"closePanelButton\":\"SocialApp_closePanelButton__S0EAB\",\"closeOverlayButton\":\"SocialApp_closeOverlayButton__38BCO\",\"modal\":\"SocialApp_modal__7Dp7u\",\"modalOverlay\":\"SocialApp_modalOverlay__8objV\",\"modalOverlayAfterOpen\":\"SocialApp_modalOverlayAfterOpen__3azyt\",\"modalOverlayBeforeClose\":\"SocialApp_modalOverlayBeforeClose__3K48w\"};"],"sourceRoot":""}